(()=>{var e={40:(e,r,n)=>{"use strict";n.r(r),n.d(r,{CommonDataManager:()=>_});var t=n(537),a=n.n(t),o=n(765),i=n.n(o),s=n(779),u=n.n(s),c=n(116),l=n.n(c),f=n(640),p=n.n(f),m=n(846),d=n(69);function h(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var v=new WeakMap,g=new WeakMap,b=new WeakMap,w=new WeakMap,k=new WeakMap,y=new WeakMap,x=new WeakMap,S=new WeakMap,_=function(){function e(){var r=this;return a()(this,e),h(this,v,{writable:!0,value:"https://api.gologin.com"}),h(this,g,{writable:!0,value:""}),h(this,b,{writable:!0,value:""}),h(this,w,{writable:!0,value:""}),h(this,k,{writable:!0,value:""}),h(this,y,{writable:!0,value:""}),h(this,x,{writable:!0,value:""}),h(this,S,{writable:!0,value:{}}),e.instance||(e.instance=this,this.getUserOS().then((function(e){p()(r,k,e||"")})),(0,d.e4)().then((function(e){p()(r,y,e)})),(0,m.qn)().then((function(e){e&&(p()(r,S,e),console.log("Loaded config:",e))})).catch((function(){return null}))),e.instance}return i()(e,[{key:"getUserOS",value:function(){return(0,d.Ij)().then((function(e){return e})).catch((function(){return null}))}},{key:"userAgent",get:function(){return l()(this,b)},set:function(e){e&&p()(this,b,e)}},{key:"userPlanId",get:function(){return l()(this,x)},set:function(e){p()(this,x,e)}},{key:"accessToken",get:function(){return l()(this,g)},set:function(e){e&&p()(this,g,e)}},{key:"twoFaKey",get:function(){return l()(this,w)},set:function(e){e&&p()(this,w,e)}},{key:"apiBaseUrl",get:function(){return l()(this,v)}},{key:"userOs",get:function(){return l()(this,k)}},{key:"metaHeader",get:function(){return l()(this,y)}},{key:"appConfig",get:function(){return l()(this,S)},set:function(e){e&&p()(this,S,e)}}]),e}();u()(_,"instance",void 0)},846:(e,r,n)=>{"use strict";n.d(r,{$c:()=>v,pI:()=>w,qS:()=>h,qn:()=>g});var t=n(353),a=n.n(t),o=n(591),i=n.n(o),s=n(307),u=n.n(s),c=n(292),l=n(17),f=n.n(l),p=n(703),m=n(664),d=f().join(p.Mv,"appConfig.json"),h=function(){var e=i()(u().mark((function e(r){var n,t,a,o,i,s,c,l,f,p,m;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:(n=e.sent)&&(t=n.windowWidth,a=n.windowHeight,o=n.windowPosX,i=void 0===o?0:o,s=n.windowPosY,c=void 0===s?0:s,l=n.isMaximized,f=void 0!==l&&l,p=n.isFullScreen,m=void 0!==p&&p,t&&Number(t)>1e3&&(r.windowWidth=Number(t)),a&&Number(a)>500&&(r.windowHeight=Number(a)),!m&&(r.windowPosX=Number(i)),!m&&(r.windowPosY=Number(c)),r.isMaximized=f,r.isFullScreen=m);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),v=function(){var e=i()(u().mark((function e(r,n,t){var a,o,i,s,c,l,f,p,m,d,h;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={},(o=(n||{}).language)&&(a.language=o),i=r&&r.getBounds()||{},s=i.width,c=void 0===s?1024:s,l=i.height,f=void 0===l?500:l,p=i.x,m=void 0===p?0:p,d=i.y,h=void 0===d?0:d,a.windowWidth=c,a.windowHeight=f,a.windowPosX=m,a.windowPosY=h,a.isMaximized=!!r.isMaximized(),a.isFullScreen=!!r.isFullScreen(),a.theme=t,e.next=13,w(a).catch((function(e){return console.log(e)}));case 13:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}(),g=function(){var e=i()(u().mark((function e(){var r,n,t,a,o;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,c.readFile)(d,"utf-8");case 3:return r=e.sent,n=JSON.parse(r),e.abrupt("return",n);case 8:if(e.prev=8,e.t0=e.catch(0),t=e.t0 instanceof Error?e.t0.message:e.t0,a=e.t0,o=a.code,"ENOENT"!==(void 0===o?"":o)){e.next=14;break}return e.abrupt("return",{});case 14:return console.log(r),(0,m.oj)({message:t,transactionName:"load-app-config-error",level:"warning",tags:[["scenario","load-app-config"]]}),e.abrupt("return",{});case 18:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=i()(u().mark((function e(r){var n,t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=JSON.stringify(r,null,"\t"),e.next=4,(0,c.mkdir)(f().dirname(d),{recursive:!0}).catch((function(){return null}));case 4:return e.next=6,(0,c.writeFile)(d,n,{mode:438});case 6:e.next=14;break;case 8:e.prev=8,e.t0=e.catch(0),console.error("Error saving config file",e.t0),t=e.t0 instanceof Error?e.t0.message:e.t0,console.log("message",t),(0,m.zd)({message:t,transactionName:"save-app-config-error",level:"warning",tags:[["scenario","save-app-config"]]});case 14:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(r){return e.apply(this,arguments)}}(),w=function(){var e=i()(u().mark((function e(r){var t,o,i,s,c;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve().then(n.bind(n,40));case 2:if(t=e.sent,o=t.CommonDataManager,i=new o,s=i.appConfig,(c=Object.entries(r)).length){e.next=9;break}return e.abrupt("return");case 9:return c.forEach((function(e){var r=a()(e,2),n=r[0],t=r[1],o=void 0===t?null:t;n&&null!==o&&(s[n]=o)})),i.appConfig=s,e.next=13,b(s);case 13:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},605:(e,r,n)=>{"use strict";n.d(r,{H:()=>h});var t=n(765),a=n.n(t),o=n(537),i=n.n(o),s=n(370),u=n.n(s),c=n(548),l=n.n(c),f=n(761),p=n.n(f);const m=require("@babel/runtime/helpers/wrapNativeSuper");function d(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,t=p()(e);if(r){var a=p()(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return l()(this,n)}}var h=function(e){u()(n,e);var r=d(n);function n(e){var t;return i()(this,n),(t=r.call(this,e)).name="ElectronError",t}return a()(n)}(n.n(m)()(Error))},703:(e,r,n)=>{"use strict";n.d(r,{$c:()=>y,IT:()=>O,Me:()=>S,Mv:()=>_,eZ:()=>w,fv:()=>P,im:()=>k,iw:()=>v,ko:()=>T,nI:()=>b,qW:()=>x,wk:()=>E,xL:()=>j});var t=n(779),a=n.n(t),o=n(81),i=n(113),s=n.n(i),u=n(358),c=n(37),l=n.n(c),f=n(17),p=n.n(f);function m(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function d(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?m(Object(n),!0).forEach((function(r){a()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var h=l().homedir(),v=process.platform,g=p().sep,b=".gologin",w=".gologin_test",k=p().join(h,b,"extensions"),y=p().join(k,"chrome-extensions"),x=p().join(k,"user-extensions"),S=p().join(h,b,"gologin-cached-profiles"),_=p().join(h,b),T="orbita-browser",P="Orbita-Browser.app",E=p().join(h,b,"browser"),C=function(e){if(!e.BASE_FOLDER||"win32"===v)return e;var r=(0,o.execSync)("echo $USER").toString().trim();try{(0,u.accessSync)(e.BASE_FOLDER)}catch(r){e.BASE_FOLDER=p().sep+p().join("tmp","gologin")}var n=s().createHash("sha1").update(r).digest("hex").substring(0,10);return e.BASE_FOLDER="".concat(e.BASE_FOLDER,"_").concat(n),e.PROFILES_DIR="".concat(e.PROFILES_DIR.replace("{base_folder}",e.BASE_FOLDER)),e.START_DIR_PATH="".concat(e.START_DIR_PATH.replace("{base_folder}",e.BASE_FOLDER)),e.STARTED_DIR_PATH="".concat(e.STARTED_DIR_PATH.replace("{base_folder}",e.BASE_FOLDER)),e},M={BASE_FOLDER:p().sep+p().join("tmp","gologin"),PROFILES_DIR:"{base_folder}/profiles/",START_DIR_PATH:"{base_folder}/start",STARTED_DIR_PATH:"{base_folder}/started",ROUTE_SLASH:g,COOKIES_FILE:p().join(g,"Default","Cookies"),COOKIES_FILE_NEW:p().join(g,"Default","Network","Cookies"),PASSWORDS_FILE:p().join(g,"Default","Login Data"),BROWSER_BASE_PATH:E},N=C(d(d({},M),{},{BROWSER_EXEC_FILE_NAME:["chrome"],DOLPHIN_DIR_PATH:p().join(h,".config","dolphin_anty")+p().sep})),B=C(d(d({},M),{},{BASE_FOLDER:p().sep+p().join("private","tmp","gologin"),BROWSER_EXEC_FILE_NAME:[P,"Contents","MacOS","Orbita"],BROWSER_OLD_EXEC_FILE_NAME:"",BROWSER_BASE_PATH:E,DOLPHIN_DIR_PATH:p().join(h,"Library","Application Support","dolphin_anty")+p().sep})),I={BASE_FOLDER:p().join(h,"AppData","Local","Temp","GoLogin")+p().sep,PROFILES_DIR:p().join(h,"AppData","Local","Temp","GoLogin","profiles")+p().sep,START_DIR_PATH:p().join(h,"AppData","Local","Temp","GoLogin","start")+p().sep,STARTED_DIR_PATH:p().join(h,"AppData","Local","Temp","GoLogin","started")+p().sep,ROUTE_SLASH:g,BROWSER_EXEC_FILE_NAME:["chrome.exe"],BROWSER_BASE_PATH:E,COOKIES_FILE:p().join(g,"Default","Cookies"),COOKIES_FILE_NEW:p().join(g,"Default","Network","Cookies"),PASSWORDS_FILE:p().join(g,"Default","Login Data"),DOLPHIN_DIR_PATH:p().join(h,"AppData","Roaming","dolphin_anty")+p().sep},O=function(){return"win32"===v?I:"darwin"===v?B:N},A=O(),j=A.PROFILES_DIR+"{profileId}"+A.ROUTE_SLASH+"Default"+A.ROUTE_SLASH},664:(e,r,n)=>{"use strict";n.d(r,{j6:()=>c,oj:()=>u,zd:()=>l});var t=n(353),a=n.n(t),o=n(789),i=n(842),s=n(605),u=function(e){var r=e.message,n=e.level,t=void 0===n?"error":n,i=e.tags,u=void 0===i?[]:i,c=e.transactionName;o.captureException(new s.H(r.toString()),(function(e){return e.setLevel(t),e.setTransactionName(c),e.setFingerprint([c]),u.forEach((function(r){var n=a()(r,2),t=n[0],o=n[1];e.setTag(t,o)})),e}))},c=function(){o.init({dsn:"https://5f8f2419860a4749bb9b13d81b131a29@sentry.amzn.pro/2",integrations:[new i.BrowserTracing],tracesSampleRate:1,release:process.env.npm_package_version,environment:"production",ignoreErrors:["Invalid Minidump","Object has been destroyed","Cannot set headers after they are sent to the client","Cannot read properties of undefined (reading 'isServer')","The `onCancel` handler was attached after the promise settled."]})},l=function(e){var r=e.message,n=e.tags,t=void 0===n?[]:n,i=e.transactionName;switch(!0){case["SSL","certificate","socket hang up","ECONNRESET","getaddrinfo","connect","Timeout"].some((function(e){return r.includes(e)})):i="internet-error";break;case r.includes("402"):i="payment-required";break;case r.includes("EPERM")||r.includes("EACCES"):i="permission-error";break;case r.includes("429")||"too many requests"===r.toLowerCase():i="too-many-requests";break;case r.includes("ENOSPC")||r.includes("SQLITE_FULL"):i="no-disc-space";break;case r.includes("The server aborted pending request"):i="aws-aborted"}o.captureException(new s.H(r.toString()),(function(e){return e.setTransactionName(i),e.setFingerprint([i]),t.forEach((function(r){var n=a()(r,2),t=n[0],o=n[1];e.setTag(t,o)})),e}))}},69:(e,r,n)=>{"use strict";n.d(r,{Ij:()=>g,Yu:()=>v,e4:()=>k,lZ:()=>w});var t=n(353),a=n.n(t),o=n(591),i=n.n(o),s=n(307),u=n.n(s),c=n(81),l=n(37),f=n(464),p=n(147),m=(0,f.promisify)(c.exec),d=p.i8,h=p.gN,v=process.platform,g=function(){var e=i()(u().mark((function e(){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("win32"!==process.platform){e.next=2;break}return e.abrupt("return","win");case 2:if("darwin"!==process.platform){e.next=7;break}return e.next=5,b();case 5:return r=e.sent,e.abrupt("return",r?"macM1":"mac");case 7:return e.abrupt("return","lin");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=function(){var e=i()(u().mark((function e(){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m("sysctl machdep.cpu").catch((function(e){return console.log("error in M1 detection ",e),{stdout:""}}));case 2:return r=e.sent,n=r.stdout,e.abrupt("return",/Apple M\d/.test(n));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=l.release()||"";console.log("winRelease",e);var r=e.split("."),n=a()(r,1)[0];return Number(void 0===n?"10":n)},k=function(){var e=i()(u().mark((function e(){var r,n,t,o,i,s;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:if(r=e.sent,n=l.release(),t=a()(n,1),o=t[0],i=void 0===o?"":o,s="".concat(d," ").concat(h),"win"!==r){e.next=7;break}return e.abrupt("return","".concat(s,"-").concat(r,"-").concat(w()));case 7:return e.abrupt("return","".concat(s,"-").concat(r,"-").concat(i,"}"));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},956:(e,r,n)=>{e=n.nmd(e);try{process.dlopen(e,__dirname+n(17).sep+n.p+"ee0823aff70e779c9cb91cff97c758a7.node")}catch(e){throw new Error("node-loader:\n"+e)}},486:(e,r,n)=>{e=n.nmd(e);try{process.dlopen(e,__dirname+n(17).sep+n.p+"20831cf3ea86ad9a9eac464a7dfd6335.node")}catch(e){throw new Error("node-loader:\n"+e)}},289:(e,r,n)=>{e=n.nmd(e);try{process.dlopen(e,__dirname+n(17).sep+n.p+"e75dd8106319282c721827e2a4c2cf8c.node")}catch(e){throw new Error("node-loader:\n"+e)}},924:(e,r,n)=>{e=n.nmd(e);try{process.dlopen(e,__dirname+n(17).sep+n.p+"ee0823aff70e779c9cb91cff97c758a7.node")}catch(e){throw new Error("node-loader:\n"+e)}},591:e=>{"use strict";e.exports=require("@babel/runtime/helpers/asyncToGenerator")},537:e=>{"use strict";e.exports=require("@babel/runtime/helpers/classCallCheck")},116:e=>{"use strict";e.exports=require("@babel/runtime/helpers/classPrivateFieldGet")},640:e=>{"use strict";e.exports=require("@babel/runtime/helpers/classPrivateFieldSet")},765:e=>{"use strict";e.exports=require("@babel/runtime/helpers/createClass")},779:e=>{"use strict";e.exports=require("@babel/runtime/helpers/defineProperty")},761:e=>{"use strict";e.exports=require("@babel/runtime/helpers/getPrototypeOf")},370:e=>{"use strict";e.exports=require("@babel/runtime/helpers/inherits")},548:e=>{"use strict";e.exports=require("@babel/runtime/helpers/possibleConstructorReturn")},353:e=>{"use strict";e.exports=require("@babel/runtime/helpers/slicedToArray")},307:e=>{"use strict";e.exports=require("@babel/runtime/regenerator")},789:e=>{"use strict";e.exports=require("@sentry/electron")},842:e=>{"use strict";e.exports=require("@sentry/tracing")},464:e=>{"use strict";e.exports=require("util")},81:e=>{"use strict";e.exports=require("child_process")},113:e=>{"use strict";e.exports=require("crypto")},358:e=>{"use strict";e.exports=require("fs")},292:e=>{"use strict";e.exports=require("fs/promises")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")},147:e=>{"use strict";e.exports=JSON.parse('{"u2":"GoLogin","i8":"3.3.3","gN":"Jupiter"}')}},r={};function n(t){var a=r[t];if(void 0!==a)return a.exports;var o=r[t]={id:t,loaded:!1,exports:{}};return e[t](o,o.exports,n),o.loaded=!0,o.exports}n.n=e=>{var r=e&&e.__esModule?()=>e.default:()=>e;return n.d(r,{a:r}),r},n.d=(e,r)=>{for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="";var t={};(()=>{"use strict";n.r(t);var e=n(353),r=n.n(e),a=n(591),o=n.n(a),i=n(307),s=n.n(i),u=n(17),c=n.n(u);const l=require("url");var f=n.n(l);const p=require("@electron/remote/main");var m=n(789),d=n(842);const h=require("electron"),v=require("electron-updater"),g=require("fs-extra");var b=n.n(g),w=n(147);const k=require("@babel/runtime/helpers/toConsumableArray");var y=n.n(k),x=n(537),S=n.n(x),_=n(765),T=n.n(_),P=n(779),E=n.n(P),C=n(640),M=n.n(C),N=n(116),B=n.n(N),I=n(37),O=n.n(I),A=n(292),j=n(703),L=n(69),R="latest-version.txt",D="latest-version{{orbita-version}}.txt",F="https://orbita-browser-mac.gologin.com/".concat(D),G="https://orbita-browser-mac-arm.gologin.com/".concat(D),U="https://orbita-browser-linux.gologin.com/".concat(D),z="https://orbita-browser-windows.gologin.com/".concat(D),K=("https://releases-win-test-orbita.s3.eu-central-1.amazonaws.com/".concat("foldersize.txt"),"orbita-browser-latest{{orbita-version}}.".concat("win32"===L.Yu?"zip":"tar.gz")),H="https://orbita-browser-mac.gologin.com/".concat(K),W="https://orbita-browser-mac-arm.gologin.com/".concat(K),q="https://orbita-browser-linux.gologin.com/".concat(K),V="https://orbita-browser-windows.gologin.com/".concat(K),J="https://releases-mac-orbita-multicore.s3.eu-central-1.amazonaws.com/".concat(K),X="https://releases-mac-arm-orbita-multicore.s3.eu-central-1.amazonaws.com/".concat(K),Z="https://releases-deb-orbita-multicore.s3.eu-central-1.amazonaws.com/".concat(K),Y="https://releases-win-orbita-multicore.s3.eu-central-1.amazonaws.com/".concat(K),$="hashfile{{orbita-version}}.mtree",Q="hashfile{{orbita-version}}.mtree",ee="hashfile{{orbita-version}}.txt",re=ee,ne="https://orbita-browser-mac.gologin.com/".concat($),te="https://orbita-browser-mac-arm.gologin.com/".concat($),ae="https://orbita-browser-linux.gologin.com/".concat(ee),oe=("https://orbita-browser-windows.gologin.com/".concat(re),"hash_sum_not_matched"),ie="extracted-browser",se="https://clients2.google.com/service/update2/crx?response=redirect&acceptformat=crx2,crx3&x=id%3D{ext_id}%26uc&prodversion=97.0.4692.71",ue="ghlmiigebgipgagnhlanjmmniefbfihl",ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!e.split)return"0";var n=e.split(".");return r()(n,1)[0]},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=e||"0";return[j.ko,r].join("-")};const fe=require("got");var pe=n.n(fe),me=n(40),de=new me.CommonDataManager,he=function(e){var r,n=e.method,t=e.headers;return{method:n,headers:void 0===t?{Authorization:"Bearer ".concat((r=de).accessToken),"user-agent":r.userAgent,"x-two-factor-token":r.twoFaKey||"","GoLogin-Meta-Header":r.metaHeader||""}:t,timeout:{request:e.timeout},retry:{limit:e.retryLimit,errorCodes:["ETIMEDOUT","ECONNRESET","EADDRINUSE","ECONNREFUSED","EPIPE","ENOTFOUND","EAI_AGAIN"]}}},ve=function(e){var r=e.method,n=void 0===r?"GET":r,t=e.url,a=e.body,o=void 0===a?{}:a,i=e.headers,s=e.timeout,u=void 0===s?3e4:s,c=e.json,l=void 0===c||c,f=e.isBuffer,p=void 0!==f&&f,m=e.retryLimit,d=he({method:n,headers:i,timeout:u,retryLimit:void 0===m?3:m});return["GET","HEAD"].includes(n)||(d.json=o),p&&(delete d.json,d.body=o),l?pe()(t,d).json():pe()(t,d).then((function(e){return e.body}))},ge=function(e){var r=e.method,n=void 0===r?"GET":r,t=e.url,a=e.body,o=void 0===a?{}:a,i=e.headers,s=e.timeout,u=void 0===s?3e4:s,c=e.isBuffer,l=void 0!==c&&c,f=e.retryLimit,p=he({method:n,headers:i,timeout:u,retryLimit:void 0===f?3:f});return["GET","HEAD"].includes(n)||(p.json=o),l&&(delete p.json,p.body=o),pe()(t,p)},be=n(664),we=function(){var e=o()(s().mark((function e(n){var t,a,i,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t=n.split(c().sep).reverse(),a=r()(t,1),".DS_Store"!==a[0]){e.next=4;break}return e.abrupt("return",0);case 4:return e.next=6,(0,A.stat)(n);case 6:if((i=e.sent).isDirectory()){e.next=9;break}return e.abrupt("return",i.size);case 9:return e.next=11,(0,A.readdir)(n);case 11:return u=e.sent,l=u.map(function(){var e=o()(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",we(c().join(n,r)));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=15,Promise.all(l);case 15:return e.abrupt("return",e.sent.reduce((function(e,r){return e+r}),0));case 18:return e.prev=18,e.t0=e.catch(0),e.abrupt("return",-1);case 21:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(r){return e.apply(this,arguments)}}(),ke=function(){var e=o()(s().mark((function e(r,n){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.stat)(r);case 2:if(e.sent.isDirectory()){e.next=5;break}return e.abrupt("return",(0,A.copyFile)(r,n));case 5:return e.next=7,(0,A.mkdir)(n,{recursive:!0}).catch((function(){}));case 7:return e.next=9,(0,A.readdir)(r);case 9:return t=e.sent,a=t.map(function(){var e=o()(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.mkdir)(n,{recursive:!0}).catch((function(){}));case 2:return e.abrupt("return",ke(c().join(r,t),c().join(n,t)));case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(a));case 12:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),ye=function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.stat)(r).catch((function(){return null}));case 2:if(n=e.sent){e.next=5;break}return e.abrupt("return");case 5:if(!n.isDirectory()){e.next=7;break}return e.abrupt("return",(0,A.rmdir)(r,{recursive:!0}));case 7:return e.abrupt("return",(0,A.unlink)(r));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),xe={0:"a",1:"b",2:"c",3:"d",4:"e",5:"f",6:"g",7:"h",8:"i",9:"j",a:"k",b:"l",c:"m",d:"n",e:"o",f:"p"},Se=function(e,r){var n=e.indexOf(r);n<-1||e.splice(n,1)};const _e=function e(r){var n=r||{},t=n.retryDelay,a=void 0===t?0:t,o=n.limit,i=void 0===o?5:o,s=n.fn,u=n.callCounter,c=void 0===u?1:u,l=n.onRetry,f=n.stopRetryErrorPatterns,p=void 0===f?[]:f;return delete n.callCounter,s(n).catch((function(r){var t=r instanceof Error?r.message:"unknown",o=p.some((function(e){return t.includes(e.toString())}));if(c>=i||o||!1)return Promise.reject(r);l&&l(),n.callCounter=c+1;var s=a?function(e){return new Promise((function(){return setTimeout(e,a)}))}:function(e){return process.nextTick(e)};return new Promise((function(e){return s(e)})).then((function(){return e(n)}))}))};function Te(e,r,n){Pe(e,r),r.set(e,n)}function Pe(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ee(e,r,n){if(!r.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var Ce=n(358).promises,Me=Ce.readdir,Ne=Ce.rm,Be=Ce.readFile,Ie=Ce.mkdir,Oe="0.0.0",Ae=new WeakMap,je=new WeakMap,Le=new WeakMap,Re=new WeakMap,De=new WeakSet,Fe=function(){function e(){var r,n;return S()(this,e),Pe(r=this,n=De),n.add(r),Te(this,Ae,{writable:!0,value:(0,j.IT)()}),Te(this,je,{writable:!0,value:{}}),Te(this,Le,{writable:!0,value:""}),Te(this,Re,{writable:!0,value:[]}),e.instance||(e.instance=this),e.instance}var n,t,a,i;return T()(e,[{key:"getLocalOrbitaReleasesList",value:(i=o()(s().mark((function e(){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new RegExp("^(".concat(j.ko,"|").concat(j.ko,"-\\d{2,3})$")),e.t0=M(),e.t1=this,e.t2=je,e.next=6,Me(j.wk).catch((function(){return[]}));case 6:e.t3=e.sent.filter((function(e){return e.includes(j.fv)||n.test(e)})).reduce((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=n.match(/-(\d+$)/)||[],a=r()(t,2),o=(a[0],a[1]);return e[void 0===o?"0":o]=n,e}),{}),(0,e.t0)(e.t1,e.t2,e.t3);case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"localOrbitaReleasesList",get:function(){return B()(this,je)}},{key:"getSupportedOrbitaVersions",value:(a=o()(s().mark((function e(){var r,n=this,t=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.length>0&&void 0!==t[0]?t[0]:"",!B()(this,Re).length&&r){e.next=3;break}return e.abrupt("return",B()(this,Re));case 3:return e.abrupt("return",ve({url:"".concat(r,"/gologin-global-settings/supported_orbita_versions"),method:"GET",timeout:3e4}).then((function(e){return M()(n,Re,e.supportedOrbitaVersions||[]),B()(n,Re)})).catch((function(){return[]})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"checkLocalOrbitaReleases",value:(t=o()(s().mark((function e(){var r,n,t,a,o,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getLocalOrbitaReleasesList();case 2:if(r="darwin"===j.iw?j.fv:j.ko,B()(this,je)[0]){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,s=void 0,s=c().join(j.wk,j.ko,"version"),"darwin"===j.iw&&(s=c().join(j.wk,"version",R)),(0,A.readFile)(s,{encoding:"utf-8"}).catch((function(){return"0.0.0"}));case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0="";case 10:if(n=e.t0,t=ce(n),a=le(t),o=c().join(j.wk,r),"darwin"!==j.iw){e.next=18;break}return o=j.wk,e.next=18,Ie(c().join(o,a)).catch((function(){return null}));case 18:return e.abrupt("return",_e({fn:function(){return"darwin"===j.iw?Me(o).then((function(e){return Promise.all(e.map((function(e){return e.includes("dylib")||e.includes("version")||e.includes(j.fv)?ke(c().join(o,e),c().join(o,a,e)):null})))})).then((function(){return Me(o)})).then((function(e){return Promise.all(e.map((function(e){return e.includes(j.ko)?null:ye(c().join(o,e))})))})):ke(o,c().join(j.wk,a))}}).then((function(){return"darwin"===j.iw?null:Ne(c().join(j.wk,j.ko),{recursive:!0,maxRetries:5,retryDelay:300})})).then((function(){return i.getLocalOrbitaReleasesList()})).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,transactionName:"check-downloaded-orbita-versions",tags:[["scenario","check-multicore"],["name","check-downloaded-orbita-versions"]]})})));case 19:case"end":return e.stop()}var s}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getLocalOrbitaVersionByPath",value:(n=o()(s().mark((function e(){var n,t,a,o,i,u,l,f=this,p=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>0&&void 0!==p[0]?p[0]:"",!(p.length>1&&void 0!==p[1]&&p[1]&&B()(this,Le))){e.next=4;break}return e.abrupt("return",B()(this,Le));case 4:if(Object.keys(B()(this,je)).length){e.next=7;break}return e.abrupt("return",Oe);case 7:return(t=n)||(a=Ee(this,De,Ge).call(this),o=r()(a,1),i=o[0],u=B()(this,je)[i],t=c().join(B()(this,Ae).BROWSER_BASE_PATH,u)),l=c().join(t,"version"),"darwin"===j.iw&&(l=c().join(t,"version",R)),e.abrupt("return",Be(l,{encoding:"utf-8"}).then((function(e){return M()(f,Le,e),e})).catch((function(){return Oe})));case 12:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getOrbitaPathToStart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(!Ee(this,De,Ge).call(this).length)throw new Error("No installed Orbita");var n=B()(this,je)[e];if(!n){var t=Ee(this,De,Ge).call(this),a=r()(t,1)[0];n=B()(this,je)[a]}return{pathToLaunch:c().join.apply(c(),[B()(this,Ae).BROWSER_BASE_PATH,n].concat(y()(B()(this,Ae).BROWSER_EXEC_FILE_NAME))),browserWorkingDir:c().join(B()(this,Ae).BROWSER_BASE_PATH,n)}}},{key:"getMajorVersionByUA",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").match(/[\s\S\w]+Chrome\/(\d+)/)||[];if(!e)return"";var n=r()(e,2),t=(n[0],n[1]),a=void 0===t?"":t;return"100"===a?"10":"103"===a?"13":a}},{key:"getOrbitaVersionToDownload",value:function(e){var r=e.key,n=e.value,t="userAgent"===r?this.getMajorVersionByUA(n):n,a=this.checkOrbitaWinCompatible({key:r,value:n}),o=B()(this,je)[t],i=B()(this,Re).includes(t);return a&&t&&i&&!o?("10"===t&&(t="100"),"13"===t&&(t="103"),t.toString()):""}},{key:"checkOrbitaWinCompatible",value:function(e){var r=e.key,n=e.value,t=e.ProfileStatusManagerInst;if("win32"!==I.platform())return!0;var a=n||"latest";if("userAgent"===r){var o=this.getMajorVersionByUA(n);a=(this.getOrbitaPathToStart(o).pathToLaunch.match(/orbita-browser-(\d+)/)||[])[1]||"110"}return+ +a<110||(!(+(0,L.lZ)()<10)||(t&&t.addStatus({status:"error",statusMessage:"profileStatusMessages.windowsVersionNotSupported"}),!1))}},{key:"checkOrbitasAvailable",value:function(e){var r=e,n=Object.keys(B()(this,je)).map(Number);return r=r.filter((function(e){return n.includes(e)})),"win32"!==I.platform()?r:+(0,L.lZ)()<10?r.filter((function(e){return e<=109})):r}}]),e}();function Ge(){return Object.keys(B()(this,je)).map((function(e){return Number(e)})).sort((function(e,r){return e-r})).reverse().map((function(e){return e.toString()}))}E()(Fe,"instance",void 0);var Ue=n(113),ze=n.n(Ue);const Ke=[{name:"AIGDT",value:"AIGDT",fileNames:["aigdt.ttf"],os:["win","lin"]},{name:"AMGDT",value:"AMGDT",fileNames:["amgdt.ttf"],os:["win","lin"]},{name:"Abadi MT Condensed Light",value:"Abadi MT Condensed Light"},{name:"Abyssinica Sil Regular",value:"Abyssinica Sil Regular",fileNames:["abyssinica_sil.ttf"],os:["lin"]},{name:"Academy Engraved LET",value:"Academy Engraved LET"},{name:"AcadEref",value:"AcadEref",fileNames:["acaderef.ttf"]},{name:"Adobe Arabic",value:"Adobe Arabic"},{name:"Adobe Caslon Pro",value:"Adobe Caslon Pro"},{name:"Adobe Caslon Pro Bold",value:"Adobe Caslon Pro Bold"},{name:"Adobe Devanagari",value:"Adobe Devanagari"},{name:"Adobe Fan Heiti Std B",value:"Adobe Fan Heiti Std B"},{name:"Adobe Fangsong Std R",value:"Adobe Fangsong Std R"},{name:"Adobe Garamond Pro",value:"Adobe Garamond Pro"},{name:"Adobe Garamond Pro Bold",value:"Adobe Garamond Pro Bold"},{name:"Adobe Gothic Std B",value:"Adobe Gothic Std B"},{name:"Adobe Hebrew",value:"Adobe Hebrew"},{name:"Adobe Heiti Std R",value:"Adobe Heiti Std R"},{name:"Adobe Kaiti Std R",value:"Adobe Kaiti Std R"},{name:"Adobe Ming Std L",value:"Adobe Ming Std L"},{name:"Adobe Myungjo Std M",value:"Adobe Myungjo Std M"},{name:"Adobe Naskh Medium",value:"Adobe Naskh Medium"},{name:"Adobe Song Std L",value:"Adobe Song Std L"},{name:"Agency FB",value:"Agency FB"},{name:"Aharoni",value:"Aharoni"},{name:"Albertus Medium",value:"Albertus Medium"},{name:"Alef",value:"Alef",fileNames:["alef_regular.ttf","alef_bold.ttf"],os:["lin"]},{name:"Alexandra Script",value:"Alexandra Script",fileNames:["alexandra_script.ttf"]},{name:"Algerian",value:"Algerian"},{name:"Amadeus",value:"Amadeus",fileNames:["amadeus_regular.ttf"]},{name:"Amazone BT",value:"Amazone BT"},{name:"AmdtSymbols",value:"AmdtSymbols",fileNames:["amdtsymbols_regular.ttf"]},{name:"AmerType Md BT",value:"AmerType Md BT"},{name:"American Typewriter",value:"American Typewriter",os:["mac"]},{name:"Amiri",value:"Amiri",os:["mac"]},{name:"AnastasiaScript",value:"AnastasiaScript"},{name:"Andale Mono",value:"Andale Mono",os:["mac"]},{name:"Andalus",value:"Andalus"},{name:"Angsana New",value:"Angsana New"},{name:"AngsanaUPC",value:"AngsanaUPC"},{name:"Ani",value:"Ani",os:["lin"]},{name:"AnjaliOldLipi",value:"AnjaliOldLipi",fileNames:["anjalioldlipi.ttf"],os:["lin"]},{name:"Annabelle",value:"Annabelle",fileNames:["annabelle.ttf"]},{name:"Antique Olive",value:"Antique Olive"},{name:"Aparajita",value:"Aparajita"},{name:"Apple Braille",value:"Apple Braille",os:["mac"]},{name:"Apple Chancery",value:"Apple Chancery",os:["mac"]},{name:"Apple Color Emoji",value:"Apple Color Emoji",os:["mac"]},{name:"Apple SD Gothic Neo",value:"Apple SD Gothic Neo",os:["mac"]},{name:"Apple Symbols",value:"Apple Symbols",os:["mac"]},{name:"AppleGothic",value:"AppleGothic",os:["mac"]},{name:"AppleMyungjo",value:"AppleMyungjo",os:["mac"]},{name:"Arabic Transparent",value:"Arabic Transparent"},{name:"Arabic Typesetting",value:"Arabic Typesetting"},{name:"Arial",value:"Arial",os:["win","mac"]},{name:"Arial Baltic",value:"Arial Baltic",os:["win","mac"]},{name:"Arial Black",value:"Arial Black",os:["win","mac"]},{name:"Arial CE",value:"Arial CE",os:["win","mac"]},{name:"Arial Cyr",value:"Arial Cyr",os:["win","mac"]},{name:"Arial Greek",value:"Arial Greek",os:["win","mac"]},{name:"Arial Hebrew",value:"Arial Hebrew",os:["win","mac"]},{name:"Arial MT",value:"Arial MT",os:["win","mac"]},{name:"Arial Narrow",value:"Arial Narrow",os:["win","mac"]},{name:"Arial Rounded MT Bold",value:"Arial Rounded MT Bold",os:["win","mac"]},{name:"Arial TUR",value:"Arial TUR",os:["win","mac"]},{name:"Arial Unicode MS",value:"Arial Unicode MS",os:["win","mac"]},{name:"Ariston",value:"Ariston",fileNames:["ariston.ttf"]},{name:"Arno Pro",value:"Arno Pro"},{name:"Arno Pro Caption",value:"Arno Pro Caption"},{name:"Arno Pro Display",value:"Arno Pro Display"},{name:"Arno Pro Light Display",value:"Arno Pro Light Display"},{name:"Arno Pro SmText",value:"Arno Pro SmText"},{name:"Arno Pro Smbd",value:"Arno Pro Smbd"},{name:"Arno Pro Smbd Caption",value:"Arno Pro Smbd Caption"},{name:"Arno Pro Smbd Display",value:"Arno Pro Smbd Display"},{name:"Arno Pro Smbd SmText",value:"Arno Pro Smbd SmText"},{name:"Arno Pro Smbd Subhead",value:"Arno Pro Smbd Subhead"},{name:"Arno Pro Subhead",value:"Arno Pro Subhead"},{name:"Arrus BT",value:"Arrus BT"},{name:"Athelas",value:"Athelas",os:["mac"]},{name:"Aurora Cn BT",value:"Aurora Cn BT"},{name:"AvantGarde Bk BT",value:"AvantGarde Bk BT"},{name:"AvantGarde Md BT",value:"AvantGarde Md BT"},{name:"Avenir",value:"Avenir",os:["mac"]},{name:"Avenir Next",value:"Avenir Next",os:["mac"]},{name:"Avenir Next Condensed",value:"Avenir Next Condensed",os:["mac"]},{name:"Ayuthaya",value:"Ayuthaya",os:["mac"]},{name:"Baghdad",value:"Baghdad",os:["mac"]},{name:"Bangla MN",value:"Bangla MN",os:["mac"]},{name:"Bangla Sangam MN",value:"Bangla Sangam MN",os:["mac"]},{name:"Bank Gothic",value:"Bank Gothic"},{name:"BankGothic Lt BT",value:"BankGothic Lt BT"},{name:"BankGothic Md BT",value:"BankGothic Md BT"},{name:"Baskerville",value:"Baskerville",os:["mac"]},{name:"Baskerville Old Face",value:"Baskerville Old Face",os:["mac"]},{name:"Batang",value:"Batang"},{name:"BatangChe",value:"BatangChe"},{name:"Bauhaus 93",value:"Bauhaus 93"},{name:"Bazooka",value:"Bazooka"},{name:"Beirut",value:"Beirut",os:["mac"]},{name:"Bell Gothic Std Black",value:"Bell Gothic Std Black",fileNames:["bell_gothic_std_black.otf"]},{name:"Bell Gothic Std Light",value:"Bell Gothic Std Light",fileNames:["bell_gothic_std_light.otf"]},{name:"Bell MT",value:"Bell MT"},{name:"Benguiat Bk BT",value:"Benguiat Bk BT"},{name:"Berlin Sans FB",value:"Berlin Sans FB"},{name:"Berlin Sans FB Demi",value:"Berlin Sans FB Demi"},{name:"Bernard MT Condensed",value:"Bernard MT Condensed"},{name:"BernhardFashion BT",value:"BernhardFashion BT"},{name:"BernhardMod BT",value:"BernhardMod BT"},{name:"Bickham Script One",value:"Bickham Script One",fileNames:["bickham_script_one.ttf"]},{name:"Bickham Script Pro Regular",value:"Bickham Script Pro Regular"},{name:"Bickham Script Pro Semibold",value:"Bickham Script Pro Semibold"},{name:"Bickham Script Two",value:"Bickham Script Two"},{name:"Big Caslon",value:"Big Caslon",os:["mac"]},{name:"Birch Std",value:"Birch Std"},{name:"BinnerD",value:"BinnerD"},{name:"Bitstream Vera Sans Mono",value:"Bitstream Vera Sans Mono"},{name:"Blackadder ITC",value:"Blackadder ITC"},{name:"Blackoak Std",value:"Blackoak Std"},{name:"BlairMdITC TT",value:"BlairMdITC TT"},{name:"Bodoni 72",value:"Bodoni 72",os:["mac"]},{name:"Bodoni 72 Oldstyle",value:"Bodoni 72 Oldstyle",os:["mac"]},{name:"Bodoni 72 Smallcaps",value:"Bodoni 72 Smallcaps",os:["mac"]},{name:"Bodoni MT",value:"Bodoni MT",os:["mac"]},{name:"Bodoni MT Black",value:"Bodoni MT Black",os:["mac"]},{name:"Bodoni MT Condensed",value:"Bodoni MT Condensed",os:["mac"]},{name:"Bodoni MT Poster Compressed",value:"Bodoni MT Poster Compressed",os:["mac"]},{name:"Book Antiqua",value:"Book Antiqua"},{name:"Bookman Old Style",value:"Bookman Old Style"},{name:"Bookshelf Symbol 7",value:"Bookshelf Symbol 7"},{name:"Boulder",value:"Boulder"},{name:"Bradley Hand",value:"Bradley Hand"},{name:"Bradley Hand ITC",value:"Bradley Hand ITC"},{name:"Bremen Bd BT",value:"Bremen Bd BT"},{name:"Britannic Bold",value:"Britannic Bold"},{name:"Broadway",value:"Broadway"},{name:"Browallia New",value:"Browallia New"},{name:"BrowalliaUPC",value:"BrowalliaUPC"},{name:"Brush Script MT",value:"Brush Script MT"},{name:"Brush Script Std",value:"Brush Script Std"},{name:"CG Omega",value:"CG Omega"},{name:"CG Times",value:"CG Times"},{name:"Caladea",value:"Caladea",fileNames:["caladea_bold.ttf","caladea_bold_italic.ttf","caladea-italic.ttf","caladea_regular.ttf"],os:["lin"]},{name:"Calibri",value:"Calibri",os:["win"]},{name:"Calibri Light",value:"Calibri Light",os:["win"]},{name:"Californian FB",value:"Californian FB"},{name:"Calisto MT",value:"Calisto MT"},{name:"Calligraph",value:"Calligraph"},{name:"Calligrapher",value:"Calligrapher"},{name:"Cambria",value:"Cambria",os:["win"]},{name:"Cambria Math",value:"Cambria Math",os:["win"]},{name:"Candara",value:"Candara",os:["win"]},{name:"Carrois Gothic SC",value:"Carrois Gothic SC",os:["mac"]},{name:"Carolina",value:"Carolina"},{name:"CaslonOpnface BT",value:"CaslonOpnface BT"},{name:"Castellar",value:"Castellar"},{name:"Centaur",value:"Centaur"},{name:"Century",value:"Century"},{name:"Century Gothic",value:"Century Gothic"},{name:"Century Schoolbook",value:"Century Schoolbook"},{name:"Ceremonious Two",value:"Ceremonious Two",fileNames:["ceremonious_two.ttf"]},{name:"Cezanne",value:"Cezanne"},{name:"Chalkboard",value:"Chalkboard",os:["mac"]},{name:"Chalkboard SE",value:"Chalkboard SE",os:["mac"]},{name:"Chalkduster",value:"Chalkduster",os:["mac"]},{name:"Chandas",value:"Chandas",os:["lin"]},{name:"Chaparral Pro",value:"Chaparral Pro"},{name:"Chaparral Pro Light",value:"Chaparral Pro Light"},{name:"Charlemagne Std",value:"Charlemagne Std"},{name:"Charlesworth",value:"Charlesworth"},{name:"Charter",value:"Charter",os:["mac"]},{name:"Charter BT",value:"Charter BT",os:["mac"]},{name:"Charter Bd BT",value:"Charter Bd BT",os:["mac"]},{name:"Chaucer",value:"Chaucer"},{name:"ChelthmITC Bk BT",value:"ChelthmITC Bk BT"},{name:"Chilanka",value:"Chilanka",fileNames:["chilanka_regular.ttf"],os:["lin"]},{name:"Chiller",value:"Chiller"},{name:"CityBlueprint",value:"CityBlueprint"},{name:"Clarendon",value:"Clarendon"},{name:"Clarendon BT",value:"Clarendon BT"},{name:"Clarendon Blk BT",value:"Clarendon Blk BT"},{name:"Clarendon Condensed",value:"Clarendon Condensed"},{name:"Clarendon Lt BT",value:"Clarendon Lt BT"},{name:"CloisterBlack BT",value:"CloisterBlack BT"},{name:"Cochin",value:"Cochin",os:["mac"]},{name:"Collapse",value:"Collapse",os:["mac"]},{name:"Colonna MT",value:"Colonna MT"},{name:"Comic Sans MS",value:"Comic Sans MS",os:["win","mac"]},{name:"CommercialPi BT",value:"CommercialPi BT"},{name:"CommercialScript BT",value:"CommercialScript BT"},{name:"Complex",value:"Complex"},{name:"Consolas",value:"Consolas",os:["win"]},{name:"Constantia",value:"Constantia",os:["win"]},{name:"Cooper Black",value:"Cooper Black"},{name:"Cooper Std Black",value:"Cooper Std Black"},{name:"Copperplate",value:"Copperplate",os:["mac"]},{name:"Copperplate Gothic",value:"Copperplate Gothic",os:["mac"]},{name:"Copperplate Gothic Bold",value:"Copperplate Gothic Bold",os:["mac"]},{name:"Copperplate Gothic Light",value:"Copperplate Gothic Light",os:["mac"]},{name:"Copyist",value:"Copyist"},{name:"Corbel",value:"Corbel",os:["win"]},{name:"Cordia New",value:"Cordia New"},{name:"CordiaUPC",value:"CordiaUPC"},{name:"Coronet",value:"Coronet"},{name:"CountryBlueprint",value:"CountryBlueprint"},{name:"Corsiva Hebrew",value:"Corsiva Hebrew",os:["mac"]},{name:"Courier",value:"Courier",os:["win","mac"]},{name:"Courier New",value:"Courier New",os:["win","mac"]},{name:"Courier New Baltic",value:"Courier New Baltic",os:["win","mac"]},{name:"Courier New CE",value:"Courier New CE",os:["win","mac"]},{name:"Courier New Cyr",value:"Courier New Cyr",os:["win","mac"]},{name:"Courier New Greek",value:"Courier New Greek",os:["win","mac"]},{name:"Courier New TUR",value:"Courier New TUR",os:["win","mac"]},{name:"Curlz MT",value:"Curlz MT"},{name:"DFKai-SB",value:"DFKai-SB"},{name:"DIN Alternate",value:"DIN Alternate",os:["mac"]},{name:"DIN Condensed",value:"DIN Condensed",os:["mac"]},{name:"Damascus",value:"Damascus",os:["mac"]},{name:"Dancing Script",value:"Dancing Script",fileNames:["dancing_script_bold.ttf","dancing_script_medium.ttf","dancing_script_regular.ttf","dancing_script_semibold.ttf"],os:["lin","mac"]},{name:"DaunPenh",value:"DaunPenh"},{name:"Dauphin",value:"Dauphin"},{name:"David",value:"David",os:["win","lin"]},{name:"David CLM",value:"David",os:["mac"]},{name:"David Libre",value:"David Libre",fileNames:["david_libre_bold.ttf","david_libre_medium.ttf","david_libre_regular.ttf"],os:["win","lin"]},{name:"Decor",value:"Decor"},{name:"DejaVu Sans",value:"DejaVu Sans",os:["win","lin","mac"]},{name:"DejaVu Sans Condensed",value:"DejaVu Sans Condensed",os:["win","lin","mac"]},{name:"DejaVu Sans Light",value:"DejaVu Sans Light",os:["win","lin","mac"]},{name:"DejaVu Sans Mono",value:"DejaVu Sans Mono",os:["win","lin","mac"]},{name:"DejaVu Serif",value:"DejaVu Serif",os:["win","lin","mac"]},{name:"DejaVu Serif Condensed",value:"DejaVu Serif Condensed",os:["win","lin","mac"]},{name:"Devanagari MT",value:"Devanagari MT",os:["mac"]},{name:"Devanagari Sangam MN",value:"Devanagari Sangam MN",os:["mac"]},{name:"Didot",value:"Didot",os:["mac"]},{name:"DilleniaUPC",value:"DilleniaUPC"},{name:"Diwan Kufi",value:"Diwan Kufi",os:["mac"]},{name:"Diwan Thuluth",value:"Diwan Thuluth",os:["mac"]},{name:"DokChampa",value:"DokChampa"},{name:"Dotum",value:"Dotum"},{name:"DotumChe",value:"DotumChe"},{name:"Droid Sans",value:"Droid Sans",os:["lin","mac"]},{name:"Droid Sans Mono",value:"Droid Sans Mono",os:["lin","mac"]},{name:"Dutch801 Rm BT",value:"Dutch801 Rm BT"},{name:"Dutch801 XBd BT",value:"Dutch801 XBd BT"},{name:"Dyuthi",value:"Dyuthi",fileNames:["dyuthi.ttf"],os:["lin"]},{name:"Ebrima",value:"Ebrima",os:["win"]},{name:"Eccentric Std",value:"Eccentric Std"},{name:"Edwardian Script ITC",value:"Edwardian Script ITC"},{name:"Elephant",value:"Elephant"},{name:"Engravers MT",value:"Engravers MT"},{name:"EngraversGothic BT",value:"EngraversGothic BT"},{name:"Eras Bold ITC",value:"Eras Bold ITC"},{name:"Eras Demi ITC",value:"Eras Demi ITC"},{name:"Eras Light ITC",value:"Eras Light ITC"},{name:"Eras Medium ITC",value:"Eras Medium ITC"},{name:"Estrangelo Edessa",value:"Estrangelo Edessa"},{name:"EucrosiaUPC",value:"EucrosiaUPC"},{name:"Euphemia",value:"Euphemia",os:["mac"]},{name:"Euphemia UCAS",value:"Euphemia UCAS",os:["mac"]},{name:"EuroRoman",value:"EuroRoman"},{name:"Eurostile",value:"Eurostile"},{name:"Exotc350 Bd BT",value:"Exotc350 Bd BT"},{name:"FangSong",value:"FangSong"},{name:"Farah",value:"Farah",os:["mac"]},{name:"Farisi",value:"Farisi",os:["mac"]},{name:"Felix Titling",value:"Felix Titling"},{name:"Fixedsys",value:"Fixedsys",fileNames:["fixedsys.ttf"]},{name:"Footlight MT Light",value:"Footlight MT Light"},{name:"Forte",value:"Forte"},{name:"Frank Ruehl",value:"Frank Ruehl",os:["win","lin"]},{name:"Frank Ruehl Libre Black",value:"Frank Ruehl Libre Black",fileNames:["frank_ruhl_libre_black.ttf"],os:["win","lin"]},{name:"Frank Ruehl Libre",value:"Frank Ruehl Libre",fileNames:["frank_ruhl_libre_regular.ttf","frank_ruhl_libre_bold.ttf","frank_ruhl_libre_medium.ttf"],os:["win","lin"]},{name:"Frank Ruehl Libre Light",value:"Frank Ruehl Libre Light",fileNames:["frank_ruhl_libre_light.ttf"],os:["win","lin"]},{name:"Franklin Gothic Book",value:"Franklin Gothic Book",os:["win"]},{name:"Franklin Gothic Demi",value:"Franklin Gothic Demi",os:["win"]},{name:"Franklin Gothic Demi Cond",value:"Franklin Gothic Demi Cond",os:["win"]},{name:"Franklin Gothic Heavy",value:"Franklin Gothic Heavy",os:["win"]},{name:"Franklin Gothic Medium",value:"Franklin Gothic Medium",os:["win"]},{name:"Franklin Gothic Medium Cond",value:"Franklin Gothic Medium Cond",os:["win"]},{name:"Freefrm721 Blk BT",value:"Freefrm721 Blk BT"},{name:"Freehand521 BT",value:"Freehand521 BT"},{name:"FreeMono",value:"FreeMono",fileNames:["freemono.ttf","freemono_bold.ttf","freemono_bold_oblique.ttf","freemono_oblique.ttf"],os:["lin"]},{name:"FreeSans",value:"FreeSans",fileNames:["freesans.ttf","freesans_bold.ttf","freesans_bold_oblique.ttf","freesans_oblique.ttf"],os:["lin"]},{name:"FreeSerif",value:"FreeSerif",fileNames:["freeserif.ttf","freeserif_bold.ttf","freeserif_bold_italic.ttf","freeserif_italic.ttf"],os:["lin"]},{name:"FreesiaUPC",value:"FreesiaUPC"},{name:"Freestyle Script",value:"Freestyle Script"},{name:"French Script MT",value:"French Script MT"},{name:"FrnkGothITC Bk BT",value:"FrnkGothITC Bk BT"},{name:"Frutiger",value:"Frutiger"},{name:"Futura",value:"Futura",os:["mac"]},{name:"Futura Bk BT",value:"Futura Bk BT",os:["mac"]},{name:"Futura Lt BT",value:"Futura Lt BT",os:["mac"]},{name:"Futura Md BT",value:"Futura Md BT",os:["mac"]},{name:"FuturaBlack BT",value:"FuturaBlack BT",os:["mac"]},{name:"GDT",value:"GDT"},{name:"GENISO",value:"GENISO"},{name:"Gabriola",value:"Gabriola",os:["win"]},{name:"Gadugi",value:"Gadugi",os:["win"]},{name:"Galliard BT",value:"Galliard BT"},{name:"Garamond",value:"Garamond"},{name:"Garamond Premr Pro",value:"Garamond Premr Pro"},{name:"Garamond Premr Pro Smbd",value:"Garamond Premr Pro Smbd"},{name:"Gargi",value:"Gargi",fileNames:["gargi.ttf"],os:["lin"]},{name:"Garuda",value:"Garuda",os:["lin"]},{name:"Gautami",value:"Gautami"},{name:"Geeza Pro",value:"Geeza Pro",os:["mac"]},{name:"Geneva",value:"Geneva",os:["mac"]},{name:"Gentium Basic",value:"Gentium Basic",fileNames:["gentium_basic.ttf","gentium_basic_bold.ttf","gentium_basic_bold_italic.ttf","gentium_basic_italic.ttf"]},{name:"Gentium Book Basic",value:"Gentium Book Basic",fileNames:["gentium_book_basic.ttf","gentium_book_basic_bold.ttf","gentium_book_basic_bold_italic.ttf","gentium_book_basic_italic.ttf"]},{name:"Geometr231 BT",value:"Geometr231 BT"},{name:"Geometr231 Hv BT",value:"Geometr231 Hv BT"},{name:"Geometr231 Lt BT",value:"Geometr231 Lt BT"},{name:"Georgia",value:"Georgia",os:["win","mac"]},{name:"Giddyup Std",value:"Giddyup Std"},{name:"Gigi",value:"Gigi"},{name:"Gill Sans",value:"Gill Sans",os:["mac","win"]},{name:"Gill Sans MT",value:"Gill Sans MT",os:["mac","win"]},{name:"Gill Sans MT Condensed",value:"Gill Sans MT Condensed",os:["mac","win"]},{name:"Gill Sans MT Ext Condensed Bold",value:"Gill Sans MT Ext Condensed Bold",os:["mac"]},{name:"Gill Sans Ultra Bold",value:"Gill Sans Ultra Bold",os:["mac","win"]},{name:"Gill Sans Ultra Bold Condensed",value:"Gill Sans Ultra Bold Condensed",os:["mac","win"]},{name:"Gisha",value:"Gisha"},{name:"Gloucester MT Extra Condensed",value:"Gloucester MT Extra Condensed"},{name:"Gotham",value:"Gotham"},{name:"Gotham Bold",value:"Gotham Bold"},{name:"GothicE",value:"GothicE"},{name:"GothicG",value:"GothicG"},{name:"GothicI",value:"GothicI"},{name:"Goudy Old Style",value:"Goudy Old Style"},{name:"Goudy Stout",value:"Goudy Stout"},{name:"GoudyHandtooled BT",value:"GoudyHandtooled BT"},{name:"GreekC",value:"GreekC",fileNames:["greekc.ttf"]},{name:"GreekS",value:"GreekS",fileNames:["greeks.ttf"]},{name:"Gubbi",value:"Gubbi",fileNames:["gubbi.ttf"],os:["lin"]},{name:"Gujarati MT",value:"Gujarati MT",os:["mac"]},{name:"Gujarati Sangam MN",value:"Gujarati Sangam MN",os:["mac"]},{name:"Gulim",value:"Gulim"},{name:"GulimChe",value:"GulimChe"},{name:"Gungsuh",value:"Gungsuh"},{name:"GungsuhChe",value:"GungsuhChe"},{name:"Gurmukhi MN",value:"Gurmukhi MN",os:["mac"]},{name:"Gurmukhi MT",value:"Gurmukhi MT",os:["mac"]},{name:"Gurmukhi Sangam MN",value:"Gurmukhi Sangam MN",os:["mac"]},{name:"Haettenschweiler",value:"Haettenschweiler"},{name:"Harlow Solid Italic",value:"Harlow Solid Italic"},{name:"Harrington",value:"Harrington"},{name:"Heather",value:"Heather"},{name:"Heather Script One",value:"Heather Script One"},{name:"Heiti SC",value:"Heiti SC",os:["mac"]},{name:"Heiti TC",value:"Heiti TC",os:["mac"]},{name:"Helvetica",value:"Helvetica",os:["mac"]},{name:"Helvetica Neue",value:"Helvetica Neue",os:["mac"]},{name:"Herculanum",value:"Herculanum",os:["mac"]},{name:"High Tower Text",value:"High Tower Text"},{name:"Hiragino Kaku Gothic Pro",value:"Hiragino Kaku Gothic Pro",os:["mac"]},{name:"Hiragino Kaku Gothic ProN",value:"Hiragino Kaku Gothic ProN",os:["mac"]},{name:"Hiragino Kaku Gothic Std",value:"Hiragino Kaku Gothic StdN",os:["mac"]},{name:"Hiragino Kaku Gothic ProN",value:"Hiragino Kaku Gothic ProN",os:["mac"]},{name:"Hiragino Maru Pro",value:"Hiragino Maru Pro",os:["mac"]},{name:"Hiragino Maru ProN",value:"Hiragino Maru ProN",os:["mac"]},{name:"Hiragino Mincho Pro",value:"Hiragino Mincho Pro",os:["mac"]},{name:"Hiragino Mincho ProN",value:"Hiragino Mincho ProN",os:["mac"]},{name:"Hiragino Sans",value:"Hiragino Sans",os:["mac"]},{name:"Hiragino Sans GB",value:"Hiragino Sans GB",os:["mac"]},{name:"Hobo Std",value:"Hobo Std"},{name:"Hoefler Text",value:"Hoefler Text",os:["mac"]},{name:"Humanst521 BT",value:"Humanst521 BT"},{name:"Humanst521 Lt BT",value:"Humanst521 Lt BT"},{name:"ISOCP",value:"ISOCP"},{name:"ISOCP2",value:"ISOCP2"},{name:"ISOCP3",value:"ISOCP3"},{name:"ISOCPEUR",value:"ISOCPEUR"},{name:"ISOCT",value:"ISOCT"},{name:"ISOCT2",value:"ISOCT2"},{name:"ISOCT3",value:"ISOCT3"},{name:"ISOCTEUR",value:"ISOCTEUR"},{name:"ITF Devanagari",value:"ITF Devanagari",os:["mac"]},{name:"ITF Devanagari Marathi",value:"ITF Devanagari, Marathi",os:["mac"]},{name:"Impact",value:"Impact",os:["win","mac"]},{name:"Imprint MT Shadow",value:"Imprint MT Shadow"},{name:"InaiMathi",value:"InaiMathi",os:["mac"]},{name:"Incised901 BT",value:"Incised901 BT"},{name:"Incised901 Bd BT",value:"Incised901 Bd BT"},{name:"Incised901 Lt BT",value:"Incised901 Lt BT"},{name:"Inconsolata",value:"Inconsolata",fileNames:["inconsolata.otf"]},{name:"Informal Roman",value:"Informal Roman"},{name:"Informal011 BT",value:"Informal011 BT"},{name:"Interstate",value:"Interstate"},{name:"Iowan Old Style",value:"Iowan Old Style",os:["mac"]},{name:"IrisUPC",value:"IrisUPC"},{name:"Iskoola Pota",value:"Iskoola Pota"},{name:"Italic",value:"Italic"},{name:"ItalicC",value:"ItalicC"},{name:"ItalicT",value:"ItalicT"},{name:"Jamrul",value:"Jamrul",fileNames:["jamrul.ttf"],os:["lin"]},{name:"JasmineUPC",value:"JasmineUPC"},{name:"Jazz LET",value:"Jazz LET"},{name:"Jester",value:"Jester"},{name:"Jokerman",value:"Jokerman"},{name:"Juice ITC",value:"Juice ITC"},{name:"Kabel Bk BT",value:"Kabel Bk BT"},{name:"Kabel Ult BT",value:"Kabel Ult BT"},{name:"KacstBook",value:"KacstBook",fileNames:["kacstbook.ttf"],os:["win","lin"]},{name:"KacstLetter",value:"KacstLetter",fileNames:["kacstletter.ttf"],os:["win","lin"]},{name:"KacstOffice",value:"KacstOffice",fileNames:["kacstoffice.ttf"],os:["win","lin"]},{name:"KacstNaskh",value:"KacstNaskh",fileNames:["kacstnaskh.ttf"],os:["win","lin"]},{name:"KacstTitlel",value:"KacstTitlel",fileNames:["kacsttitlel.ttf"],os:["win","lin"]},{name:"KaiTi",value:"KaiTi"},{name:"Kailasa",value:"Kailasa",os:["mac"]},{name:"Kalapi",value:"Kalapi",os:["lin"]},{name:"Kalinga",value:"Kalinga"},{name:"Kalimati",value:"Kalimati",os:["lin"]},{name:"Kannada MN",value:"Kannada MN",os:["mac"]},{name:"Kannada Sangam MN",value:"Kannada Sangam MN",os:["mac"]},{name:"Kartika",value:"Kartika"},{name:"Karumbi",value:"Karumbi",os:["lin"]},{name:"Kaufmann BT",value:"Kaufmann BT"},{name:"Kaufmann Bd BT",value:"Kaufmann Bd BT"},{name:"Kefa",value:"Kefa",os:["mac"]},{name:"Khmer MN",value:"Khmer MN",os:["mac"]},{name:"Khmer OS",value:"Khmer OS",os:["lin"]},{name:"Khmer Sangam MN",value:"Khmer Sangam MN",os:["mac"]},{name:"Khmer UI",value:"Khmer UI",os:["lin"]},{name:"Kinnari",value:"Kinnari",os:["lin"]},{name:"KodchiangUPC",value:"KodchiangUPC"},{name:"Kohinoor Bangla",value:"Kohinoor Bangla",os:["mac"]},{name:"Kohinoor Devanagari",value:"Kohinoor Devanagari",os:["mac"]},{name:"Kohinoor Telugu",value:"Kohinoor Telugu",os:["mac"]},{name:"Kokila",value:"Kokila"},{name:"Kokonor",value:"Kokonor",os:["mac"]},{name:"Korinna BT",value:"Korinna BT"},{name:"Kozuka Gothic Pr6N B",value:"Kozuka Gothic Pr6N B"},{name:"Kozuka Gothic Pr6N EL",value:"Kozuka Gothic Pr6N EL"},{name:"Kozuka Gothic Pr6N H",value:"Kozuka Gothic Pr6N H"},{name:"Kozuka Gothic Pr6N L",value:"Kozuka Gothic Pr6N L"},{name:"Kozuka Gothic Pr6N M",value:"Kozuka Gothic Pr6N M"},{name:"Kozuka Gothic Pr6N R",value:"Kozuka Gothic Pr6N R"},{name:"Kozuka Gothic Pro B",value:"Kozuka Gothic Pro B"},{name:"Kozuka Gothic Pro EL",value:"Kozuka Gothic Pro EL"},{name:"Kozuka Gothic Pro H",value:"Kozuka Gothic Pro H"},{name:"Kozuka Gothic Pro L",value:"Kozuka Gothic Pro L"},{name:"Kozuka Gothic Pro M",value:"Kozuka Gothic Pro M"},{name:"Kozuka Gothic Pro R",value:"Kozuka Gothic Pro R"},{name:"Kozuka Mincho Pr6N B",value:"Kozuka Mincho Pr6N B"},{name:"Kozuka Mincho Pr6N EL",value:"Kozuka Mincho Pr6N EL"},{name:"Kozuka Mincho Pr6N H",value:"Kozuka Mincho Pr6N H"},{name:"Kozuka Mincho Pr6N L",value:"Kozuka Mincho Pr6N L"},{name:"Kozuka Mincho Pr6N M",value:"Kozuka Mincho Pr6N M"},{name:"Kozuka Mincho Pr6N R",value:"Kozuka Mincho Pr6N R"},{name:"Kozuka Mincho Pro B",value:"Kozuka Mincho Pro B"},{name:"Kozuka Mincho Pro EL",value:"Kozuka Mincho Pro EL"},{name:"Kozuka Mincho Pro H",value:"Kozuka Mincho Pro H"},{name:"Kozuka Mincho Pro L",value:"Kozuka Mincho Pro L"},{name:"Kozuka Mincho Pro M",value:"Kozuka Mincho Pro M"},{name:"Kozuka Mincho Pro R",value:"Kozuka Mincho Pro R"},{name:"Kristen ITC",value:"Kristen ITC"},{name:"Krungthep",value:"Krungthep",os:["mac"]},{name:"KufiStandartGK",value:"KufiStandartGK",os:["mac"]},{name:"Kunstler Script",value:"Kunstler Script"},{name:"Laksaman",value:"Laksaman",os:["lin"]},{name:"Lao MN",value:"Lao MN",os:["mac"]},{name:"Lao Sangam MN",value:"Lao Sangam MN",os:["mac"]},{name:"Lao UI",value:"Lao UI",os:["mac"]},{name:"Latha",value:"Latha"},{name:"Laveric",value:"Laveric",fileNames:["laverick_bold.ttf","laverick.ttf"]},{name:"Leelawadee",value:"Leelawadee",os:["win"]},{name:"Letter Gothic Std",value:"Letter Gothic Std"},{name:"Levenim MT",value:"Levenim MT"},{name:"Liberation Mono",value:"Liberation Mono",fileNames:["liberation_mono_bold.ttf","liberation_mono_bold_italic.ttf","liberation_mono_italic.ttf","liberation-mono_regular.ttf"],os:["win","lin","mac"]},{name:"Liberation Sans Narrow",value:"Liberation Sans Narrow",fileNames:["liberation_sans_narrow.ttf","liberation_sans_narrow_bold.ttf","liberation_sans_narrow_bold_italic.ttf","liberation_sans_narrow_italic.ttf"],os:["win","lin","mac"]},{name:"Liberation Sans",value:"Liberation Sans",fileNames:["liberation_sans.otf","liberation_sans_bold.otf","liberation_sans_bold_italic.otf","liberation_sans_italic.otf"],os:["win","lin","mac"]},{name:"Liberation Serif",value:"Liberation Serif",fileNames:["liberation_serif_bold.ttf","liberation_serif_bold_italic.ttf","liberation_serif_italic.ttf","liberation_serif_regular.ttf"],os:["win","lin","mac"]},{name:"LilyUPC",value:"LilyUPC"},{name:"Lithograph",value:"Lithograph"},{name:"Lithograph Light",value:"Lithograph Light"},{name:"Lithos Pro Regular",value:"Lithos Pro Regular"},{name:"Lohit Devanagari",value:"Lohit Devanagari",fileNames:["lohit_devanagari.ttf"],os:["lin"]},{name:"Lohit Telugu",value:"Lohit Telugu",fileNames:["lohit_telugu.ttf"],os:["lin"]},{name:"Loma",value:"Loma",os:["lin"]},{name:"Lucida Bright",value:"Lucida Bright",os:["win"]},{name:"Lucida Calligraphy",value:"Lucida Calligraphy",os:["win"]},{name:"Lucida Console",value:"Lucida Console",os:["win"]},{name:"Lucida Fax",value:"Lucida Fax"},{name:"Lucida Grande",value:"Lucida Grande",os:["mac"]},{name:"Lucida Handwriting",value:"Lucida Handwriting"},{name:"Lucida Sans",value:"Lucida Sans"},{name:"Lucida Sans Typewriter",value:"Lucida Sans Typewriter"},{name:"Lucida Sans Unicode",value:"Lucida Sans Unicode",os:["win"]},{name:"Luminari",value:"Luminari",os:["mac"]},{name:"Lydian BT",value:"Lydian BT"},{name:"MONO",value:"MONO"},{name:"MS Gothic",value:"MS Gothic",os:["win"]},{name:"MS LineDraw",value:"MS LineDraw",os:["win"]},{name:"MS Mincho",value:"MS Mincho",os:["win"]},{name:"MS Outlook",value:"MS Outlook",os:["win"]},{name:"MS PGothic",value:"MS PGothic",os:["win"]},{name:"MS PMincho",value:"MS PMincho",os:["win"]},{name:"MS Reference Sans Serif",value:"MS Reference Sans Serif",os:["win"]},{name:"MS Reference Specialty",value:"MS Reference Specialty",os:["win"]},{name:"MS Sans Serif",value:"MS Sans Serif",os:["win"]},{name:"MS Serif",value:"MS Serif",os:["win"]},{name:"MS UI Gothic",value:"MS UI Gothic",os:["win"]},{name:"MT Extra",value:"MT Extra"},{name:"MV Boli",value:"MV Boli",os:["win"]},{name:"Magneto",value:"Magneto"},{name:"Maiandra GD",value:"Maiandra GD"},{name:"Malayalam MN",value:"Malayalam MN",os:["mac"]},{name:"Malayalam Sangam MN",value:"Malayalam Sangam MN",os:["mac"]},{name:"Malgun Gothic",value:"Malgun Gothic",os:["win"]},{name:"Mangal",value:"Mangal"},{name:"Manjari",value:"Manjari",fileNames:["manjari_bold.ttf","manjari_regular.ttf"],os:["lin"]},{name:"Marigold",value:"Marigold"},{name:"Marion",value:"Marion",os:["mac"]},{name:"Marker Felt",value:"Marker Felt",fileNames:["marker_felt.ttf"],os:["mac"]},{name:"Marlett",value:"Marlett",os:["win"]},{name:"Matisse ITC",value:"Matisse ITC"},{name:"Matura MT Script Capitals",value:"Matura MT Script Capitals"},{name:"Meera",value:"Meera",os:["lin"]},{name:"Meera Inimai",value:"Meera Inimai",fileNames:["meera_inimai_regular.ttf"],os:["lin"]},{name:"Meiryo",value:"Meiryo"},{name:"Meiryo UI",value:"Meiryo UI"},{name:"Menlo",value:"Menlo",os:["mac"]},{name:"Mesquite Std",value:"Mesquite Std"},{name:"Microsoft Himalaya",value:"Microsoft Himalaya",os:["win"]},{name:"Microsoft JhengHei",value:"Microsoft JhengHei",os:["win"]},{name:"Microsoft JhengHei UI",value:"Microsoft JhengHei UI",os:["win"]},{name:"Microsoft New Tai Lue",value:"Microsoft New Tai Lue",os:["win"]},{name:"Microsoft PhagsPa",value:"Microsoft PhagsPa",os:["win"]},{name:"Microsoft Sans Serif",value:"Microsoft Sans Serif",os:["win","mac"]},{name:"Microsoft Tai Le",value:"Microsoft Tai Le",os:["win"]},{name:"Microsoft Uighur",value:"Microsoft Uighur",os:["win"]},{name:"Microsoft YaHei",value:"Microsoft YaHei",os:["win"]},{name:"Microsoft YaHei UI",value:"Microsoft YaHei UI",os:["win"]},{name:"Microsoft Yi Baiti",value:"Microsoft Yi Baiti",os:["win"]},{name:"MingLiU",value:"MingLiU",os:["win"]},{name:"MingLiU-ExtB",value:"MingLiU-ExtB",os:["win"]},{name:"MingLiU_HKSCS",value:"MingLiU_HKSCS",os:["win"]},{name:"MingLiU_HKSCS-ExtB",value:"MingLiU_HKSCS-ExtB",os:["win"]},{name:"Minion",value:"Minion"},{name:"Minion Pro",value:"Minion Pro"},{name:"Minion Pro Cond",value:"Minion Pro Cond"},{name:"Minion Pro Med",value:"Minion Pro Med"},{name:"Minion Pro SmBd",value:"Minion Pro SmBd"},{name:"Miriam",value:"Miriam",os:["win","lin"]},{name:"Miriam Fixed",value:"Miriam Fixed",os:["win","lin"]},{name:"Miriam Libre",value:"Miriam Libre",fileNames:["miriam_libre_bold.ttf","miriam_libre_regular.ttf"],os:["win","lin"]},{name:"Mishafi",value:"Mishafi",os:["mac"]},{name:"Mishafi Gold",value:"Mishafi Gold",os:["mac"]},{name:"Mistral",value:"Mistral"},{name:"Mitra Mono",value:"Mitra Mono",os:["lin"]},{name:"Modern",value:"Modern"},{name:"Modern No. 20",value:"Modern No. 20"},{name:"Mona Lisa Solid ITC TT",value:"Mona Lisa Solid ITC TT"},{name:"Monaco",value:"Monaco",os:["mac"]},{name:"Mongolian Baiti",value:"Mongolian Baiti",os:["win"]},{name:"Monospac821 BT",value:"Monospac821 BT"},{name:"Monotxt",value:"Monotxt"},{name:"Monotype Corsiva",value:"Monotype Corsiva"},{name:"MoolBoran",value:"MoolBoran"},{name:"Mshtakan",value:"Mshtakan",os:["mac"]},{name:"Mukti Narrow",value:"Mukti Narrow",fileNames:["mukti_narrow.ttf","mukti_narrow_bold.ttf"],os:["lin"]},{name:"Muna",value:"Muna",os:["mac"]},{name:"Muanmar MN",value:"Muanmar MN",os:["mac"]},{name:"Muanmar Sangam MN",value:"Muanmar Sangam MN",os:["mac"]},{name:"Myriad Arabic",value:"Myriad Arabic"},{name:"Myriad Hebrew",value:"Myriad Hebrew"},{name:"Myriad Pro",value:"Myriad Pro"},{name:"Myriad Pro Cond",value:"Myriad Pro Cond"},{name:"Myriad Pro Light",value:"Myriad Pro Light"},{name:"Myriad Web Pro",value:"Myriad Web Pro"},{name:"NSimSun",value:"NSimSun",os:["win"]},{name:"Nadeem",value:"Nadeem",os:["mac"]},{name:"Nakula",value:"Nakula",fileNames:["nakula_regular.ttf"],os:["lin"]},{name:"Narkisim",value:"Narkisim"},{name:"Navuli",value:"Navuli",os:["lin"]},{name:"News Gothic",value:"News Gothic"},{name:"NewsGoth BT",value:"NewsGoth BT"},{name:"New Peninim MT",value:"New Peninim MT",os:["mac"]},{name:"Niagara Engraved",value:"Niagara Engraved"},{name:"Niagara Solid",value:"Niagara Solid"},{name:"Nimbus Roman",value:"Nimbus Roman",os:["lin"]},{name:"Nimbus Sans",value:"Nimbus Sans",os:["lin"]},{name:"Nimbus Sans Narrow",value:"Nimbus Sans Narrow",os:["lin"]},{name:"Nirmala UI",value:"Nirmala UI",os:["win"]},{name:"Norasi",value:"Norasi",fileNames:["norasi.ttf","norasi_bold.ttf","norasi_bold_italic.ttf","norasi_italic.ttf"],os:["lin"]},{name:"Noteworthy",value:"Noteworthy",os:["mac"]},{name:"Noto Kufi Arabic",value:"Noto Kufi Arabic",os:["mac"]},{name:"Noto Mono",value:"Noto Mono",fileNames:["noto_mono_regular.ttf"],os:["win","lin"]},{name:"Noto Nastaliq Urdu",value:"Noto Nastaliq Urdu",os:["mac"]},{name:"Noto Sans",value:"Noto Sans",fileNames:["noto_sans_bold.ttf","noto_sans_bold_italic.ttf","noto_sans_italic.ttf","noto_sans_regular.ttf"],os:["win","lin"]},{name:"Noto Sans Arabic UI",value:"Noto Sans Arabic UI",os:["win","lin"]},{name:"Noto Sans CJK HK",value:"Noto Sans CJK HK",os:["win","lin"]},{name:"Noto Sans CJK JP",value:"Noto Sans CJK JP",os:["win","lin"]},{name:"Noto Sans CJK KR",value:"Noto Sans CJK KR",os:["win","lin"]},{name:"Noto Sans CJK SC",value:"Noto Sans CJK SC",fileNames:["noto_sans_cjk_sc_black.otf","noto_sans_cjk_sc_bold.otf","noto_sans_cjk_sc_demilight.otf","noto_sans_cjk_sc_light.otf","noto_sans_cjk_sc_medium.otf","noto_sans_cjk_sc_regular.otf","noto_sans_cjk_sc_thin.otf"],os:["win","lin"]},{name:"Noto Sans CJK TC",value:"Noto Sans CJK TC",os:["win","lin"]},{name:"Noto Sans Lisu",value:"Noto Sans Lisu",os:["win","lin"]},{name:"Noto Sans Mono CJK HK",value:"Noto Sans Mono CJK HK",os:["win","lin"]},{name:"Noto Sans Mono CJK JP",value:"Noto Sans Mono CJK JP",os:["win","lin"]},{name:"Noto Sans Mono CJK KR",value:"Noto Sans Mono CJK KR",os:["win","lin"]},{name:"Noto Sans Mono CJK SC",value:"Noto Sans Mono CJK SC",os:["win","lin"]},{name:"Noto Sans Mono CJK TC",value:"Noto Sans Mono CJK TC",os:["win","lin"]},{name:"Noto Serif",value:"Noto Serif",fileNames:["noto_serif_regular.ttf","noto_serif_italic.ttf","noto_serif_bold_italic.ttf","noto_serif_bold.ttf"],os:["win","lin"]},{name:"Noto Serif CJK JP",value:"Noto Serif CJK JP",os:["win","lin"]},{name:"Noto Serif CJK KR",value:"Noto Serif CJK KR",os:["win","lin"]},{name:"Noto Serif CJK SC",value:"Noto Serif CJK SC",os:["win","lin"]},{name:"Noto Serif CJK TC",value:"Noto Serif CJK TC",os:["win","lin"]},{name:"Noto Serif Georgian",value:"Noto Serif Georgian",os:["win","lin"]},{name:"Noto Serif Hebrew",value:"Noto Serif Hebrew",os:["win","lin"]},{name:"Noto Serif Italic",value:"Noto Serif Italic",os:["win","lin"]},{name:"Noto Serif Lao",value:"Noto Serif Lao",os:["win","lin"]},{name:"Nueva Std",value:"Nueva Std"},{name:"Nueva Std Cond",value:"Nueva Std Cond"},{name:"Nyala",value:"Nyala"},{name:"OCR A Extended",value:"OCR A Extended"},{name:"OCR A Std",value:"OCR A Std"},{name:"OCR-A BT",value:"OCR-A BT"},{name:"OCR-B 10 BT",value:"OCR-B 10 BT"},{name:"Old English Text MT",value:"Old English Text MT"},{name:"Onyx",value:"Onyx"},{name:"Onyx BT",value:"Onyx BT"},{name:"OpenSymbol",value:"OpenSymbol",fileNames:["opensymbol.ttf"],os:["win","lin"]},{name:"Optima",value:"Optima",os:["mac"]},{name:"Orator Std",value:"Orator Std"},{name:"Oriya MN",value:"Oriya MN",os:["mac"]},{name:"Oriya Sangam MN",value:"Oriya Sangam MN",os:["mac"]},{name:"Osaka",value:"Osaka",fileNames:["osaka.ttf"]},{name:"Oswald",value:"Oswald",fileNames:["oswald_bold.ttf","oswald_extralight.ttf","oswald_light.ttf","oswald_medium.ttf","oswald_regular.ttf","oswald_semibold.ttf"],os:["win","lin"]},{name:"Ouverture script",value:"Ouverture script",fileNames:["ouverture_script.ttf"]},{name:"OzHandicraft BT",value:"OzHandicraft BT"},{name:"PMingLiU",value:"PMingLiU",os:["win"]},{name:"PMingLiU-ExtB",value:"PMingLiU-ExtB",os:["win"]},{name:"PT Mono",value:"PT Mono",os:["mac"]},{name:"PT Sans",value:"PT Sans",os:["mac"]},{name:"PT Sans Caption",value:"PT Mono Caption",os:["mac"]},{name:"PT Sans Narrow",value:"PT Sans Narrow",os:["mac"]},{name:"PT Serif",value:"PT Serif",os:["mac"]},{name:"PT Serif Caption",value:"PT Serif Caption",os:["mac"]},{name:"Padauk",value:"Padauk",fileNames:["padauk_bold.ttf","padauk_regular.ttf"],os:["lin"]},{name:"Padauk Book",value:"Padauk Book",fileNames:["padauk_book_bold.ttf","padauk_book.ttf"],os:["lin"]},{name:"Palace Script MT",value:"Palace Script MT"},{name:"Pagul",value:"Pagul",os:["lin"]},{name:"Palatino",value:"Palatino",os:["win","mac"]},{name:"Palatino Linotype",value:"Palatino Linotype",os:["win","mac"]},{name:"PanRoman",value:"PanRoman"},{name:"Papyrus",value:"Papyrus",os:["mac"]},{name:"Parchment",value:"Parchment"},{name:"Party LET",value:"Party LET"},{name:"Perpetua",value:"Perpetua"},{name:"Perpetua Titling MT",value:"Perpetua Titling MT"},{name:"Phetsarath OT",value:"Phetsarath OT",fileNames:["phetsarath_ot.ttf"],os:["lin"]},{name:"Phosphate",value:"Phosphate",os:["mac"]},{name:"PingFang HK",value:"PingFang HK",os:["mac"]},{name:"PingFang SC",value:"PingFang SC",os:["mac"]},{name:"PingFang TC",value:"PingFang TC",os:["mac"]},{name:"Plantagenet Cherokee",value:"Plantagenet Cherokee",os:["mac"]},{name:"Playbill",value:"Playbill"},{name:"Poor Richard",value:"Poor Richard"},{name:"Poplar Std",value:"Poplar Std"},{name:"PosterBodoni BT",value:"PosterBodoni BT"},{name:"Pothana2000",value:"Pothana2000",os:["lin"]},{name:"Prestige Elite Std",value:"Prestige Elite Std"},{name:"Princetown Let",value:"Princetown Let"},{name:"Pristina",value:"Pristina"},{name:"Proxy 1",value:"Proxy 1",fileNames:["proxy_1.ttf"]},{name:"Proxy 2",value:"Proxy 2",fileNames:["proxy_2.ttf"]},{name:"Proxy 3",value:"Proxy 3",fileNames:["proxy_3.ttf"]},{name:"Proxy 4",value:"Proxy 4",fileNames:["proxy_4.ttf"]},{name:"Proxy 5",value:"Proxy 5",fileNames:["proxy_5.ttf"]},{name:"Proxy 6",value:"Proxy 6",fileNames:["proxy_6.ttf"]},{name:"Proxy 7",value:"Proxy 7",fileNames:["proxy_7.ttf"]},{name:"Proxy 8",value:"Proxy 8",fileNames:["proxy_8.ttf"]},{name:"Proxy 9",value:"Proxy 9",fileNames:["proxy_9.ttf"]},{name:"PTBarnum BT",value:"PTBarnum BT"},{name:"Purisa",value:"Purisa",fileNames:["purisa.ttf","purisa_bold.ttf","purisa_boldoblique.ttf","purisa_oblique.ttf"],os:["lin"]},{name:"Raanana",value:"Raanana",os:["mac"]},{name:"Raavi",value:"Raavi"},{name:"Rachana",value:"Rachana",os:["lin"]},{name:"Rage Italic",value:"Rage Italic"},{name:"Ravie",value:"Ravie"},{name:"Rekha",value:"Rekha",fileNames:["rekha.ttf"],os:["lin"]},{name:"Roboto",value:"Roboto",fileNames:["roboto_bold.ttf","roboto_bold_italic.ttf","roboto_italic.ttf","roboto_regular.ttf"],os:["win","lin","mac"]},{name:"Roboto Black",value:"Roboto Black",fileNames:["roboto_black.ttf","roboto_black_italic.ttf"],os:["win","lin","mac"]},{name:"Roboto Light",value:"Roboto Light",fileNames:["roboto_light.ttf","roboto_light_italic.ttf"],os:["win","lin","mac"]},{name:"Roboto Medium",value:"Roboto Medium",fileNames:["roboto_medium.ttf","roboto_medium_italic.ttf"],os:["win","lin","mac"]},{name:"Roboto Thin",value:"Roboto Thin",fileNames:["roboto_thin.ttf","roboto_thin_italic.ttf"],os:["win","lin","mac"]},{name:"Rockwell",value:"Rockwell",os:["mac"]},{name:"Rockwell Condensed",value:"Rockwell Condensed"},{name:"Rockwell Extra Bold",value:"Rockwell Extra Bold"},{name:"Rod",value:"Rod"},{name:"Roman",value:"Roman"},{name:"RomanC",value:"RomanC",fileNames:["romanc.ttf"]},{name:"RomanD",value:"RomanD",fileNames:["romand.ttf"]},{name:"RomanS",value:"RomanS",fileNames:["romans.ttf"]},{name:"RomanT",value:"RomanT",fileNames:["romant.ttf"]},{name:"Romantic",value:"Romantic"},{name:"Rosewood Std Regular",value:"Rosewood Std Regular"},{name:"Rubik",value:"Rubik",fileNames:["rubik_bold.ttf","rubik_bold_italic.ttf","rubik_italic.ttf","rubik_regular.ttf","rubik_extrabold.ttf","rubik_extrabold_italic.ttf","rubik_semibold.ttf","rubik_semibold_italic.ttf"],os:["lin"]},{name:"Rubik Black",value:"Rubik Black",fileNames:["rubik_black.ttf","rubik_black_italic.ttf"],os:["lin"]},{name:"Rubik Light",value:"Rubik Light",fileNames:["rubik_light.ttf","rubik_light_italic.ttf"],os:["lin"]},{name:"Rubik Medium",value:"Rubik Medium",fileNames:["rubik_medium.ttf","rubik_medium_italic.ttf"],os:["lin"]},{name:"Russo One",value:"Russo One",fileNames:["russo_one_regular.ttf"],os:["lin"]},{name:"STIXGeneral",value:"STIXGeneral",os:["mac"]},{name:"STIXIntegralsD",value:"STIXIntegralsD",os:["mac"]},{name:"STIXIntegralsSm",value:"STIXIntegralsSm",os:["mac"]},{name:"STIXIntegralsUp",value:"STIXIntegralsUp",os:["mac"]},{name:"STIXIntegralsUpD",value:"STIXIntegralsUpD",os:["mac"]},{name:"STIXIntegralsUpSm",value:"STIXIntegralsUpSm",os:["mac"]},{name:"STIXNoneUnicode",value:"STIXNoneUnicode",os:["mac"]},{name:"STIXSizeFiveSym",value:"STIXSizeFiveSym",os:["mac"]},{name:"STIXSizeFourSym",value:"STIXSizeFourSym",os:["mac"]},{name:"STIXSizeOneSym",value:"STIXSizeOneSym",os:["mac"]},{name:"STIXSizeThreeSym",value:"STIXSizeThreeSym",os:["mac"]},{name:"STIXSizeTwoSym",value:"STIXSizeTwoSym",os:["mac"]},{name:"STIXVariants",value:"STIXVariants",os:["mac"]},{name:"STSong",value:"STSong",os:["mac"]},{name:"Saab",value:"Saab",fileNames:["saab.otf"],os:["lin"]},{name:"Sahadeva",value:"Sahadeva",os:["lin"]},{name:"Sakkal Majalla",value:"Sakkal Majalla"},{name:"Samanata",value:"Samanata",os:["lin"]},{name:"Samyak Devanagari",value:"Samyak Devanagari",os:["lin"]},{name:"Samyak Gujarati",value:"Samyak Gujarati",os:["lin"]},{name:"Samyak Malayalam",value:"Samyak Malayalam",os:["lin"]},{name:"Samyak Tamil",value:"Samyak Tamil",os:["lin"]},{name:"Sana",value:"Sana",os:["mac"]},{name:"SansSerif",value:"SansSerif"},{name:"Santa Fe LET",value:"Santa Fe LET"},{name:"Sarai",value:"Sarai",os:["lin"]},{name:"Sathu",value:"Sathu",os:["mac"]},{name:"Savoye LET",value:"Savoye LET",os:["mac"]},{name:"Sawasdee",value:"Sawasdee"},{name:"Script",value:"Script"},{name:"Scriptina",value:"Scriptina",fileNames:["scriptina.ttf"]},{name:"Script MT Bold",value:"Script MT Bold"},{name:"ScriptC",value:"ScriptC"},{name:"ScriptS",value:"ScriptS"},{name:"Segoe Print",value:"Segoe Print",os:["win"]},{name:"Segoe Script",value:"Segoe Script",os:["win"]},{name:"Segoe UI",value:"Segoe UI",os:["win"]},{name:"Segoe UI Light",value:"Segoe UI Light",os:["win"]},{name:"Segoe UI Semibold",value:"Segoe UI Semibold",os:["win"]},{name:"Segoe UI Semilight",value:"Segoe UI Semilight",os:["win"]},{name:"Segoe UI Symbol",value:"Segoe UI Symbol",os:["win"]},{name:"Seravek",value:"Seravek",os:["mac"]},{name:"Serifa",value:"Serifa"},{name:"Serifa BT",value:"Serifa BT"},{name:"Serifa Th BT",value:"Serifa Th BT"},{name:"ShelleyVolante BT",value:"ShelleyVolante BT"},{name:"Shree Devanagari 714",value:"Shree Devanagari 714",os:["mac"]},{name:"Sherwood",value:"Sherwood"},{name:"Shonar Bangla",value:"Shonar Bangla"},{name:"Showcard Gothic",value:"Showcard Gothic"},{name:"Shruti",value:"Shruti"},{name:"SignPainter",value:"SignPainter",os:["mac"]},{name:"Silom",value:"Silom",os:["mac"]},{name:"SimHei",value:"SimHei"},{name:"SimSun",value:"SimSun",os:["win"]},{name:"SimSun-ExtB",value:"SimSun-ExtB",os:["win"]},{name:"Simplex",value:"Simplex"},{name:"Simplified Arabic",value:"Simplified Arabic"},{name:"Simplified Arabic Fixed",value:"Simplified Arabic Fixed"},{name:"Sinhala MN",value:"Sinhala MN",os:["mac"]},{name:"Sinhala Sangam MN",value:"Sinhala Sangam MN",os:["mac"]},{name:"Skia",value:"Skia",os:["mac"]},{name:"Small Fonts",value:"Small Fonts"},{name:"Snap ITC",value:"Snap ITC"},{name:"Snell Roundhand",value:"Snell Roundhand",os:["mac"]},{name:"Songti SC",value:"Songti SC",os:["mac"]},{name:"Songti TC",value:"Songti TC",os:["mac"]},{name:"Source Code Pro",value:"Source Code Pro",fileNames:["source_code_pro.ttf","source_code_pro_italic.ttf","source_code_pro_bold.ttf","source_code_pro_bold_italic.ttf"],os:["lin","mac"]},{name:"Source Code Pro Black",value:"Source Code Pro Black",fileNames:["source_code_pro_black.ttf","source_code_pro_black_italic.ttf"],os:["lin","mac"]},{name:"Source Code Pro Extra Light",value:"Source Code Pro Extra Light",fileNames:["source_code_pro_extra_light.ttf","source_code_pro_extra_light_italic.ttf"],os:["lin","mac"]},{name:"Source Code Pro Light",value:"Source Code Pro Light",fileNames:["source_code_pro_light.ttf","source_code_pro_light_italic.ttf"],os:["lin","mac"]},{name:"Source Code Pro Medium",value:"Source Code Pro Medium",fileNames:["source_code_pro_medium.ttf","source_code_pro_medium_italic.ttf"],os:["lin","mac"]},{name:"Source Code Pro Semibold",value:"Source Code Pro Semibold",fileNames:["source_code_pro_semibold.ttf","source_code_pro_semibold_italic.ttf"],os:["lin","mac"]},{name:"Source Serif Pro",value:"Source Serif Pro",fileNames:["source_serif_pro_bold.ttf","source_serif_pro_bold_italic.ttf","source_serif_pro_italic.ttf","source_serif_pro_regular.ttf"],os:["lin","mac"]},{name:"Source Serif Pro Black",value:"Source Serif Pro Black",fileNames:["source_serif_pro_black.ttf","source_serif_pro_black_italic.ttf"],os:["lin","mac"]},{name:"Source Serif Pro Extra Light",value:"Source Serif Pro Extra Light",fileNames:["source_serif_pro_extralight_italic.ttf","source_serif_pro_extralight.ttf"],os:["lin","mac"]},{name:"Source Serif Pro Light",value:"Source Serif Pro Light",fileNames:["source_serif_pro_light.ttf","source_serif_pro_light_italic.ttf"],os:["lin","mac"]},{name:"Source Serif Pro Semibold",value:"Source Serif Pro Semibold",fileNames:["source_serif_pro_semibold_italic.ttf","source_serif_pro_semibold.ttf"],os:["lin","mac"]},{name:"Source Sans Pro",value:"Source Sans Pro",fileNames:["source_sans_pro_bold.ttf","source_sans_pro_bold_italic.ttf","source_sans_pro_italic.ttf","source_sans_pro_regular.ttf"],os:["lin","mac"]},{name:"Source Sans Pro Black",value:"Source Sans Pro Black",fileNames:["source_sans_pro_black.ttf","source_sans_pro_black_italic.ttf"],os:["lin","mac"]},{name:"Source Sans Pro Extra Light",value:"Source Sans Pro Extra Light",fileNames:["source_sans_pro_extralight_italic.ttf","source_sans_pro_extralight.ttf"],os:["lin","mac"]},{name:"Source Sans Pro Light",value:"Source Sans Pro Light",fileNames:["source_sans_pro_light.ttf","source_sans_pro_light_italic.ttf"],os:["lin","mac"]},{name:"Source Sans Pro Semibold",value:"Source Sans Pro Semibold",fileNames:["source_sans_pro_semibold_italic.ttf","source_sans_pro_semibold.ttf"],os:["lin","mac"]},{name:"Souvenir Lt BT",value:"Souvenir Lt BT"},{name:"Staccato222 BT",value:"Staccato222 BT"},{name:"Steamer",value:"Steamer"},{name:"Stencil",value:"Stencil"},{name:"Square721 BT",value:"Square721 BT"},{name:"Stencil",value:"Stencil"},{name:"Stencil Std",value:"Stencil Std"},{name:"Stylus BT",value:"Stylus BT"},{name:"Subway",value:"Subway"},{name:"Sukhumvit Set",value:"Sukhumvit Set",os:["mac"]},{name:"Superclarendon",value:"Superclarendon",os:["mac"]},{name:"SuperFrench",value:"SuperFrench"},{name:"Suruma",value:"Suruma",fileNames:["suruma.ttf"],os:["lin"]},{name:"Swis721 BT",value:"Swis721 BT"},{name:"Swis721 BdCnOul BT",value:"Swis721 BdCnOul BT"},{name:"Swis721 BdOul BT",value:"Swis721 BdOul BT"},{name:"Swis721 Blk BT",value:"Swis721 Blk BT"},{name:"Swis721 BlkCn BT",value:"Swis721 BlkCn BT"},{name:"Swis721 BlkEx BT",value:"Swis721 BlkEx BT"},{name:"Swis721 BlkOul BT",value:"Swis721 BlkOul BT"},{name:"Swis721 Cn BT",value:"Swis721 Cn BT"},{name:"Swis721 Ex BT",value:"Swis721 Ex BT"},{name:"Swis721 Hv BT",value:"Swis721 Hv BT"},{name:"Swis721 Lt BT",value:"Swis721 Lt BT"},{name:"Swis721 LtCn BT",value:"Swis721 LtCn BT"},{name:"Swis721 LtEx BT",value:"Swis721 LtEx BT"},{name:"Swiss911 XCm BT",value:"Swiss911 XCm BT"},{name:"Syastro",value:"Syastro"},{name:"Sylfaen",value:"Sylfaen",os:["win"]},{name:"Symap",value:"Symap"},{name:"Symath",value:"Symath"},{name:"Symbol",value:"Symbol",os:["win","mac"]},{name:"Symeteo",value:"Symeteo"},{name:"Symusic",value:"Symusic",fileNames:["symusic.ttf"]},{name:"Synchro LET",value:"Synchro LET"},{name:"System",value:"System"},{name:"Tahoma",value:"Tahoma",os:["win","mac"]},{name:"Tamil MN",value:"Tamil MN",os:["mac"]},{name:"Tamil Sangam MN",value:"Tamil Sangam MN",os:["mac"]},{name:"TeamViewer8",value:"TeamViewer8"},{name:"Technic",value:"Technic"},{name:"Technical",value:"Technical"},{name:"TechnicBold",value:"TechnicBold"},{name:"TechnicLite",value:"TechnicLite"},{name:"Tekton Pro",value:"Tekton Pro"},{name:"Tekton Pro Cond",value:"Tekton Pro Cond"},{name:"Tekton Pro Ext",value:"Tekton Pro Ext"},{name:"Teletype",value:"Teletype",fileNames:["teletype_regular.ttf"]},{name:"Telugu MN",value:"Telugu MN",os:["mac"]},{name:"Telugu Sangam MN",value:"Telugu Sangam MN",os:["mac"]},{name:"Tempus Sans ITC",value:"Tempus Sans ITC"},{name:"Terminal",value:"Terminal"},{name:"Thonburi",value:"Thonburi",os:["mac"]},{name:"Tibetan Machine Uni",value:"Tibetan Machine Uni",fileNames:["tibetan_machine_uni.ttf"],os:["lin"]},{name:"Times New Roman",value:"Times New Roman",os:["win","mac"]},{name:"Times New Roman Baltic",value:"Times New Roman Baltic",os:["win","mac"]},{name:"Times New Roman CE",value:"Times New Roman CE",os:["win","mac"]},{name:"Times New Roman Cyr",value:"Times New Roman Cyr",os:["win","mac"]},{name:"Times New Roman Greek",value:"Times New Roman Greek",os:["win","mac"]},{name:"Times New Roman TUR",value:"Times New Roman TUR",os:["win","mac"]},{name:"Tlwg Mono",value:"Tlwg Mono",os:["lin"]},{name:"Tlwg Typewriter",value:"Tlwg Typewriter",fileNames:["tlwgtypewriter.ttf"],os:["lin"]},{name:"Tlwg Typist",value:"Tlwg Typist",os:["lin"]},{name:"Tlwg Typo",value:"Tlwg Typo",fileNames:["tlwg_typo.ttf"],os:["lin"]},{name:"Traditional Arabic",value:"Traditional Arabic"},{name:"Trajan",value:"Trajan"},{name:"Trajan Pro",value:"Trajan Pro"},{name:"Trattatello",value:"Trattatello",os:["mac"]},{name:"Trebuchet MS",value:"Trebuchet MS",os:["win","mac"]},{name:"Tubular",value:"Tubular",fileNames:["tubular_regular.ttf"]},{name:"Tunga",value:"Tunga"},{name:"Tw Cen MT",value:"Tw Cen MT"},{name:"Tw Cen MT Condensed",value:"Tw Cen MT Condensed"},{name:"Tw Cen MT Condensed Extra Bold",value:"Tw Cen MT Condensed Extra Bold"},{name:"Txt",value:"Txt"},{name:"TypoUpright BT",value:"TypoUpright BT"},{name:"URW Bookman L",value:"URW Gothic L",os:["lin"]},{name:"Ubuntu",value:"Ubuntu",os:["lin"]},{name:"Ubuntu",value:"Ubuntu",fileNames:["ubuntu_bold.ttf","ubuntu_bold_italic.ttf","ubuntu_italic.ttf","ubuntu_regular.ttf"],os:["lin"]},{name:"Umpush",value:"Umpush",os:["lin"]},{name:"Unicorn",value:"Unicorn",fileNames:["unicorn_regular.ttf"]},{name:"Univers",value:"Univers",fileNames:["univers.otf"]},{name:"Univers Condensed",value:"Univers Condensed"},{name:"UniversalMath1 BT",value:"UniversalMath1 BT"},{name:"Uroob",value:"Uroob",os:["lin"]},{name:"Utsaah",value:"Utsaah"},{name:"Vagabond",value:"Vagabond"},{name:"Vani",value:"Vani"},{name:"Vemana2000",value:"Vemana2000",os:["lin"]},{name:"Verdana",value:"Verdana",os:["win","mac"]},{name:"Vijaya",value:"Vijaya"},{name:"Viner Hand ITC",value:"Viner Hand ITC"},{name:"Vineta BT",value:"Vineta BT"},{name:"Vivaldi",value:"Vivaldi"},{name:"Vladimir Script",value:"Vladimir Script"},{name:"Vrinda",value:"Vrinda"},{name:"WP Arabic Sihafa",value:"WP Arabic Sihafa",fileNames:["wp_arabic_sihafa.ttf"]},{name:"WP ArabicScript Sihafa",value:"WP ArabicScript Sihafa",fileNames:["wp_arabicscript_sihafa.ttf"]},{name:"WP CyrillicA",value:"WP CyrillicA",fileNames:["wp_cyrillica.ttf"]},{name:"WP CyrillicB",value:"WP CyrillicB",fileNames:["wp_cyrillicb.ttf"]},{name:"WP Greek Century",value:"WP Greek Century",fileNames:["wp_greek_century.ttf"]},{name:"WP Greek Courier",value:"WP Greek Courier",fileNames:["wp_greek_courier.ttf"]},{name:"WP Greek Helve",value:"WP Greek Helve",fileNames:["wp_greek_helve.ttf"]},{name:"WP Hebrew David",value:"WP Hebrew David",fileNames:["wp_hebrew_david.ttf"]},{name:"WP MultinationalA Courier",value:"WP MultinationalA Courier",fileNames:["wp_multinationala_courier.ttf"]},{name:"WP MultinationalA Helve",value:"WP MultinationalA Helve",fileNames:["wp_multinationala_helve.ttf"]},{name:"WP MultinationalA Roman",value:"WP MultinationalA Roman",fileNames:["wp_multinationala_roman.ttf"]},{name:"WP MultinationalB Courier",value:"WP MultinationalB Courier",fileNames:["wp_multinationalb_courier.ttf"]},{name:"WP MultinationalB Helve",value:"WP MultinationalB Helve",fileNames:["wp_multinationalb_helve.ttf"]},{name:"WP MultinationalB Roman",value:"WP MultinationalB Roman",fileNames:["wp_multinationalb_roman.ttf"]},{name:"WST_Czec",value:"WST_Czec"},{name:"WST_Engl",value:"WST_Engl"},{name:"WST_Fren",value:"WST_Fren"},{name:"WST_Germ",value:"WST_Germ"},{name:"WST_Ital",value:"WST_Ital"},{name:"WST_Span",value:"WST_Span"},{name:"WST_Swed",value:"WST_Swed"},{name:"Waree",value:"Waree",fileNames:["waree.ttf"],os:["lin"]},{name:"Waseem",value:"Waseem",os:["mac"]},{name:"Webdings",value:"Webdings",os:["win","mac"]},{name:"Westminster",value:"Westminster"},{name:"Whitney",value:"Whitney"},{name:"Wide Latin",value:"Wide Latin"},{name:"Wingdings",value:"Wingdings",os:["win","mac"]},{name:"Wingdings 2",value:"Wingdings 2",os:["win","mac"]},{name:"Wingdings 3",value:"Wingdings 3",os:["win","mac"]},{name:"Yu Gothic",value:"Yu Gothic",os:["win"]},{name:"Yu Gothic UI",value:"Yu Gothic UI",os:["win"]},{name:"Zapf Dingbats",value:"Zapf Dingbats",os:["win"]},{name:"ZapfEllipt BT",value:"ZapfEllipt BT"},{name:"ZapfHumnst BT",value:"ZapfHumnst BT"},{name:"ZapfHumnst Dm BT",value:"ZapfHumnst Dm BT"},{name:"Zapfino",value:"Zapfino",os:["mac"]},{name:"Zurich BlkEx BT",value:"Zurich BlkEx BT"},{name:"Zurich Ex BT",value:"Zurich Ex BT"},{name:"ZWAdobeF",value:"ZWAdobeF"}];var He=n(358),We=n.n(He);function qe(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function Ve(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?qe(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var Je=He.promises.rm,Xe={lookup:1e4,connect:1e4,secureConnect:1e4,socket:1e4,send:1e4,response:1e4},Ze=function(e){return _e({fn:function(){return new Promise((function(r,n){var t=pe().stream(e.url,{timeout:{request:35e4}}),a=(0,He.createWriteStream)(e.destFile,{mode:438});a.on("error",(function(e){a.destroy(),n(e)})),t.on("response",(function(e){if(e.statusCode.toString().startsWith("2"))return t.pipe(a),void a.on("close",(function(){r("success")}));a.destroy(),n(e)})),t.on("error",(function(e){a.destroy(),n(e)}))}))},retryDelay:300})},Ye=function(e){return _e({fn:function(){return new Promise((function(r,n){var t=[],a=pe().stream(e.url,{timeout:{request:3e4}});a.on("response",(function(e){if(e.statusCode.toString().startsWith("2"))return a.on("data",(function(e){return t.push(e)})),void a.on("end",(function(){return r(Buffer.concat(t))}));n(e)})),a.on("error",(function(e){n(e)}))}))}})},$e=function(e){var r=e.url,n=e.destFile,t=e.progressEvent,a=void 0===t?null:t,o=e.progressEventName,i=void 0===o?"":o,s=e.retryDelay,u=void 0===s?0:s,c=e.retryLimit,l=void 0===c?5:c,f=e.orbitaVersion,p=void 0===f?"":f,m=e.progressState,d=void 0===m?{}:m;return _e({fn:function(){return Je(n).then((function(){return 0}),(function(){return 0})).then((function(e){return new Promise((function(t,o){var s=Number.MAX_SAFE_INTEGER;console.log("bytes=".concat(e,"-").concat(s));var u=pe().stream(r,{timeout:Xe,headers:{}});u.on("error",(function(e){o(e)}));var c={};e&&(c={start:e,mode:438,flags:"r+"});var l=(0,He.createWriteStream)(n,c);l.on("error",(function(e){var r=e instanceof Error?e.message:e;if("string"==typeof r&&r.includes("ENOSPC"))return o(r),void l.end();l.end(),o(e)})),u.on("response",(function(e){if(e.statusCode.toString().startsWith("2"))return console.log("received success code"),u.pipe(l),void l.on("close",(function(){console.log("stream closed"),t("success")}));l.end(),o(e)})),u.on("downloadProgress",(function(r){var n,t;if(a){r.total=e+r.total,r.transferred=e+r.transferred,r.percent=r.transferred/r.total;var o=(null===(n=d)||void 0===n||null===(t=n.percent)||void 0===t?void 0:t.toFixed(2))!==r.percent.toFixed(2);d=Ve(Ve({},d),r),o&&a.sender.send(i,{progressState:d,result:!1,orbitaVersion:p})}}))}))}))},retryDelay:u,onRetry:function(){a.sender.send(i,{progressState:d,result:!1,isRetrying:!0})},callLimit:l})};function Qe(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function er(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Qe(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function rr(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var nr="fonts",tr=["Google Hangouts","Chromium PDF Viewer","CryptoTokenExtension","Web Store"],ar="https://fonts.gologin.com/",or=(0,j.IT)(),ir=new WeakMap,sr=function(){function e(){return S()(this,e),rr(this,ir,{writable:!0,value:new me.CommonDataManager}),e.instance||(e.instance=this),e.instance}var n,t,a,i,u,l,f,p,m;return T()(e,[{key:"uploadProfileData",value:function(e){var r=e.browserId,n=e.passwords,t=void 0===n?[]:n,a=e.cookies,o=void 0===a?[]:a,i=e.extensionsIds,s=void 0===i?[]:i,u=e.bookmarks,c=void 0===u?{}:u,l=e.fileSize,f=e.cf,p=void 0!==f&&f,m=e.hk,d=void 0!==m&&m,h=e.apiTokenForClose,v=e.twoFaKeyForClose,g={passwords:t,cookies:o,extensionsIds:s,bookmarks:c,fileSize:l,cf:p,hk:d},b="".concat(B()(this,ir).apiBaseUrl,"/browser/features/profile/").concat(r,"/update_after_close"),w=B()(this,ir);return _e({fn:function(){return ve({url:b,method:"POST",body:g,timeoutDetailed:{socket:1e4},headers:{Authorization:"Bearer ".concat(h),"user-agent":w.userAgent,"x-two-factor-token":v||"","GoLogin-Meta-Header":w.metaHeader||""}})},retryDelay:300,stopRetryErrorPatterns:[404,403,429,500,401]})}},{key:"downloadFonts",value:(m=o()(s().mark((function e(r){var n,t,a,o,i,u=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],t=c().join(j.wk,nr),e.next=4,(0,A.mkdir)(t,{recursive:!0});case 4:return n&&((r=Ke.map((function(e){return e.fileNames})).filter(Boolean).flat()).push("LICENSE.txt"),r.push("OFL.txt")),e.next=7,(0,A.readdir)(t);case 7:if(a=e.sent,o=r.filter((function(e){return!a.includes(e)})),!(i=o.map((function(e){return Ze({url:ar+e,destFile:c().join(t,e)}).catch((function(e){console.log(e);var r=e instanceof Error?e.message:e;!n&&(0,be.zd)({message:r,transactionName:"download-fonts",tags:[["scenario","start-app"]]})}))}))).length){e.next=13;break}return e.next=13,Promise.all(i);case 13:console.log("fonts downloading completed");case 14:case"end":return e.stop()}}),e)}))),function(e){return m.apply(this,arguments)})},{key:"copyFontsToProfileFolder",value:(p=o()(s().mark((function e(r,n){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c().join(j.wk,nr),a=r.map((function(e){return _e({fn:function(){var r=e.replace(".otf",".ttf");return(0,A.copyFile)(c().join(t,e),c().join(n,nr,r))},retryDelay:100,limit:100})})),e.next=4,Promise.all(a);case 4:case"end":return e.stop()}}),e)}))),function(e,r){return p.apply(this,arguments)})},{key:"composeFonts",value:(f=o()(s().mark((function e(r){var n,t,a,o,i,u,l,f,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fontsList,t=void 0===n?[]:n,a=r.profilePath,o=r.differentOs,i=void 0!==o&&o,u=r.startProfileTransactionSentry,l=void 0===u?{}:u,t.length&&a){e.next=3;break}return e.abrupt("return");case 3:if(f=l.startChild({op:"download-fonts"}),p=Ke.filter((function(e){return!(!["Liberation Mono","Liberation Sans","Liberation Serif"].includes(e.value)||!i)||t.includes(e.value)})).reduce((function(e,r){return e.concat(r.fileNames||[])}),[]),!i||p.length){e.next=7;break}throw new Error("No fonts to download found. Please select at least 1 font in Fonts settings");case 7:return l.tags=er(er({},l.tags),{},{"fonts-count":p.length}),p.push("LICENSE.txt"),p.push("OFL.txt"),m=c().join(a,nr),e.next=13,(0,A.rm)(m,{recursive:!0}).catch((function(){return null}));case 13:return e.next=15,(0,A.mkdir)(m,{recursive:!0});case 15:return e.next=17,this.downloadFonts(p);case 17:return e.next=19,this.copyFontsToProfileFolder(p,a);case 19:if("linux"!==L.Yu){e.next=22;break}return e.next=22,this.copyFontsConfigFile(a);case 22:f.finish();case 23:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"copyFontsConfigFile",value:(l=o()(s().mark((function e(r){var n,t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return n=__dirname,e.next=5,(0,A.readFile)(c().resolve(n,"fonts_config"),"utf-8");case 5:return t=e.sent,a=t.replace(/\$\$GOLOGIN_FONTS\$\$/g,c().join(r,nr)),o=c().join(r,"Default"),e.next=10,(0,A.mkdir)(o,{recursive:!0});case 10:return e.next=12,(0,A.writeFile)(c().join(o,"fonts_config"),a,{mode:438});case 12:case"end":return e.stop()}}),e)}))),function(e){return l.apply(this,arguments)})},{key:"getProfileChromeExtensions",value:(u=o()(s().mark((function e(n){var t,a,o,i,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n){e.next=3;break}return e.abrupt("return",t);case 3:return e.next=5,(0,A.readFile)(n,"utf-8");case 5:if(a=e.sent,o=JSON.parse(a),i=(null==o?void 0:o.extensions)||{settings:{}},u=i.settings||{},(c=Object.entries(u)).length){e.next=12;break}return e.abrupt("return",t);case 12:return c.forEach((function(e){var n=r()(e,2),a=n[0],o=n[1].path,i=(void 0===o?"":o).replace(/\\|@/g,"/"),s=new RegExp("^".concat(a,"|chrome-extensions/\\w+")),u=i.match(s);if(u){var c=r()(u,1)[0].split("/").reverse(),l=r()(c,1)[0];t.includes(l)||t.push(l)}})),e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)}))),function(e){return u.apply(this,arguments)})},{key:"setExtPathsAndRemoveDeleted",value:(i=o()(s().mark((function e(n){var t,a,i,u,l,f,p,m,d,h,v=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.settings,a=void 0===t?{extensions:{}}:t,i=n.profileExtensionsCheckRes,u=void 0===i?[]:i,l=n.profileId,f=void 0===l?"":l,p=u.map((function(e){var n=e.split(c().sep).reverse(),t=r()(n,1)[0],a=(void 0===t?"":t).split("@"),o=r()(a,1)[0];return o?{path:e,originalId:o}:null})).filter(Boolean),m=a.extensions.settings||{},d=Object.entries(m),h=d.map(function(){var e=o()(s().mark((function e(n){var t,a,i,u,l,d,h,g,b,w,k,y,x,S,_,T,P,E,C,M,N,B,I;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r()(n,1),i=a[0],(u=r()(n,2))[0],l=u[1],h=(null===(t=(d=void 0===l?{manifest:{},path:""}:l).manifest)||void 0===t?void 0:t.name)||"",g=d.path||"",b="",!(["resources","passwords-ext","cookies-ext"].some((function(e){return g.includes(e)}))&&[j.nI,j.eZ].some((function(e){return g.includes(e)}))||tr.includes(h)&&[j.nI,j.eZ].some((function(e){return g.includes(e)})))){e.next=9;break}return delete m[i],e.abrupt("return");case 9:if(g="win32"===L.Yu?g.replace(/\//g,"\\"):g.replace(/\\/g,"/"),m[i].path=g,w=g.split(c().sep),(k=["chrome-extensions","user-extensions"].some((function(e){return g.includes(e)}))&&[j.nI,j.eZ].some((function(e){return g.includes(e)})))?(y=g.split(c().sep).reverse(),x=r()(y,1),S=x[0],_=S.split("@"),T=r()(_,1),b=T[0]):2===w.length&&(P=r()(w,1),b=P[0]),!k&&2!==w.length){e.next=19;break}if(p.find((function(e){var r;return null==e||null===(r=e.path)||void 0===r?void 0:r.includes(b)}))){e.next=19;break}return delete m[i],e.abrupt("return");case 19:if(E=b&&p.find((function(e){var r;return null==e||null===(r=e.path)||void 0===r?void 0:r.includes(b)}))){e.next=22;break}return e.abrupt("return");case 22:return C=i,e.next=25,v.recalculateId({localExtObj:E,extensionId:i,extensionsSettings:m,currentExtSettings:d});case 25:if(i=e.sent,C===i){e.next=43;break}return M=or.PROFILES_DIR+f,e.next=30,v.getExtensionSettingsFolder(M,C);case 30:if(!(N=e.sent)){e.next=43;break}return B=c().join(M,"Default",N,C),I=c().join(M,"Default",N,i),e.next=36,(0,A.rename)(B,I).catch(function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r instanceof Error,!(t=n?r.message:JSON.stringify(r)).includes("ENOENT")){e.next=4;break}return e.abrupt("return");case 4:if(!t.includes("ENOTEMPTY")){e.next=6;break}return e.abrupt("return","ENOTEMPTY");case 6:(0,be.zd)({message:t,transactionName:"extensions-cache-folder-rename-error",tags:[["scenario","run-profile"],["name","extensions-cache-folder-rename-error"]]});case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 36:if("ENOTEMPTY"!==e.sent){e.next=43;break}return console.log("trying to delete existing folder"),e.next=41,(0,A.rm)(I,{recursive:!0}).catch((function(){return null}));case 41:return e.next=43,(0,A.rename)(B,I).catch(function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r instanceof Error,!(t=n?r.message:JSON.stringify(r)).includes("ENOENT")){e.next=4;break}return e.abrupt("return");case 4:(0,be.zd)({message:t,transactionName:"extensions-cache-folder-rename-error",tags:[["scenario","run-profile"],["name","extensions-cache-folder-rename-error"]]});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 43:E.path.endsWith(".zip")&&(E.path=E.path.replace(".zip","")),m[i].path=E.path||"";case 45:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(h).then((function(){return m})));case 6:case"end":return e.stop()}}),e)}))),function(e){return i.apply(this,arguments)})},{key:"setOriginalExtPaths",value:(a=o()(s().mark((function e(){var n,t,a,i,u,l,f,p,m=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m.length>0&&void 0!==m[0]?m[0]:{path:""},a=m.length>1&&void 0!==m[1]?m[1]:""){e.next=4;break}return e.abrupt("return",null);case 4:return i=(null===(n=t.extensions)||void 0===n?void 0:n.settings)||{},u=Object.entries(i),e.next=8,(0,A.readdir)(a).catch((function(){return[]}));case 8:if((l=e.sent).length){e.next=11;break}return e.abrupt("return",null);case 11:return f=l.map(function(){var e=o()(s().mark((function e(n){var t,o,i,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c().join(a,n),e.next=3,(0,A.readdir)(t);case 3:if(o=e.sent,t.length){e.next=6;break}return e.abrupt("return",{});case 6:if(!o.includes("manifest.json")){e.next=8;break}return e.abrupt("return",{originalId:n,path:c().join(a,n)});case 8:return i=r()(o,1),u=i[0],e.abrupt("return",{originalId:n,path:c().join(a,n,u)});case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=14,Promise.all(f);case 14:return p=e.sent,u.forEach((function(e){var n=r()(e,1)[0],t=i[n].path;if(/chrome-extensions/.test(t)){var a=p.find((function(e){return e.originalId===n}));a&&(i[n].path=a.path||"")}})),e.abrupt("return",i);case 17:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"recalculateId",value:(t=o()(s().mark((function e(r){var n,t,a,o,i,u,l,f,p,m,d,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.localExtObj,a=r.extensionsSettings,o=r.currentExtSettings,i=r.extensionId,null===(n=r.currentExtSettings.manifest)||void 0===n||!n.key){e.next=4;break}return e.abrupt("return",i);case 4:return u=c().join(t.path,"manifest.json"),e.next=7,(0,A.readFile)(u,{encoding:"utf8"}).catch((function(){return""}));case 7:if(l=e.sent){e.next=10;break}return e.abrupt("return",i);case 10:e.prev=10,f=JSON.parse(l),e.next=17;break;case 14:return e.prev=14,e.t0=e.catch(10),e.abrupt("return",i);case 17:if(!f.key){e.next=19;break}return e.abrupt("return",i);case 19:return p="utf8","win32"===L.Yu&&(p="utf16le"),m=Buffer.from(t.path,p),d=ze().createHash("sha256").update(m).digest("hex"),h=d.split("").slice(0,32).map((function(e){return xe[e]})).join(""),i!==h&&(delete a[i],a[h]=o,i=h),e.abrupt("return",i);case 26:case"end":return e.stop()}}),e,null,[[10,14]])}))),function(e){return t.apply(this,arguments)})},{key:"getExtensionSettingsFolder",value:(n=o()(s().mark((function e(r,n){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c().join(r,"Default","Local Extension Settings",n),a=c().join(r,"Default","Sync Extension Settings",n),e.t0=!0,e.t1=e.t0,e.next=6,(0,A.access)(t).then((function(){return!0}),(function(){return!1}));case 6:if(e.t2=e.sent,e.t1!==e.t2){e.next=11;break}e.t3=23,e.next=21;break;case 11:return e.t4=e.t0,e.next=14,(0,A.access)(a).then((function(){return!0}),(function(){return!1}));case 14:if(e.t5=e.sent,e.t4!==e.t5){e.next=19;break}e.t6=24,e.next=20;break;case 19:e.t6=25;case 20:e.t3=e.t6;case 21:e.next=e.t3;break;case 23:return e.abrupt("return","Local Extension Settings");case 24:return e.abrupt("return","Sync Extension Settings");case 25:return e.abrupt("return","");case 26:case"end":return e.stop()}}),e)}))),function(e,r){return n.apply(this,arguments)})}]),e}();E()(sr,"instance",void 0);const ur=require("@babel/runtime/helpers/assertThisInitialized");var cr=n.n(ur),lr=n(370),fr=n.n(lr),pr=n(548),mr=n.n(pr),dr=n(761),hr=n.n(dr);const vr=require("events");var gr=n.n(vr);const br=require("zip-dir");var wr=n.n(br);const kr=require("decompress");var yr=n.n(kr);const xr=require("decompress-unzip");var Sr=n.n(xr),_r=function(){function e(){S()(this,e)}return T()(e,null,[{key:"extractExtension",value:function(e,r){if(!e||!r)throw new Error("Missing parameter");return(0,A.access)(e).then((function(){return _e({fn:function(){return yr()(e,r,{plugins:[Sr()()],filter:function(e){return!e.path.endsWith("/")}})}})}))}},{key:"deleteExtensionArchive",value:function(e){if(!e)throw new Error("Missing parameter");return(0,A.access)(e).then((function(){return(0,A.unlink)(e)}),(function(){return Promise.resolve()}))}}]),e}(),Tr=function(e){return _e({fn:function(){return ge({url:e,method:"HEAD",retryLimit:1})},retryDelay:300}).catch((function(e){var r=e instanceof Error?e.message:e;"string"==typeof r&&r.includes("404")||(0,be.zd)({message:r,transactionName:"update-extension-get-last-version",tags:[["scenario","update-extensions"],["name","update-extension-get-last-version"]]})}))},Pr=function(e){var n=e.split("/").reverse(),t=r()(n,1)[0],a=(void 0===t?"":t).split("."),o=r()(a,1)[0],i=(void 0===o?"":o).split("_");return i.shift(),i.join("_")},Er=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j.$c;return e.map((function(e){var t=e.split(c().sep).reverse(),a=r()(t,1)[0],o=(void 0===a?"":a).split("."),i=r()(o,1)[0];return _r.extractExtension(e,c().join(n,i)).then((function(){return _r.deleteExtensionArchive(e)}))}))},Cr={startChild:function(){return{finish:function(){},setStatus:function(){}}},setStatus:function(){},setTag:function(){},finish:function(){}};function Mr(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var Nr=83886080,Br=new WeakMap,Ir=new WeakMap,Or=new WeakMap,Ar=new WeakMap,jr=function(){function e(){S()(this,e),Mr(this,Br,{writable:!0,value:[]}),Mr(this,Ir,{writable:!0,value:new me.CommonDataManager}),Mr(this,Or,{writable:!0,value:[]}),Mr(this,Ar,{writable:!0,value:new(gr())})}var n,t,a,i;return T()(e,[{key:"existedUserExtensions",get:function(){return B()(this,Br)},set:function(e){e&&M()(this,Br,e)}},{key:"deleteUserExtIdFromInProgress",value:function(e){M()(this,Or,B()(this,Or).filter((function(r){return r!==e}))),B()(this,Or).length||B()(this,Ar).emit("unblocked")}},{key:"addCustomExtension",value:(i=o()(s().mark((function e(n){var t,a,o,i,u,l,f,p,m,d,h,v,g,b,w,k,x;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,we(n);case 3:if(t=e.sent,a=n.endsWith(".zip"),!(t>Nr)){e.next=7;break}return e.abrupt("return",{status:"error",body:{key:"notifications.error.extensionFileSize",maxFileSize:80}});case 7:if(o=this.generateExtensionId(),!a){e.next=13;break}return i=c().join(j.qW,o),e.next=12,_r.extractExtension(n,i);case 12:n=i;case 13:return e.next=15,(0,A.readdir)(n).catch((function(e){return console.log(e),["cantReadError"]}));case 15:if(1!==(u=e.sent.filter((function(e){return".DS_Store"!==e}))).length||u.includes("cantReadError")){e.next=26;break}return e.next=19,(0,A.stat)(n);case 19:if(!e.sent.isDirectory()){e.next=26;break}return l=u,f=r()(l,1),p=f[0],n=c().join(n,p),e.next=25,(0,A.readdir)(n).catch((function(){return["cantReadError"]}));case 25:u=e.sent;case 26:if(!u.includes("cantReadError")){e.next=28;break}throw new Error("notifications.error.extAccessFolderErr");case 28:if(u.includes("manifest.json")){e.next=31;break}throw a&&(0,A.rmdir)(n),new Error("notifications.error.missingExtManifestFile");case 31:if(a){e.next=35;break}return m=c().join(j.qW,o),e.next=35,ke(n,m).catch((function(){throw new Error("notifications.error.extCopingFolder")}));case 35:return e.next=37,this.getExtensionsNameAndImage([o],j.qW);case 37:if(e.t0=e.sent,e.t0){e.next=40;break}e.t0=[];case 40:if(d=e.t0,h=r()(d,1),v=h[0]){e.next=45;break}throw new Error("notifications.error.somethingWentWrongAgainLater");case 45:return g={extensionInfo:v},b=B()(this,Ir).apiBaseUrl,e.next=49,_e({fn:function(){return ve({url:"".concat(b,"/extensions/create_user_extension"),method:"POST",body:g,json:!1,timeout:3e4})},retryDelay:100});case 49:if(!e.sent){e.next=52;break}throw new Error("notifications.error.insertingExtToDBErr");case 52:return e.next=54,wr()(n).catch((function(){return null}));case 54:if(w=e.sent){e.next=57;break}throw new Error("notifications.error.somethingWentWrongAgainLater");case 57:return e.next=59,ve({url:"".concat(B()(this,Ir).apiBaseUrl,"/extensions/upload_url?extId=").concat(o),method:"GET",json:!1}).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.zd)({message:r,transactionName:"custom-extension-upload-url-error",tags:[["scenario","upload-custom-extensions"],["name","custom-extension-upload-url-error"]]}),"error"}));case 59:if("error"!==(k=e.sent)){e.next=62;break}return e.abrupt("return",{status:"error",message:"no url"});case 62:return e.next=64,_e({fn:function(){return ve({url:k,headers:{"Content-Type":"application/zip","Content-Length":Buffer.byteLength(w)},body:w,timeout:3e4,method:"PUT",isBuffer:!0,json:!1})}}).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.zd)({message:r,transactionName:"upload-custom-extension-to-aws",tags:[["scenario","upload-custom-extensions"],["name","upload-custom-extension-to-aws"]]}),{}}));case 64:if(!e.sent){e.next=67;break}throw new Error("notifications.error.uploadExtError");case 67:return M()(this,Br,[].concat(y()(B()(this,Br)),[v.extId])),e.abrupt("return",{status:"success",message:v});case 71:if(e.prev=71,e.t1=e.catch(0),"string"!=typeof(x=e.t1 instanceof Error?e.t1.message:e.t1)||"notifications.error.missingExtManifestFile"!==x){e.next=76;break}return e.abrupt("return",{status:"error",message:x});case 76:return(0,be.oj)({message:x,transactionName:"upload-custom-extensions-global",tags:[["scenario","upload-custom-extensions"]]}),e.abrupt("return",{status:"error",message:x});case 78:case"end":return e.stop()}}),e,this,[[0,71]])}))),function(e){return i.apply(this,arguments)})},{key:"checkLocalUserChromeExtensions",value:(a=o()(s().mark((function e(n){var t,a,i,u,l,f,p,m,d,h,v,g,b,w=this,k=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=k.length>1&&void 0!==k[1]?k[1]:"",a=k.length>2&&void 0!==k[2]&&k[2],n&&n.length){e.next=4;break}return e.abrupt("return",[]);case 4:if(a||!B()(this,Or).length){e.next=7;break}return e.next=7,new Promise((function(e){return B()(w,Ar).on("unblocked",e)}));case 7:return e.next=9,(0,A.readdir)(j.qW);case 9:if(i=e.sent,(u=n.filter((function(e){return!i.includes(e)}))).length){e.next=13;break}return e.abrupt("return",this.getExtStrToIncludeAsOrbitaParam(n,j.qW));case 13:return a&&B()(this,Or).push(n[0]),e.next=16,ve({url:"".concat(B()(this,Ir).apiBaseUrl,"/extensions/user_chrome_extensions_paths"),body:{existedUserChromeExtensions:B()(this,Br),profileId:t,userChromeExtensions:u},method:"POST"}).catch((function(){return[]}));case 16:if(l=e.sent,(f=l.filter((function(e){return n.some((function(r){return e.includes(r)}))}))).length){e.next=21;break}return a&&this.deleteUserExtIdFromInProgress(n[0]),e.abrupt("return",this.getExtStrToIncludeAsOrbitaParam(n,j.qW));case 21:return p=f.map(function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.split("?"),a=r()(t,1),o=a[0],i=o.split("/").reverse(),u=r()(i,1),l=u[0],f="".concat(c().join(j.qW,l),".zip"),e.next=5,Ze({url:n,destFile:f}).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.oj)({message:r,transactionName:"user-extensions-download-error"}),"error"}));case 5:if("error"!==e.sent){e.next=8;break}return e.abrupt("return","");case 8:return e.abrupt("return",f);case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=24,Promise.all(p).catch((function(){return[]}));case 24:if((m=e.sent).length){e.next=30;break}if(!a){e.next=29;break}return this.deleteUserExtIdFromInProgress(n[0]),e.abrupt("return",[]);case 29:return e.abrupt("return",this.getExtStrToIncludeAsOrbitaParam(n,j.qW));case 30:return d=Er(m,j.qW),e.next=33,Promise.all(d).catch((function(){return"error"}));case 33:return h=e.sent,a&&this.deleteUserExtIdFromInProgress(n[0]),"error"!==h&&(v=m.map((function(e){return e.replace(".zip","").split(c().sep).reverse()})),g=r()(v,1),b=g[0],M()(this,Br,[].concat(y()(B()(this,Br)),y()(b)))),e.abrupt("return",this.getExtStrToIncludeAsOrbitaParam(n,j.qW));case 37:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getExtensionsNameAndImage",value:(t=o()(s().mark((function e(n,t){var a,i,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[j.$c,j.qW].includes(t),e.next=3,(0,A.readdir)(t).catch((function(){return[]}));case 3:if(i=e.sent,(u=i.filter((function(e){return n.some((function(r){return!e.includes(".zip")&&e.includes(r)}))}))).length){e.next=7;break}return e.abrupt("return",[]);case 7:return l=n.map(function(){var e=o()(s().mark((function e(n){var o,i,l,f,p,m,d,h,v,g,b,w,k,x,S,_,T,P,E,C,M,N;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=u.find((function(e){return e.includes(n)})),i){e.next=3;break}return e.abrupt("return");case 3:if(l=[t,i],a){e.next=11;break}return e.next=7,(0,A.readdir)(c().join(t,i));case 7:f=e.sent,p=r()(f,1),m=p[0],l=[t,i,m];case 11:return d=c().join.apply(c(),y()(l).concat(["manifest.json"])),e.next=14,(0,A.readFile)(d,"utf8").catch((function(){return""}));case 14:if(h=e.sent){e.next=17;break}return e.abrupt("return");case 17:if(!(v=JSON.parse(h)).name.includes("__MSG")){e.next=28;break}return b=v.name||"",w=b.replace(/__/g,"").split("MSG_"),(k=r()(w,2))[0],x=k[1],S=c().join.apply(c(),y()(l).concat(["_locales",v.default_locale,"messages.json"])),e.next=24,(0,A.readFile)(S,"utf8").catch((function(e){return console.log(e),""}));case 24:_=e.sent;try{T=JSON.parse(_.trim()),g=T[x].message}catch(e){console.log("localeString: ",_,"fieldNameInLocale: ",x),P=e instanceof Error?e.message:e,(0,be.oj)({message:P,transactionName:"get-extension-metadata",tags:[["scenario","upload-custom-extensions"]]})}e.next=29;break;case 28:g=v.name;case 29:if(g){e.next=31;break}return e.abrupt("return");case 31:if(E=v.icons,C=null===(o=v.browser_action)||void 0===o?void 0:o.default_icon,E&&(C=E[128]),M="",!C){e.next=40;break}return N=c().join.apply(c(),y()(l).concat([C])),e.next=39,(0,A.readFile)(N,"base64").catch((function(){return""}));case 39:M=e.sent;case 40:return e.abrupt("return",{name:g,extId:n,iconBinary:M});case 41:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=10,Promise.all(l);case 10:return e.abrupt("return",e.sent.filter(Boolean));case 11:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"getExtStrToIncludeAsOrbitaParam",value:(n=o()(s().mark((function e(){var n,t,a,o,i,u=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>0&&void 0!==u[0]?u[0]:[],t=u.length>1&&void 0!==u[1]?u[1]:j.$c,Array.isArray(n)&&n.length){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,Promise.all([(0,A.readdir)(t).then((function(e){return e.map((function(e){return c().join(t,e)}))}))]);case 6:if(a=e.sent,(o=[].concat.apply([],a).filter(Boolean)).length){e.next=10;break}return e.abrupt("return",[]);case 10:return console.log("splitting formattedList: ",o),i=o.map((function(e){var n=e.split(c().sep).reverse(),t=r()(n,1)[0].split("@");return{originalId:r()(t,1)[0],path:e}})),e.abrupt("return",n.map((function(e){var r=i.find((function(r){return r.originalId===e}));return r?r.path:""})).filter(Boolean));case 13:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"generateExtensionId",value:function(){for(var e="",r=32,n="abcdefghijklmnopqrstuvwxyz",t=n.length;r--;)e+=n.charAt(Math.floor(Math.random()*t));return e}}]),e}(),Lr=function(e){if(80===e[0]&&75===e[1]&&3===e[2]&&4===e[3])return e;if(67!==e[0]&&114!==e[1]&&50!==e[2]&&52!==e[3])throw new Error("Invalid header: Does not start with Cr24");var r=3===e[4],n=2===e[4];if(!n&&!r||e[5]||e[6]||e[7])throw new Error("Unexpected crx format version number.");if(n){var t=16+Rr({byteA:e[8],byteB:e[9],byteC:e[10],byteD:e[11]})+Rr({byteA:e[12],byteB:e[13],byteC:e[14],byteD:e[15]});return e.slice(t,e.length)}var a=12+Rr({byteA:e[8],byteB:e[9],byteC:e[10],byteD:e[11]});return e.slice(a,e.length)},Rr=function(e){var r=0;return r+=e.byteA<<0,r+=e.byteB<<8,r+=e.byteC<<16,r+=e.byteD<<24>>>0};function Dr(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,t=hr()(e);if(r){var a=hr()(this).constructor;n=Reflect.construct(t,arguments,a)}else n=t.apply(this,arguments);return mr()(this,n)}}function Fr(e,r,n){Gr(e,r),r.set(e,n)}function Gr(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ur(e,r,n){if(!r.has(e))throw new TypeError("attempted to get private field on non-instance");return n}var zr=new me.CommonDataManager,Kr=new WeakMap,Hr=new WeakMap,Wr=new WeakMap,qr=new WeakMap,Vr=new WeakMap,Jr=new WeakMap,Xr=new WeakSet,Zr=function(e){fr()(l,e);var n,t,a,i,u=Dr(l);function l(){var e,r,n;return S()(this,l),e=u.call(this),Gr(r=cr()(e),n=Xr),n.add(r),Fr(cr()(e),Kr,{writable:!0,value:[]}),Fr(cr()(e),Hr,{writable:!0,value:!1}),Fr(cr()(e),Wr,{writable:!0,value:!1}),Fr(cr()(e),qr,{writable:!0,value:!0}),Fr(cr()(e),Vr,{writable:!0,value:[]}),Fr(cr()(e),Jr,{writable:!0,value:new(gr())}),l.instance||(l.instance=cr()(e)),mr()(e,l.instance)}return T()(l,[{key:"init",value:function(){var e=o()(s().mark((function e(){var r,n=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!B()(this,Hr)){e.next=2;break}return e.abrupt("return",Promise.resolve());case 2:return r=[(0,A.mkdir)(j.$c,{recursive:!0}).then((function(){return(0,A.readdir)(j.$c)})).then((function(e){return M()(n,Kr,e.filter((function(e){return!e.includes(".zip")})).map((function(e){return e.split("@")[0]}))),e.map((function(e){return e.includes(".zip")?(0,A.unlink)(c().join(j.$c,e)):Promise.resolve()}))})).then((function(e){return Promise.all(e)})).catch((function(e){return console.log("ExtensionsManager init error:",e)})),(0,A.mkdir)(j.qW,{recursive:!0}).then((function(){return(0,A.readdir)(j.qW)})).then((function(e){return n.existedUserExtensions=e.filter((function(e){return!e.includes(".zip")})),e.map((function(e){return e.includes(".zip")?(0,A.unlink)(c().join(j.qW,e)):Promise.resolve()}))})).then((function(e){return Promise.all(e)})).catch((function(){return null}))],e.abrupt("return",Promise.all(r).then((function(){M()(n,Hr,!0)})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isInited",get:function(){return B()(this,Hr)}},{key:"deleteProfileExtFolders",get:function(){return B()(this,Wr)}},{key:"existedChromeExtensionsList",get:function(){return B()(this,Kr)}},{key:"deleteExtIdFromExtensionsInProgress",value:function(e){M()(this,Vr,B()(this,Vr).filter((function(r){return r!==e}))),B()(this,Vr).length||B()(this,Jr).emit("unblocked")}},{key:"checkChromeExtensions",value:(i=o()(s().mark((function e(){var n,t,a,o,i,u,l,f=this,p=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=p.length>0&&void 0!==p[0]?p[0]:[],t=p.length>1&&void 0!==p[1]&&p[1],Array.isArray(n)&&n.length){e.next=4;break}return e.abrupt("return",[]);case 4:return e.next=6,(0,A.mkdir)(j.$c,{recursive:!0});case 6:if(t||!B()(this,Vr).length){e.next=9;break}return e.next=9,new Promise((function(e){return B()(f,Jr).on("unblocked",e)}));case 9:if(a=Ur(this,Xr,Yr).call(this,n),!t||a.length){e.next=12;break}return e.abrupt("return",[]);case 12:return t&&B()(this,Vr).push(n[0]),e.next=15,this.downloadChromeExtensions(a).catch((function(){return[]}));case 15:return o=e.sent,i=o.filter(Boolean),console.log("splitting downloadedExtensionIds: ",i),u=i.map((function(e){var n=e.split(c().sep).reverse(),t=r()(n,1)[0].split("@");return r()(t,1)[0]})),M()(this,Kr,[].concat(y()(B()(this,Kr)),y()(u))),l=Er(i),e.next=23,Promise.all(l).catch((function(){return null}));case 23:return t&&this.deleteExtIdFromExtensionsInProgress(n[0]),e.abrupt("return",this.getExtStrToIncludeAsOrbitaParam(n));case 25:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"downloadChromeExtensions",value:(a=o()(s().mark((function e(){var n,t,a=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>0&&void 0!==a[0]?a[0]:[],Array.isArray(n)&&n.length){e.next=3;break}return e.abrupt("return",[]);case 3:return console.log("splitting idsToDownload: ",n),t=n.map(function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,l,f,p,m,d,h,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.split("@"),a=r()(t,1),o=a[0],i=se.replace("{ext_id}",o),e.next=4,Tr(i);case 4:if(u=e.sent){e.next=7;break}return e.abrupt("return","");case 7:return l=u.req.path,f=Pr(l),e.next=11,Ye({url:i}).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.zd)({message:r,transactionName:"download-chrome-extension"}),"error"}));case 11:if(!((p=e.sent)instanceof String&&"error"===p)){e.next=14;break}return e.abrupt("return","");case 14:if(e.prev=14,!(p instanceof Buffer)){e.next=19;break}m=Lr(p),e.next=20;break;case 19:throw Error("error, no buffer");case 20:e.next=32;break;case 22:if(e.prev=22,e.t0=e.catch(14),"error, no buffer"!==(d=e.t0 instanceof Error?e.t0.message:"unknown")){e.next=27;break}return e.abrupt("return","");case 27:if("unknown"===d&&console.log(e.t0),!d.includes("Does not start with Cr24")){e.next=30;break}return e.abrupt("return","");case 30:return(0,be.oj)({message:d,transactionName:"decompress-google-chrome-extension",level:"warning",tags:[["scenario","download-extensions"]]}),e.abrupt("return","");case 32:return h=c().join(j.$c,o+"@"+f+".zip"),(v=We().createWriteStream(h,{mode:438})).write(m),v.close(),e.abrupt("return",new Promise((function(e){v.on("close",(function(){return e(h)})),v.on("error",(function(){return e("")}))})));case 37:case"end":return e.stop()}}),e,null,[[14,22]])})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(t));case 6:case"end":return e.stop()}}),e)}))),function(){return a.apply(this,arguments)})},{key:"updateExtensions",value:(t=o()(s().mark((function e(){var n,t,a,i,u,l,f,p=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.readdir)(j.$c).catch((function(){return[]}));case 2:if((n=e.sent).length){e.next=5;break}return e.abrupt("return");case 5:return t=[],a=n.map(function(){var e=o()(s().mark((function e(n){var a,o,i,u,l,f,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.includes("@")&&!n.includes(".zip")){e.next=2;break}return e.abrupt("return","");case 2:return a=n.split("@"),o=r()(a,2),i=o[0],u=o[1],l=se.replace("{ext_id}",i),e.next=6,Tr(l);case 6:if(f=e.sent){e.next=9;break}return e.abrupt("return","");case 9:if(p=f.req.path,m=Pr(p),f&&u!==m){e.next=13;break}return e.abrupt("return","");case 13:return t.push(c().join(j.$c,n)),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=9,Promise.all(a);case 9:return i=e.sent.filter(Boolean),e.next=12,this.downloadChromeExtensions(i);case 12:return u=e.sent.filter(Boolean),l=Er(u),e.next=16,Promise.all(l);case 16:return f=t.map((function(e){return(0,A.rmdir)(e,{recursive:!0,maxRetries:3}).catch((function(){}))})),e.next=19,Promise.all(f).then((function(){M()(p,qr,!1)}));case 19:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"insertExtensionsToDb",value:(n=o()(s().mark((function e(r){var n,t,a,o,i,u=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:j.$c,null!=r&&r.length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,ve({url:"".concat(zr.apiBaseUrl,"/extensions/check"),method:"POST",body:{extensionsIds:r}});case 5:if(t=e.sent,a=t.extensionsToAdd,(o=void 0===a?[]:a).length){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.getExtensionsNameAndImage(o,n);case 11:return i=e.sent,e.abrupt("return",ve({url:"".concat(zr.apiBaseUrl,"/extensions/create"),method:"POST",body:{extensionsInfo:i}}));case 13:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getExtensionsToInstall",value:function(e,n){if(!e)return[];var t=Object.entries(e),a=(null==t?void 0:t.map((function(e){var n=r()(e,2),t=(n[0],n[1].path.split(c().sep).reverse()),a=r()(t,1)[0].split("@");return r()(a,1)[0]})))||[];return n.reduce((function(e,n){var t=n.split(c().sep).reverse(),o=r()(t,1)[0].split("@"),i=r()(o,1)[0];return a.includes(i)||e.push(n),e}),[])}}]),l}(jr);function Yr(e){var n=[].concat(y()(B()(this,Kr)),y()(this.existedUserExtensions));return e.reduce((function(t,a){console.log("splitting extrensions name: ",e);var o=a.split("@"),i=r()(o,1)[0];return n.includes(i)||t.push(a),t}),[])}E()(Zr,"instance",void 0);const $r=require("moment");var Qr=n.n($r),en=function(){function e(){S()(this,e)}var n,t,a,i,u;return T()(e,[{key:"init",value:function(){var e=o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,A.mkdir)(j.Me,{recursive:!0}).catch((function(){return null})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"copyClosedProfileToCacheDirectory",value:(u=o()(s().mark((function e(r,n,t){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a="".concat(c().join(j.Me,n,t),".zip"),e.next=3,(0,A.rmdir)(c().join(j.Me,n),{recursive:!0}).catch((function(){return null}));case 3:return e.next=5,(0,A.mkdir)(c().join(j.Me,n),{recursive:!0});case 5:return e.next=7,(0,A.writeFile)(a,r,{mode:438});case 7:case"end":return e.stop()}}),e)}))),function(e,r,n){return u.apply(this,arguments)})},{key:"checkCachedStorageSize",value:function(){return we(j.Me)}},{key:"clearCachedStorage",value:(i=o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.readdir)(j.Me).catch((function(){return[]}));case 2:return r=e.sent,n=r.map(function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c().join(j.Me,r),e.next=3,(0,A.stat)(n);case 3:if(!e.sent.isDirectory()){e.next=6;break}return e.abrupt("return",(0,A.rmdir)(n,{recursive:!0}));case 6:return e.abrupt("return",(0,A.unlink)(n));case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(n));case 5:case"end":return e.stop()}}),e)}))),function(){return i.apply(this,arguments)})},{key:"clearProfileCache",value:(a=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c().join(j.Me,r),e.abrupt("return",(0,A.rmdir)(n,{recursive:!0}).catch((function(){return null})));case 2:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"getCachedProfile",value:(t=o()(s().mark((function e(n,t){var a,o,i,u,l,f,p,m,d,h,v,g,b,w,k,y=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.length>2&&void 0!==y[2]?y[2]:"",o=n.split("/"),(i=r()(o,2))[0],u=i[1],l=c().join(j.Me,t),e.next=5,(0,A.readdir)(l).catch((function(){return[]}));case 5:if(f=e.sent,p=r()(f,1),(m=p[0])&&null!=m&&m.endsWith(".zip")){e.next=10;break}return e.abrupt("return",{status:!1});case 10:if(d=m.split("."),h=r()(d,1),v=h[0],g=c().join(l,m),v!==u&&(!m||n&&!n.includes("zero"))){e.next=14;break}return e.abrupt("return",{status:!0,cachedArchivePath:g});case 14:return e.next=16,(0,A.stat)(g).catch((function(){return"error"}));case 16:if("error"!==(b=e.sent)){e.next=19;break}return e.abrupt("return",{status:!1});case 19:if(w=b.birthtime,k=Qr()(a).utc(),!Qr()(k).isAfter(w)){e.next=23;break}return e.abrupt("return",{status:!1});case 23:return e.abrupt("return",{status:!0,cachedArchivePath:g});case 24:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"renameCachedProfile",value:(n=o()(s().mark((function e(r,n,t){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c().join(j.Me,r,n+".zip"),o=c().join(j.Me,r,t+".zip"),e.abrupt("return",(0,A.rename)(a,o).catch((function(e){throw console.log(e),Error("renaming zip error")})));case 3:case"end":return e.stop()}}),e)}))),function(e,r,t){return n.apply(this,arguments)})}]),e}(),rn=n(81);const nn=require("open");var tn=n.n(nn);const an=require("tree-kill");var on=n.n(an);const sn=require("uuid"),un=require("sqlite"),cn=require("sqlite3");var ln=n.n(cn),fn=function(){return ze().pbkdf2Sync("a5379xgQjkW6ysbu","saltysalt",1,16,"sha1")},pn=function(e,r){var n=e.toString();if(!n.startsWith("v10")&&!n.startsWith("v11"))return n;var t=r||{},a=t.algorithm,o=void 0===a?"aes-128-cbc":a,i=t.key,s=void 0===i?fn():i,u=t.iv,c=void 0===u?Buffer.alloc(16," "):u,l=ze().createDecipheriv(o,s,c);return l.update(e.slice(3),"binary","utf8")+l.final("utf8")},mn=function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve({url:"http://localhost:".concat(global.appPort,"/cookies/").concat(r,"?isAvailable=true"),method:"GET"}).catch((function(){return{}}));case 2:return n=e.sent,e.abrupt("return",n.status||!1);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),dn=function(){var e=o()(s().mark((function e(r){var n,t,a=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(a.length>1&&void 0!==a[1])||a[1],t={filename:r,driver:ln().Database},e.next=4,(0,A.access)(r).then((function(){return console.log("".concat(r," cookies file exists"))})).catch((function(){return console.log("creating new cookies file"),(0,A.mkdir)(c().dirname(r),{recursive:!0}).then((function(){return Bn(r)})).catch((function(e){if(!e.message.includes("table cookies already exists"))throw e}))}));case 4:return n&&(t.mode=ln().OPEN_READONLY),e.abrupt("return",_e({fn:function(){return(0,un.open)(t)},retryDelay:500}));case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),hn=(0,j.IT)(),vn=function(){function e(){S()(this,e)}var n,t,a;return T()(e,null,[{key:"prepareCookies",value:(a=o()(s().mark((function e(r,n,t){var a,o,i,u,c,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.checkCookies,o=n.clearCookies,i=n.userCookies,!o){e.next=5;break}return e.abrupt("return",Mn(t));case 5:if(i||a){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,Pn(t);case 9:return u=e.sent,c=u.cookies,e.next=13,mn(r);case 13:if(l=e.sent,console.log("localServerAvailable:",l),console.log("cookies.length:",c.length),!(i||c.length<2)&&l){e.next=21;break}if(f=n.cookies||[],console.log("serverCookies.length:",f.length),!f.length){e.next=21;break}return e.abrupt("return",En({cookiesFromFile:c,serverCookies:f,profileId:r,cookiesFilePath:t}));case 21:case"end":return e.stop()}}),e)}))),function(e,r,n){return a.apply(this,arguments)})},{key:"copyCookiesFile",value:(t=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.includes(hn.COOKIES_FILE_NEW)?hn.PROFILES_DIR+n+hn.COOKIES_FILE:r,e.next=3,(0,A.copyFile)(r,t);case 3:case"end":return e.stop()}}),e)}))),function(e,r){return t.apply(this,arguments)})},{key:"getCookiesFileToRead",value:(n=o()(s().mark((function e(n){var t,a,i,u,c,l,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=hn.PROFILES_DIR+n,a=t+hn.COOKIES_FILE,i=t+hn.COOKIES_FILE_NEW,u=[a,i].map(function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.stat)(r).catch((function(){return{mtimeMs:0}}));case 2:return n=e.sent,e.abrupt("return",n.mtimeMs);case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=6,Promise.all(u);case 6:if(c=e.sent,l=r()(c,2),f=l[0],p=l[1],f||p){e.next=12;break}return e.abrupt("return","");case 12:return e.abrupt("return",f>p?a:i);case 13:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})}]),e}();function gn(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(!e)return;if("string"==typeof e)return bn(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bn(e,r)}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function bn(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var wn={"-1":"unspecified",0:"no_restriction",1:"lax",2:"strict"},kn=function(e,r,n){var t=e;return e.startsWith(".")&&(t=e.substring(1)),"http"+(r?"s":"")+"://"+t+n},yn=function(e){return 0===e?e:1e6*(e-new Date(Date.UTC(1601,0,1)).getTime()/1e3)},xn=function(e){var r=e.toString().length;if(0===e||r>18)return e;var n=e;return r<18&&(n=Number(n+"0".repeat(18-r))),(n/1e4+new Date(Date.UTC(1601,0,1)).getTime())/1e3},Sn=function(e){return function(r){var n=r.domain,t=r.name,a=r.path;return(e.domain&&e.domain.startsWith(".")?e.domain.substring(1):e.domain)===(n.startsWith(".")?n.substring(1):n)&&e.name===t&&e.path===a}},_n=function(e,r){return{unique:r.filter((function(r){return-1===e.findIndex(Sn(r))})),withNewValue:r.filter((function(r){var n=e.find(Sn(r));return n&&n.value!==r.value}))}},Tn=function(e){var r=Math.floor((new Date).getTime()/1e3),n=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=y()(e),t=[];if(r<=0)return t;for(;n.length;)t.push(n.splice(0,r));return t}(e,76);return n.map((function(e){var n=e.map((function(){return"(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)"})).join(", ");return["insert or replace into cookies (creation_utc, host_key, top_frame_site_key, name, value, encrypted_value, path, expires_utc, is_secure, is_httponly, last_access_utc, has_expires, is_persistent, priority, samesite, source_scheme, source_port, is_same_party, last_update_utc) values ".concat(n),e.flatMap((function(e){var n,t,a,o,i,s,u,c,l,f,p,m,d=e.creationDate||yn(r),h=e.session?0:yn(e.expirationDate),v=Buffer.concat([Buffer.from("v11"),Buffer.from((a=e.value,i=o||{},s=i.algorithm,u=void 0===s?"aes-128-cbc":s,c=i.key,l=void 0===c?fn():c,f=i.iv,p=void 0===f?Buffer.alloc(16," "):f,m=ze().createCipheriv(u,l,p),m.update(a,"utf8","binary")+m.final("binary")),"binary")]),g=Object.keys(wn).find((function(r){return wn[r]===(e.sameSite||"-1")})),b=e.name.startsWith("__Host-")||e.name.startsWith("__Secure-")?1:Number(null!==(n=e.secure)&&void 0!==n?n:1),w=1===b?2:1,k=1===b?443:80,y=void 0===e.session?Number(0!==h):Number(!e.session);return/^(\.)?mail.google.com$/.test(e.domain)&&"COMPASS"===e.name&&(h=0,y=0),[d,e.domain,"",e.name,"",v,e.path,h,b,Number(null!==(t=e.httpOnly)&&void 0!==t?t:1),0,0===h?0:1,y,1,g,w,k,0,0]}))]}))},Pn=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,dn(r);case 2:return n=e.sent,t=[],e.prev=4,e.next=7,n.all("select * from cookies");case 7:a=e.sent,o=gn(a);try{for(o.s();!(i=o.n()).done;)u=i.value,c=u.host_key,l=u.name,f=u.encrypted_value,p=u.path,m=u.is_secure,d=u.is_httponly,h=u.expires_utc,v=u.is_persistent,g=u.samesite,b=u.creation_utc,w=pn(f),t.push({url:kn(c,m,p),domain:c,name:l,value:w,path:p,sameSite:wn[g],secure:Boolean(m),httpOnly:Boolean(d),hostOnly:!c.startsWith("."),session:!v,expirationDate:xn(h),creationDate:xn(b)})}catch(e){o.e(e)}finally{o.f()}e.next=16;break;case 12:e.prev=12,e.t0=e.catch(4),k=e.t0 instanceof Error?e.t0.message:e.t0,(0,be.oj)({message:k,transactionName:"cookies-decrypt",level:"error",tags:[["scenario","start-profile"]]});case 16:return e.prev=16,e.next=19,_e({fn:function(){return n.close()},retryDelay:300}).catch((function(e){(0,be.oj)({message:e.message,transactionName:"close-cookie-db-error",level:"error",tags:[["scenario","start-profile"]]})}));case 19:return e.finish(16);case 20:return e.abrupt("return",{cookies:t});case 21:case"end":return e.stop()}}),e,null,[[4,12,16,20]])})));return function(r){return e.apply(this,arguments)}}(),En=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m,d,h,v,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.cookiesFromFile,a=void 0===t?[]:t,o=n.serverCookies,i=n.profileId,u=n.cookiesFilePath,c=_n(a,o),l=[].concat(y()(c.unique),y()(c.withNewValue)),f=Tn(l),e.next=6,dn(u,!1);case 6:return p=e.sent,e.next=9,Cn({chunkInsertValues:f,db:p,cookiesFilePath:u,profileId:i}).catch((function(e){return e.message}));case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0="";case 12:if(!(m=e.t0).includes("no such table: cookies")){e.next=18;break}return e.next=16,p.run(Nn);case 16:return e.next=18,Cn({chunkInsertValues:f,db:p,cookiesFilePath:u,profileId:i}).catch((function(e){console.log(e),m=e.message,(0,be.oj)({message:e.message,transactionName:"save-cookies-to-file",level:"error",tags:[["scenario","start-profile"]]})}));case 18:if(!m.includes("table cookies has no column named")){e.next=26;break}return console.log("insertCookiesResult",m),d=m.split(" ").reverse(),h=r()(d,1),v=h[0],g="ALTER TABLE cookies ADD ".concat(v," INTEGER"),e.next=24,p.run(g);case 24:return e.next=26,Cn({chunkInsertValues:f,db:p,cookiesFilePath:u,profileId:i}).catch((function(e){console.log(e),(0,be.oj)({message:e.message,transactionName:"save-cookies-to-file-after-add-column-error",level:"error",tags:[["scenario","start-profile"]]})}));case 26:return e.next=28,p.close().catch((function(e){(0,be.oj)({message:e.message,transactionName:"close-cookie-db-error",level:"error",tags:[["scenario","start-profile"]]})}));case 28:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Cn=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n.chunkInsertValues,a=n.db,o=n.cookiesFilePath,i=n.profileId,u=gn(t),e.prev=2,u.s();case 4:if((c=u.n()).done){e.next=15;break}return l=r()(c.value,2),f=l[0],p=l[1],e.next=8,a.prepare(f);case 8:return m=e.sent,e.next=11,m.run(p);case 11:return e.next=13,m.finalize();case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),u.e(e.t0);case 20:return e.prev=20,u.f(),e.finish(20);case 23:return e.next=25,vn.copyCookiesFile(o,i);case 25:case"end":return e.stop()}}),e,null,[[2,17,20,23]])})));return function(r){return e.apply(this,arguments)}}(),Mn=function(e){return _e({fn:function(){return(0,A.rm)(e,{recursive:!0,force:!0})},retryDelay:300})},Nn="CREATE TABLE cookies(\n        creation_utc INTEGER NOT NULL,\n        top_frame_site_key TEXT NOT NULL,\n        host_key TEXT NOT NULL,\n        name TEXT NOT NULL,\n        value TEXT NOT NULL,\n        encrypted_value BLOB NOT NULL,\n        path TEXT NOT NULL,\n        expires_utc INTEGER NOT NULL,\n        is_secure INTEGER NOT NULL,\n        is_httponly INTEGER NOT NULL,\n        last_access_utc INTEGER NOT NULL,\n        has_expires INTEGER NOT NULL,\n        is_persistent INTEGER NOT NULL,\n        priority INTEGER NOT NULL,\n        samesite INTEGER NOT NULL,\n        source_scheme INTEGER NOT NULL,\n        source_port INTEGER NOT NULL,\n        is_same_party INTEGER NOT NULL,\n        last_update_utc INTEGER NOT NULL\n      );",Bn=function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.writeFile)(r,"",{mode:438}).catch(console.log);case 2:return e.next=4,new Promise((function(e){new(ln().Database)(r,(function(r){if(r)throw r;e(null)}))}));case 4:return n={filename:r,driver:ln().Database},e.next=7,(0,un.open)(n);case 7:return t=e.sent,e.next=10,t.run(Nn);case 10:return e.next=12,t.close();case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();function In(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(!e)return;if("string"==typeof e)return On(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return On(e,r)}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function On(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var An=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,dn(r);case 3:return t=e.sent,e.prev=4,e.next=7,t.all("select * from logins");case 7:a=e.sent,o=In(a);try{for(o.s();!(i=o.n()).done;)u=i.value,c=u.origin_url,l=u.action_url,f=u.username_element,p=u.username_value,m=u.password_element,d=u.password_value,h=u.submit_element,n.push({origin_url:c,action_url:l,username_element:f,username_value:p,password_element:m,password_value:d,submit_element:h})}catch(e){o.e(e)}finally{o.f()}e.next=18;break;case 12:if(e.prev=12,e.t0=e.catch(4),"string"!=typeof(v=e.t0 instanceof Error?e.t0.message:e.t0)||!v.includes("no such table")){e.next=17;break}return e.abrupt("return",{passwords:n});case 17:(0,be.oj)({message:v,transactionName:"load-passwords-from-file",level:"error",tags:[["scenario","close-profile"]]});case 18:return e.prev=18,e.next=21,t.close();case 21:return e.finish(18);case 22:return e.abrupt("return",{passwords:n});case 23:case"end":return e.stop()}}),e,null,[[4,12,18,22]])})));return function(r){return e.apply(this,arguments)}}();const jn=require("yazl");var Ln=n.n(jn);const Rn=require("unzipper");var Dn=n.n(Rn);const Fn=require("yauzl");var Gn=n.n(Fn),Un=function(e,r){return new Promise((function(n,t){return Gn().open(e,{lazyEntries:!0,autoClose:!1},(function(e,a){if(e)t(e);else if(a){a.on("error",(function(e){console.log("zip File Error"),a.close(),t(e)})),a.readEntry();var i=[];a.on("entry",(function(e){a.readEntry(),/\/$/.test(e.fileName)||i.push(e)})),a.on("end",(function(){return console.log("zipFile entries ended"),Promise.all(i.map(function(){var e=o()(s().mark((function e(n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,A.mkdir)(c().join(r,c().dirname(n.fileName)),{recursive:!0}).then((function(){return new Promise((function(e,t){a.openReadStream(n,(function(a,o){if(a)t(a);else{o.on("error",(function(e){t(e)}));var i=(0,He.createWriteStream)(c().join(r,n.fileName),{mode:438});i.on("error",(function(e){t(e)})),i.on("close",e),o.pipe(i)}}))}))})));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())).then((function(){console.log("decompress resolved"),n(),a.close()})).catch((function(e){console.log("rejected"),t(e),a.close()}))}))}else t(new Error("no zipFile"))}))}))},zn=function(e,r){return new Promise((function(n,t){var a=(0,He.createReadStream)(e);a.on("error",t),a.pipe(Dn().Extract({path:r})).on("close",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.writeFile)(c().join(r,"First Run"),"",{mode:438}).catch((function(){return null}));case 2:console.log("Extraction complete."),n();case 4:case"end":return e.stop()}}),e)})))).on("error",(function(e){t(e)}))}))},Kn=[{name:"Cache",subs:[],isDirectory:!0},{name:"fonts_config",subs:[],isDirectory:!1},{name:"Service Worker",subs:[],isDirectory:!0},{name:"Code Cache",subs:[],isDirectory:!0},{name:"GPUCache",subs:[],isDirectory:!0}],Hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/";return Kn.reduce((function(r,n){var t=e+"Default"+e+n.name;return n.subs.length?n.subs.forEach((function(n){return r.push(t+e+n)})):r.push(t),r}),[])};function Wn(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(!e)return;if("string"==typeof e)return qn(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qn(e,r)}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,a=function(){};return{s:a,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function qn(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var Vn=function(){var e=o()(s().mark((function e(){var r,n,t,a,o,i,u=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:"",n=u.length>1?u[1]:void 0,e.next=4,(0,A.access)(r).then((function(){return!0}),(function(){return!1}));case 4:if(e.sent){e.next=7;break}throw new Error("Invalid profile folder path: "+r);case 7:return t=c().join(r,"Default"),a=new(Ln().ZipFile),o={isThrown:!1},e.next=12,Zn({folderPath:t,archive:a,relativePath:"Default",errorTrack:o});case 12:try{a.addFile(c().join(r,"First Run"),"/")}catch(e){a.addBuffer(Buffer.from(""),"First Run")}return i="".concat(c().join(j.Me,n,Dt),".zip"),e.next=16,(0,A.mkdir)(c().join(j.Me,n),{recursive:!0});case 16:return e.next=18,new Promise((function(e,r){var n=(0,He.createWriteStream)(i,{mode:438});n.on("error",(function(e){n.destroy(),r(e)})),n.on("close",(function(){e("")})),a.end(),a.outputStream.pipe(n)}));case 18:return e.abrupt("return",(0,A.readFile)(i));case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Un(e,r).catch((function(){return zn(e,r)}))},Xn=function(){var e=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c().join(j.Me,r,n+".zip"),e.abrupt("return",(0,A.readFile)(t).catch((function(e){throw console.log(e),Error("zip error")})));case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),Zn=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,l,f,p,m,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.folderPath,t=r.archive,a=r.relativePath,o=r.errorTrack,e.prev=1,i=Hn(),e.next=5,(0,A.readdir)(n);case 5:u=e.sent,l=Wn(u),e.prev=7,l.s();case 9:if((f=l.n()).done){e.next=27;break}return p=f.value,m=c().resolve(n,p),e.next=14,(0,A.stat)(m).catch((function(){return null}));case 14:if(d=e.sent){e.next=17;break}return e.abrupt("continue",25);case 17:if(!i.includes(a)){e.next=19;break}return e.abrupt("continue",25);case 19:if(!d.isDirectory()){e.next=24;break}return t.addEmptyDirectory(c().join(a,p)),e.next=23,Zn({folderPath:m,archive:t,relativePath:c().join(a,p),errorTrack:o});case 23:return e.abrupt("continue",25);case 24:t.addFile(m,"".concat(a,"/").concat(p));case 25:e.next=9;break;case 27:e.next=32;break;case 29:e.prev=29,e.t0=e.catch(7),l.e(e.t0);case 32:return e.prev=32,l.f(),e.finish(32);case 35:e.next=43;break;case 37:if(e.prev=37,e.t1=e.catch(1),!o.isThrown){e.next=41;break}return e.abrupt("return");case 41:throw o.isThrown=!0,e.t1;case 43:case"end":return e.stop()}}),e,null,[[1,37],[7,29,32,35]])})));return function(r){return e.apply(this,arguments)}}(),Yn=n(464),$n=n.n(Yn),Qn=$n().promisify(n(81).exec),et={},rt=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qn('wmic process get ProcessID, ParentProcessID | find "'.concat(n,'"')).catch((function(){return{stdout:""}}));case 2:if(t=e.sent,a=t.stdout){e.next=6;break}return e.abrupt("return","");case 6:if(console.log("target pid: ",n),console.log("childPID",a),o=a.toString().split("\n"),console.log("array of pid: ",o),i=o.filter((function(e){return e.split(" ")[0]===n.toString()})),u=r()(i,1),c=u[0]){e.next=13;break}return e.abrupt("return",n);case 13:return console.log("target array: ",c),l=c.split(" ").filter(Boolean),f=r()(l,2),f[0],p=f[1],e.abrupt("return",p);case 16:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),nt=function(){var e=o()(s().mark((function e(r){var t,a,o,i,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=et[r],"win32"!==j.iw){e.next=9;break}return a=n(924),e.next=5,rt(et[r]);case 5:if(t=e.sent){e.next=8;break}return e.abrupt("return");case 8:a.awaken(Number(t));case 9:if("linux"!==j.iw){e.next=18;break}return o=n(289),e.next=13,Qn("pgrep -P ".concat(t)).catch((function(){return{stdout:""}}));case 13:if(i=e.sent,u=i.stdout){e.next=17;break}return e.abrupt("return");case 17:o.awaken(Number(u));case 18:"darwin"===j.iw&&"x64"===O().arch()&&n(956).awaken(Number(t)),"darwin"===j.iw&&"arm64"===O().arch()&&n(486).awaken(Number(t));case 20:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),tt=new me.CommonDataManager,at=function(e){return _e({fn:function(){return ve({url:"".concat(tt.apiBaseUrl,"/browser/").concat(e,"?withCookies=true")})},retryDelay:300,stopRetryErrorPatterns:[403,401]})},ot=function(){var e=o()(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",ve({url:"".concat(tt.apiBaseUrl,"/proxy/set_proxy_statuses"),method:"POST",body:{proxies:r}}).catch((function(){})));case 1:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),it=function(e){var r=e.extensionId,n=void 0===r?"":r,t=e.workflowId,a=void 0===t?"":t;return"javascript:;window.open('chrome-extension://".concat(n,"/newtab.html#/workflows/").concat(a,"/run', '_self')")},st=function(e){var r=Buffer.from(e,"base64"),n=ze().createHash("sha256").update(r).digest(),t=y()(n.slice(0,16).toString("hex").toLowerCase());return(t=t.map((function(e){return isNaN(+e)?String.fromCharCode(e.charCodeAt(0)+10):"abcdefghijklmnop"[parseInt(e,16)]}))).join("")},ut=n(464).promisify(n(81).exec),ct=[{name:"Cookies Ext",extName:"cookies-ext",extZipName:"cookies-ext.zip",hashFile:"hashfile.txt",hashFileUrl:"https://extensions.gologin.com/hashfile.txt",versionFile:"latest-version.txt",versionFileUrl:"https://extensions.gologin.com/latest-version.txt",extArchiveUrl:"https://extensions.gologin.com/gologin-browser-ext.zip",tempFolder:"downloaded-cookies-ext",baseFolderName:"cookies-ext-base"},{name:"Passwords Ext",extName:"passwords-ext",extZipName:"passwords-ext.zip",hashFile:"passwords-hashfile.txt",hashFileUrl:"https://extensions.gologin.com/passwords-hashfile.txt",versionFile:"passwords-latest-version.txt",versionFileUrl:"https://extensions.gologin.com/passwords-latest-version.txt",extArchiveUrl:"https://extensions.gologin.com/gologin-browser-passwords-ext.zip",tempFolder:"downloaded-passwords-ext",baseFolderName:"passwords-ext-base"}],lt=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("IN checkArchiveSum ".concat(n.name)),t=process,a=t.platform,o=c().join(j.im,n.tempFolder),i=c().join(o,n.hashFile),u="cd ".concat(o," && sha256sum ").concat(n.extZipName),"win32"!==a){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:"darwin"===a&&(u="cd ".concat(o," && shasum -a 256 ").concat(n.extZipName));case 10:return e.abrupt("return",_e({fn:function(){return new Promise((function(e,r){var t=pe().stream(n.hashFileUrl,{timeout:{request:3e4}});t.on("response",(function(){var n=b().createWriteStream(i,{mode:438});t.pipe(n),n.on("close",(function(){e(null)})),n.on("error",(function(e){r(e)}))})),t.on("error",(function(e){r(e)}))}))}}).then((function(){return _e({fn:function(){return(0,A.access)(i).catch((function(){return Promise.reject(new Error("Ext Hash file has not been downloaded"))}))}})})).then((function(){return _e({fn:function(){return(0,A.readFile)(i,"utf8").then((function(e){var t=e;return ut(u).then((function(e){var a=(e.stdout||"").toString().trim(),o=t.split(" "),i=r()(o,1)[0],s=a.split(" "),u=r()(s,1)[0];return s.length>2&&(s.pop(),u=s.join("")),console.log("serverHash ".concat(n.name,":"),i),console.log("userHash ".concat(n.name,":"),u),u!==i?Promise.reject(new Error("Error in ".concat(n.name," sum matching"))):Promise.resolve()}))}))}})})));case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ft=function(e){return console.log("IN downloadNewExt ".concat(e.name)),Ze({url:e.extArchiveUrl,destFile:c().join(j.im,e.tempFolder,e.extZipName)}).then((function(){return console.log("download completed")})).then((function(){return function(e){return _e({fn:function(){return(0,A.access)(c().join(j.im,e.tempFolder,e.extZipName)).catch((function(r){var n=r instanceof Error?r.message:r;return(0,be.zd)({message:n,transactionName:"check-gologin-extensions",tags:[["scenario","download-extensions"],["name","check-gologin-extensions"]]}),Promise.reject(new Error("".concat(e.name," Archive has not been found. ").concat(n)))}))}})}(e)})).then((function(){return lt(e)})).then((function(){return function(e){return console.log("IN moveNewExt ".concat(e.name)),_e({fn:function(){return b().remove(c().join(j.im,e.extZipName)).then((function(){return b().remove(c().join(j.im,e.versionFile))})).then((function(){return zn(c().join(j.im,e.tempFolder,e.extZipName),c().join(j.im,e.baseFolderName))})).then((function(){return b().copy(c().join(j.im,e.tempFolder,e.versionFile),c().join(j.im,e.versionFile))}))}}).then((function(){return b().remove(c().join(j.im,e.tempFolder))})).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.zd)({message:r,transactionName:"extract-gologin-extension",tags:[["scenario","download-extensions"],["name","extract-gologin-extension"]]}),Promise.resolve()}))}(e)})).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,transactionName:"download-gologin-extensions",tags:[["name","download-gologin-extensions"]]})}))},pt=function(){var e=o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ct.map(function(){var e=o()(s().mark((function e(r){var n,t,a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.readFile)(c().join(j.im,r.versionFile)).catch((function(){return""}));case 2:return n=e.sent,t=n.toString(),e.next=6,s=r.versionFileUrl,ve({url:s,json:!1});case 6:return a=e.sent,o=a.toString().trim(),e.next=10,kt(r);case 10:if(i=e.sent,o&&(o!==t||!i)){e.next=13;break}return e.abrupt("return");case 13:return e.next=15,_e({fn:function(){return(0,A.mkdir)(c().join(j.im,r.tempFolder),{recursive:!0}).then((function(){return(0,A.writeFile)(c().join(j.im,r.tempFolder,r.versionFile),o,{mode:438})})).then((function(){return(0,A.mkdir)(c().join(j.im,r.extName),{recursive:!0})}))}}).catch((function(e){return Promise.reject(e)}));case 15:return e.next=17,ft(r);case 17:case"end":return e.stop()}var s}),e)})));return function(r){return e.apply(this,arguments)}}()),n=r.map((function(e){return e.catch((function(e){var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,transactionName:"check-gologin-extensions",tags:[["scenario","download-extensions"],["name","check-gologin-extensions"]]})}))})),e.next=4,Promise.allSettled(n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function mt(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function dt(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?mt(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var ht=n(358).promises,vt=ht.access,gt=ht.readFile,bt=ht.writeFile,wt=ht.readdir,kt=function(e){return vt(c().join(j.im,e.baseFolderName)).then((function(){return!0})).catch((function(){return!1}))},yt=function(){var e=o()(s().mark((function e(r,n){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c().join(j.im,r.baseFolderName),a=c().join(j.im,r.extName,n),e.next=4,ke(t,a);case 4:return!0,e.abrupt("return",St(r,{profileId:n},true));case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),xt=function(){var e=o()(s().mark((function e(r,n){var t,a,o,i,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.profileId,a=n.password,o=n.token,i=n.name,e.next=3,gt(c().join(j.im,r.extName,t,"uid.example.json"),"utf-8");case 3:return u=e.sent,(l=JSON.parse(u)).uid=t,l.port=global.appPort||36912,r.name.includes("Pass")&&(delete l.port,l.password=a,l.token=o,l.name=i),e.next=10,bt(c().join(j.im,r.extName,t,"uid.json"),JSON.stringify(l),{mode:438});case 10:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),St=function(){var e=o()(s().mark((function e(r,n){var t,a,o,i,u,l,f=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.length>2&&void 0!==f[2]&&f[2],a=n.profileId,o={extPath:""},e.next=5,vt(c().join(j.im,r.extName,a,"manifest.json")).then((function(){return!0})).catch((function(){return!1}));case 5:if(i=e.sent,!t&&i){e.next=8;break}return e.abrupt("return",t?i:o);case 8:return e.next=10,gt(c().join(j.im,r.versionFile),"utf-8").catch((function(){return""}));case 10:if(u=e.sent,console.log("".concat(r.name," extVersionFileContent:"),u),u){e.next=21;break}return console.log("ext version file not found!!"),e.next=16,wt(j.im).catch((function(e){return console.log(e)}));case 16:return l=e.sent,console.log(l),e.next=20,pt();case 20:return e.abrupt("return",o);case 21:return e.next=23,xt(r,n).then((function(){return!0})).catch((function(){return!1}));case 23:return e.abrupt("return",dt(dt({},o),{},{extPath:c().join(j.im,r.extName,a)}));case 24:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),_t=function(){var e=o()(s().mark((function e(r){var n,t,a,i,u,l,f,p,m=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=m.length>1&&void 0!==m[1]&&m[1],t=m.length>2&&void 0!==m[2]?m[2]:Cr,a=r.profileId,i=r.token,u=r.useCookiesExt,l=void 0===u||u,f=ct.map(function(){var e=o()(s().mark((function e(n){var o,u,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(("Passwords Ext"!==n.name||i)&&("Cookies Ext"!==n.name||l)){e.next=2;break}throw"do nothing";case 2:return e.next=4,St(n,r);case 4:if(o=e.sent,!(u=("boolean"==typeof o?{extPath:null}:o).extPath)){e.next=8;break}return e.abrupt("return",{extPath:u});case 8:if(kt(n)){e.next=18;break}return t.setTag("download-gologin-extensions",!0),console.log("ext version file not found!!"),e.next=14,wt(j.im).catch((function(e){return console.log(e)}));case 14:return f=e.sent,console.log(f),e.next=18,pt();case 18:return e.next=20,yt(n,a);case 20:if(e.sent){e.next=23;break}throw"".concat(n.name," extracting failed");case 23:return e.next=25,xt(n,r).then((function(){return!0})).catch((function(){return!1}));case 25:return e.abrupt("return",{extPath:c().join(j.im,n.extName,a)});case 26:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=6,Promise.allSettled(f);case 6:if(p=e.sent,!p.every((function(e){return"fulfilled"===e.status}))&&!n){e.next=10;break}return e.abrupt("return",p.map((function(e){return e.value})));case 10:return e.abrupt("return",_t(r,!0));case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Tt={NewTabPage:{PrevNavigationTime:"13302807227669318"},account_id_migration_state:2,account_tracker_service_last_update:"13302807097942551",ack_existing_ntp_extensions:!0,alternate_error_pages:{backup:!0},apps:{},autocomplete:{retention_policy_last_version:103},autofill:{orphan_rows_removed:!0},bookmark_bar:{show_on_all_tabs:!1},browser:{has_seen_welcome_page:!1,window_placement:{bottom:875,left:22,maximized:!1,right:1222,top:60,work_area_bottom:897,work_area_left:0,work_area_right:1512,work_area_top:38}},countryid_at_install:21077,custom_links:{initialized:!0,list:[{isMostVisited:!1,title:"Facebook",url:"https://www.facebook.com/"},{isMostVisited:!1,title:"Google Ads",url:"https://ads.google.com/"},{isMostVisited:!1,title:"TikTok",url:"https://www.tiktok.com/"},{isMostVisited:!1,title:"Amazon",url:"https://www.amazon.com/"},{isMostVisited:!1,title:"eBay",url:"https://ebay.com/"},{isMostVisited:!1,title:"YouTube",url:"https://www.youtube.com/"},{isMostVisited:!1,title:"Coinlist",url:"https://coinlist.co/"},{isMostVisited:!1,title:"Huobi",url:"https://www.huobi.com/"},{isMostVisited:!1,title:"bet365",url:"https://www.bet365.com/"},{isMostVisited:!1,title:"PayPal",url:"https://paypal.com/"}]},default_apps_install_state:3,domain_diversity:{last_reporting_timestamp:"13302807099119819"},extensions:{alerts:{initialized:!0},chrome_url_overrides:{},last_chrome_version:"103.0.5060.53",settings:{}},gaia_cookie:{changed_time:1658333661.108506,hash:"2jmj7l5rSw0yVb/vlWAYkK/YBwk=",last_list_accounts_data:'["gaia.l.a.r",[]]'},gcm:{product_category_for_subtypes:"com.orbita.macosx"},google:{services:{signin_scoped_device_id:"e8046704-b3cb-4533-8099-e2261bc1be67"}},intl:{selected_languages:"en-US,en"},invalidation:{per_sender_topics_to_handler:{1013309121859:{},8181035976:{}}},media:{device_id_salt:"",engagement:{schema_version:5}},media_router:{receiver_id_hash_token:""},ntp:{num_personal_suggestions:1},optimization_guide:{previously_registered_optimization_types:{ABOUT_THIS_SITE:!0,HISTORY_CLUSTERS:!0},store_file_paths_to_delete:{}},plugins:{plugins_list:[]},privacy_sandbox:{preferences_reconciled:!0},profile:{avatar_bubble_tutorial_shown:2,avatar_index:26,content_settings:{enable_quiet_permission_ui_enabling_method:{notifications:1},exceptions:{accessibility_events:{},app_banner:{},ar:{},auto_select_certificate:{},automatic_downloads:{},autoplay:{},background_sync:{},bluetooth_chooser_data:{},bluetooth_guard:{},bluetooth_scanning:{},camera_pan_tilt_zoom:{},client_hints:{},clipboard:{},cookies:{},durable_storage:{},fedcm_active_session:{},fedcm_share:{},file_system_access_chooser_data:{},file_system_last_picked_directory:{},file_system_read_guard:{},file_system_write_guard:{},formfill_metadata:{},geolocation:{},get_display_media_set_select_all_screens:{},hid_chooser_data:{},hid_guard:{},http_allowed:{},idle_detection:{},images:{},important_site_info:{},insecure_private_network:{},installed_web_app_metadata:{},intent_picker_auto_display:{},javascript:{},javascript_jit:{},legacy_cookie_access:{},local_fonts:{},media_engagement:{},media_stream_camera:{},media_stream_mic:{},midi_sysex:{},mixed_script:{},nfc_devices:{},notifications:{},password_protection:{},payment_handler:{},permission_autoblocking_data:{},permission_autorevocation_data:{},popups:{},ppapi_broker:{},protocol_handler:{},safe_browsing_url_check_data:{},sensors:{},serial_chooser_data:{},serial_guard:{},site_engagement:{},sound:{},ssl_cert_decisions:{},storage_access:{},subresource_filter:{},subresource_filter_data:{},usb_chooser_data:{},usb_guard:{},vr:{},webid_api:{},window_placement:{}},pref_version:1},created_by_version:"103.0.5060.53",creation_time:"13302807096310804",exit_type:"Normal",last_engagement_time:"13302807261018135",last_time_password_store_metrics_reported:1658333657.573382,managed_user_id:"",name:"Person 1",password_account_storage_settings:{}},safebrowsing:{event_timestamps:{},metrics_last_log_time:"13302807096"},signin:{allowed:!1},sync:{requested:!1},translate_site_blacklist:[],translate_site_blacklist_with_time:{},unified_consent:{migration_state:10},web_apps:{system_web_app_failure_count:0,system_web_app_last_attempted_language:"en-US",system_web_app_last_attempted_update:"103.0.5060.53",system_web_app_last_installed_language:"en-US",system_web_app_last_update:"103.0.5060.53"},webauthn:{touchid:{metadata_secret:"FAs08eDqvux1A4NYorVc4ZHDwnhqyLknX9ef3JS4DLg="}}},Pt=new Zr,Et=new me.CommonDataManager,Ct=new sr,Mt=function(){function e(){return S()(this,e),E()(this,"paths",{}),E()(this,"apiUrl",""),e.instance||(e.instance=this),e.instance}var n,t,a,i,u;return T()(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.paths=e,this.apiUrl=r}},{key:"prepareProfileToLaunch",value:(u=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k,x,S,_,T,P,E,C,M,N,B,I,O,A,j,L,R,D,F,G,U,z,K,H,W,q,V,J,X,Z,Y,$,Q,ee,re,ne,te,ae,oe,ie,se,ce,le,fe,pe,me,de,he,ge,we,ke,ye,xe,Se,_e,Te,Pe,Ee,Ce,Me,Ne,Be,Ie,Oe,Ae,je,Le,Re,De,Fe,Ge,Ue,ze,Ke,He,We,qe,Ve,Je,Xe,Ze,Ye,$e,Qe,er,rr,nr,tr,ar,or,ir,sr,ur,cr,lr,fr,pr,mr,dr,hr,vr,gr,br,wr,kr,yr,xr,Sr,_r,Tr,Pr,Er,Cr,Mr,Nr,Br,Ir,Or,Ar,jr,Lr,Rr,Dr,Fr,Gr,Ur,zr,Kr,Hr,Wr,qr,Vr,Jr,Xr,Zr,Yr,$r,Qr,en,rn,nn,tn,an,on,sn,un,cn,ln,fn,pn,mn,dn,hn,vn,gn;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.profileFingerprint,a=n.profileId,n.iconBase64,o=n.automation,i=Et.accessToken,u=t.name,c=void 0===u?"":u,l=t.devicePixelRatio,f=t.owner,p=t.profile,m=void 0===p?"":p,d=t.s3Path,h=void 0===d?"":d,v=t.s3Date,g=void 0===v?"":v,b=t.s3SignedUrl,w=void 0===b?"":b,k=t.debugMode,x=void 0!==k&&k,S=t.fonts,_=t.os,T=t.isM1,P=void 0!==T&&T,E=t.navigator,C=void 0===E?{}:E,M=t.checkCookies,N=void 0===M||M,B=t.clientRects,I=void 0===B?{mode:"noise",noise:0}:B,O=t.chromeExtensions,A=void 0===O?[]:O,j=t.userChromeExtensions,L=void 0===j?[]:j,R=t.cookies,D=void 0===R?{clearCookies:!1,userCookies:!1}:R,F=t.startUrl,G=void 0===F?"":F,U=t.useCookiesExt,z=void 0===U||U,K=t.vaultToken,H=void 0===K?"":K,W=t.bookmarks,q=t.isAutoGenerated,V=void 0!==q&&q,J=t.autoLang,X=void 0!==J&&J,Z=t.isBookmarksSynced,!G.includes("iphey.com/{compare_profile}")){e.next=8;break}return e.next=6,s=this.apiUrl,ve({url:"".concat(s,"/browser/features/profile-params-token"),method:"GET",timeout:3e4,retryLimit:5}).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.oj)({message:r,transactionName:"get-profile-params-token-error",level:"warning",tags:[["scenario","run-profile"]]}),{}}));case 6:Y=e.sent,t.startUrl=t.startUrl.replace("iphey.com/{compare_profile}","iphey.com/fingerprint_params?token=".concat(null==Y?void 0:Y.token,"&profile_id=").concat(a));case 8:return $=C.platform,Q=void 0===$?"win32":$,ee=C.resolution,re=void 0===ee?"1920x1080":ee,ne=C.userAgent,te=C.doNotTrack,ae=void 0!==te&&te,oe=C.language,ie=void 0===oe?"en-US,en;q=0.9":oe,se=C.hardwareConcurrency,ce=void 0===se?2:se,le=C.deviceMemory,fe=void 0===le?2:le,pe=C.maxTouchPoints,me=void 0===pe?0:pe,console.log("resolution",re),de=re.split("x"),he=r()(de,2),ge=he[0],we=he[1],ke=t.canvas,ye=ke.mode,xe=ke.noise,Se=t.proxy,_e=void 0===Se?{}:Se,Te=t.proxyEnabled,Pe=void 0!==Te&&Te,Ee=_e.username,Ce=void 0===Ee?"":Ee,Me=_e.password,Ne=void 0===Me?"":Me,Be=_e.mode,Ie=void 0===Be?"none":Be,Oe=_e.autoProxyRegion,Ae=void 0===Oe?"us":Oe,je=_e.torProxyRegion,Le=void 0===je?"us":je,Re=t.autoProxyServer,De=void 0===Re?"":Re,Fe=t.autoProxyUsername,Ge=void 0===Fe?"":Fe,Ue=t.autoProxyPassword,ze=void 0===Ue?"":Ue,Ke=t.webRTC,We=(He=void 0===Ke?{}:Ke).mode,qe=He.localIpMasking,Ve=He.fillBasedOnIp,"alerted"===We&&(We="public"),Je=t.webGL,Ze=(Xe=void 0===Je?{}:Je).mode,Ye=void 0===Ze?"noise":Ze,$e=Xe.noise,Qe=Xe.getClientRectsNoise,er=void 0===Qe?0:Qe,rr=I.noise||er,nr=t.webGLMetadata,tr=void 0===nr?{}:nr,ar=t.webglParams,or=void 0===ar?{}:ar,ir=tr.vendor,sr=void 0===ir?"":ir,ur=tr.renderer,cr=void 0===ur?"":ur,lr=tr.mode,fr=void 0===lr?"mask":lr,pr=t.mediaDevices,dr=(mr=void 0===pr?{}:pr).enableMasking,hr=void 0===dr||dr,vr=mr.uid,gr=mr.audioInputs,br=void 0===gr?1:gr,wr=mr.videoInputs,kr=void 0===wr?1:wr,yr=mr.audioOutputs,xr=void 0===yr?1:yr,Sr=t.plugins,Tr=(_r=void 0===Sr?{}:Sr).enableVulnerable,Pr=void 0===Tr||Tr,Er=_r.enableFlash,Cr=void 0===Er||Er,Mr=t.storage,Br=(Nr=void 0===Mr?{}:Mr).local,Ir=void 0===Br||Br,Or=Nr.bookmarks,Ar=void 0===Or||Or,jr=Nr.history,Lr=void 0===jr||jr,Rr=Nr.passwords,Dr=void 0===Rr||Rr,Fr=Nr.extensions,Gr=void 0===Fr||Fr,Ur=Nr.session,zr=void 0===Ur||Ur,Kr=Nr.indexedDb,Hr=void 0===Kr||Kr,Wr=t.timezone,qr=Wr.timezone,Vr=Wr.fillBasedOnIp,Jr=void 0!==Vr&&Vr,Xr=t.audioContext,Yr=(Zr=void 0===Xr?{}:Xr).mode,$r=void 0===Yr?"off":Yr,Qr=Zr.noise,en=ie.split(";"),rn=r()(en,1),nn=rn[0],tn=nn.split(","),an=r()(tn,1),on=an[0],sn=nn,ie.split(",").forEach((function(e,n){if(n){var t=e.split(";"),a=r()(t,1)[0];sn+=",".concat(a)}else sn=e})),un=t.geolocation,cn=void 0===un?{}:un,ln=t.dns||"",fn=t.createdInOs,null!=o&&o.workflowId&&null!=o&&o.extensionId?(dn=it({extensionId:o.extensionId,workflowId:o.workflowId}),console.info("automationStartUrl:",dn),pn=dn,mn=[dn]):(pn=this.getFirstStartupUrl(t.startUrl)||"",mn=(t.startUrl||"").split(",").map((function(e){return e.trim()}))),hn=Math.ceil(l||3.5),vn=l,hn===l&&(vn+=1e-8),gn=null!=o&&o.workflowId?y()(new Set([].concat(y()(A),[ue]))):A,e.abrupt("return",{profileId:a,s3SignedUrl:w,s3Path:h,s3Date:g,vaultToken:H,useCookiesExt:z,accessToken:i,proxy:_e,profile:m,owner:f,os:_,autoLang:X,proxyEnabled:Pe,autoProxyRegion:Ae,torProxyRegion:Le,autoProxyServer:De,autoProxyUsername:Ge,autoProxyPassword:ze,webRtc:He,region:"US",timezoneValue:qr,browserLang:on,fillProxyByIp:Jr,debugMode:x,session:zr,createdInOs:fn,checkCookies:N,isAutoGenerated:V,bookmarks:W,isBookmarksSynced:Z,bookmarksSettings:{editing_enabled:Ar},history:{saving_disabled:!Lr},credentials_enable_service:Dr,extensionsEnabled:Gr,localStorageEnabled:Ir,indexedDbEnabled:Hr,fonts:S,chromeExtensions:gn,userChromeExtensions:L,cookies:D,gologin:{profile_id:a,name:c,is_m1:P,geoLocation:cn,navigator:{platform:Q,max_touch_points:me},dns:ln,proxy:{username:"none"!==Ie?Ce:"",password:"none"!==Ie?Ne:""},screenHeight:parseInt(we,10),screenWidth:parseInt(ge,10),userAgent:ne,webRtc:{mode:We,local_ip_masking:qe,fill_based_on_ip:Ve},webGl:{vendor:sr,renderer:cr,mode:"mask"===fr},webgl:{metadata:{vendor:sr,renderer:cr,mode:"mask"===fr}},mobile:{enable:"android"===_,width:parseInt(ge,10),height:parseInt(we,10),device_scale_factor:vn},webglParams:or,webgl_noice_enable:"noise"===Ye,webglNoiceEnable:"noise"===Ye,webgl_noise_enable:"noise"===Ye,webgl_noise_value:$e,webglNoiseValue:$e,getClientRectsNoice:rr,get_client_rects_noise:rr,client_rects_noise_enable:"noise"===I.mode,mediaDevices:{enable:hr,uid:vr,audioInputs:br,audioOutputs:xr,videoInputs:kr},doNotTrack:ae,plugins:{all_enable:Pr,flash_enable:Cr},storage:{enable:Ir},audioContext:{enable:"off"!==$r,noiseValue:Qr},languages:sn,langHeader:ie,canvasMode:ye,canvasNoise:xe,hardwareConcurrency:ce,deviceMemory:1024*fe,startupUrl:pn,startup_urls:mn}});case 49:case"end":return e.stop()}var s}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"updatingBrowserSettings",value:(i=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileData,t=r.publicUserIp,a=r.profileExtensionsCheckRes,o=void 0===a?[]:a,i=r.args,u=n.profileId,c=j.xL.replace("{profileId}",u)+"Preferences",console.log("path to preferences: ",c),e.next=6,(0,A.readFile)(c,"utf-8").catch((function(){return console.log("no pref file"),JSON.stringify(Tt)}));case 6:l=e.sent,delete n.gologin.webRtc.localIps,n.webRtc.fillBasedOnIp?n.gologin.webRtc.public_ip="":n.gologin.webRtc.public_ip=n.webRtc.publicIp||t,e.prev=9,f=JSON.parse(l),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(9),console.log(l),e.t0;case 17:return f.gologin=n.gologin,f.gologin.unpinable_extension_names=["passwords-ext"],f.bookmarks=n.bookmarksSettings,f.history=n.history,f.credentials_enable_service=n.credentials_enable_service,e.next=24,Ct.setExtPathsAndRemoveDeleted({settings:f,profileExtensionsCheckRes:o,profileId:u});case 24:return p=e.sent,m=Pt.getExtensionsToInstall(p,o),(d=o.find((function(e){return e.includes(ue)})))&&(m.push(d),m=y()(new Set(m))),console.log("extensionsToInstall:",m),h=i.findIndex((function(e){return e.includes("--load-extension")}))||0,m.length&&h>0&&(i[h]=i[h].slice(0,-1)+","+m.join(",")+'"'),p&&((v=f.extensions||{}).settings=p,f.extensions=v),e.next=34,(0,A.writeFile)(c,JSON.stringify(f),{mode:438});case 34:console.log("Preferences has been successfully updated");case 35:case"end":return e.stop()}}),e,null,[[9,13]])}))),function(e){return i.apply(this,arguments)})},{key:"prepareCookies",value:(a=o()(s().mark((function e(r,n){var t,a,o=this,i=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(i.length>2&&void 0!==i[2]?i[2]:Cr).startChild({op:"prepare-cookies"})||{finish:function(){return null}},a=this.paths.PROFILES_DIR+r+this.paths.COOKIES_FILE,e.next=5,(0,A.access)(a).catch((function(){a=o.paths.PROFILES_DIR+r+o.paths.COOKIES_FILE_NEW}));case 5:return console.log("startProf cookiesFilePath:",a),e.abrupt("return",vn.prepareCookies(r,n,a).finally((function(){return t.finish()})));case 7:case"end":return e.stop()}}),e,this)}))),function(e,r){return a.apply(this,arguments)})},{key:"prepareGologinExts",value:(t=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.name,t=r.profileId,a=r.owner,o=r.useCookiesExt,i=r.vaultToken,u=r.startProfileTransactionSentry,c=u.startChild({op:"prepare-gologin-extensions"}),f={name:n,profileId:t,password:a,token:l=i,useCookiesExt:o},e.abrupt("return",_t(f,!1,u).then((function(e){return{profileGologinExtensionPath:e.map((function(e){return(null==e?void 0:e.extPath)||""})).join(","),passwordsTemporaryToken:l}})).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"creating-profile-extensions-error",tags:[["scenario","run-profile"],["profileId",t]]})})).finally((function(){return c.finish()})));case 5:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"checkTempFiles",value:(n=o()(s().mark((function e(r,n){var t,a,o,i=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.startChild({op:"check-temp-files"}),console.log("Removing stuck files"),a=["".concat(this.paths.ROUTE_SLASH,"SingletonLock"),"".concat(this.paths.ROUTE_SLASH,"RunningChromeVersion"),"".concat(this.paths.ROUTE_SLASH,"SingletonCookie"),"".concat(this.paths.ROUTE_SLASH,"SingletonSocket")],o=a.map((function(e){return(0,A.unlink)(i.paths.PROFILES_DIR+r+e).catch((function(){return Promise.resolve()}))})),e.abrupt("return",Promise.all(o).catch((function(e){var n=e instanceof Error?e.message:e;throw(0,be.oj)({message:n,transactionName:"check-temp-files",level:"warning",tags:[["scenario","run-profile"],["profileId",r]]}),e})).finally((function(){return t.finish()})));case 5:case"end":return e.stop()}}),e,this)}))),function(e,r){return n.apply(this,arguments)})},{key:"removeUselessFolders",value:function(e,r){var n=this,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Cr;console.log("Removing useless folders");var a=t.startChild({op:"remove-useless-folders"}),i=Hn(this.paths.ROUTE_SLASH);Pt.deleteProfileExtFolders&&i.push("".concat(this.paths.ROUTE_SLASH,"Default").concat(this.paths.ROUTE_SLASH,"Extensions"));var u=i.map(function(){var r=o()(s().mark((function r(t){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",ye(n.paths.PROFILES_DIR+e+t).catch((function(){})));case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());if("android"===r){var c=ye(this.paths.PROFILES_DIR+e+"".concat(this.paths.ROUTE_SLASH,"Default").concat(this.paths.ROUTE_SLASH,"Sessions")).catch((function(){}));u.push(c)}return Promise.all(u).catch((function(r){var n=r instanceof Error?r.message:r;(0,be.oj)({message:n,transactionName:"remove-useless-folder",level:"warning",tags:[["scenario","run-profile"],["profileId",e]]})})).finally((function(){return a.finish()}))}},{key:"getFirstStartupUrl",value:function(e){if(!e)return"";var n=e.split(",");return r()(n,1)[0].trim()}}]),e}();function Nt(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function Bt(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Nt(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}E()(Mt,"instance",void 0);var It=(0,j.IT)(),Ot=new sr,At=new Zr,jt=new me.CommonDataManager,Lt=new Mt,Rt=new en,Dt="prepared_to_upload",Ft=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,d,h,v,g,b,w,k,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileId,t=r.currentMs,a=r.localStorageEnabled,o=r.indexedDbEnabled,i=r.debugMode,u=void 0!==i&&i,c=r.channel,l=r.os,f=r.ProfileStatusManagerInst,p=r.ProfileStatusManagerInstances,d=r.automation,h=r.apiTokenForClose,v=r.twoFaKeyForClose,g=m.startTransaction({name:"stop-profile"})||Cr,Eo.push(n),e.next=5,Wt({profileId:n,currentMs:t,debugMode:u,localStorageEnabled:a,indexedDbEnabled:o,stopProfileTransactionSentry:g});case 5:return e.next=7,Promise.all([Ht({profileId:n,localStorageEnabled:a,indexedDbEnabled:o,stopProfileTransactionSentry:g}),Lt.removeUselessFolders(n,l)]).catch((function(){return null}));case 7:return e.next=9,Ut({profileId:n,channel:c,ProfileStatusManagerInst:f,automation:d,apiTokenForClose:h,twoFaKeyForClose:v}).catch((function(e){var r=e instanceof Error?e.message:e;return g.setStatus("aborted"),g.finish(),Se(Eo,n),{s3SignedUrl:{url:r}}}));case 9:if(b=e.sent,w=b.s3SignedUrl,k=void 0===w?{url:""}:w,y=b.profileArchiveBuffer,"error"!==k.url){e.next=15;break}throw new Error("The profile has been deleted");case 15:if("error-429"!==k.url){e.next=17;break}throw new Error("Too many requests");case 17:if(y){e.next=23;break}throw console.log("error, no buffer"),Se(Eo,n),g.setStatus("aborted"),g.finish(),new Error("profile archive is not found");case 23:return e.next=25,Kt({profileId:n,s3SignedUrl:k,profileArchiveBuffer:y,ProfileStatusManagerInst:f,ProfileStatusManagerInstances:p,stopProfileTransactionSentry:g,apiTokenForClose:h,twoFaKeyForClose:v});case 25:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Gt=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k,y,x,S,_,T,P,E,C,M,N,B;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.profileId,a=n.channel,o=n.pathToExtensions,i=n.pathToPreferences,u=n.pathToBookmarks,c=n.ProfileStatusManagerInst,l=n.stopProfileTransactionSentry,f=n.automation,p=n.apiTokenForClose,m=n.twoFaKeyForClose,d=l.startChild({op:"zipping-profile"}),h=l.startChild({op:"upload-cookies"}),v=l.startChild({op:"upload-passwords"}),g=l.startChild({op:"updating-extensions"}),b=[Vt(t,d),Jt(t,h).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"get-cookies-file-error",tags:[["scenario","close-profile"],["profileId",t]]}),h.setStatus("aborted"),h.finish();return{cookies:[{domain:"error"}]}})),Xt(t,v),Zt(i,g,t),Yt(u,t)],e.next=8,Promise.allSettled(b);case 8:if(w=e.sent,k=w.map((function(e){return"fulfilled"!==e.status?(console.log(e.reason),{value:""}):e})),y=r()(k,5),x=y[0].value,S=y[1].value,_=void 0===S?{cookies:[]}:S,T=y[2].value,P=y[3].value,E=y[4].value,C=P,(null==f?void 0:f.workflowId)&&!(null!=f&&f.isAutomationExtensionSavedInDb)&&(C=C.filter((function(e){return e!==ue}))),x){e.next=21;break}throw l.finish(),Se(Eo,t),ve({method:"POST",url:"".concat(jt.apiBaseUrl,"/analytics/add_action_analytics"),body:{action:"synced unsuccessfully"}}).catch((function(){return null})),c.addStatus({status:"error",statusMessage:{errorType:"archiving",errorMessage:"notifications.error.archivingProfileError",prefix:"resync"}}),c.removeStatus({status:"archiving"}),Error("archiving profile error");case 21:console.log("upload cookies.length:",_.cookies.length),_.cookies.length||console.log("Got empty cookies. profile ".concat(t));try{a.sender.send("update-extensions-on-close",{extensionsIds:C,profileId:t})}catch(e){console.log(e)}return M=l.startChild({op:"caching-profile-before-upload"}),e.next=27,Rt.copyClosedProfileToCacheDirectory(x,t,Dt).catch((function(e){var r="cache-profile-after-close";(0,be.zd)({message:e.message,transactionName:r,tags:[["scenario","close-profile"],["profileId",t],["name",r]]})})).finally((function(){return M.finish()}));case 27:return N=Buffer.byteLength(x),e.next=30,$t({profileId:t,passwords:T,cookies:_,extensionsIds:C,bookmarks:E,fileSize:N,pathToExtensions:o,stopProfileTransactionSentry:l,apiTokenForClose:p,twoFaKeyForClose:m});case 30:return B=e.sent,e.abrupt("return",{s3:B,buffer:x});case 32:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Ut=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,d,h,v,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.profileId,t=r.channel,a=r.onlyUpload,o=void 0!==a&&a,i=r.ProfileStatusManagerInst,u=r.automation,c=r.apiTokenForClose,l=r.twoFaKeyForClose,(f=m.startTransaction({name:"stop-profile"})||Cr).tags=Bt(Bt({},f.tags),{},{profileId:n}),p="".concat(j.xL.replace("{profileId}",n),"Preferences"),d="".concat(j.xL.replace("{profileId}",n),"Extensions"),h="".concat(j.xL.replace("{profileId}",n),"Bookmarks"),v={url:"",isCf:!1},g=null,!o){e.next=14;break}return e.next=11,Xn(n,Dt).catch((function(e){return console.log(e),null}));case 11:g=e.sent,e.next=16;break;case 14:return e.next=16,Gt({profileId:n,channel:t,pathToPreferences:p,pathToExtensions:d,pathToBookmarks:h,ProfileStatusManagerInst:i,stopProfileTransactionSentry:f,automation:u,apiTokenForClose:c,twoFaKeyForClose:l}).then((function(e){var r=e.s3,n=void 0===r?{url:"",isCf:!1}:r,t=e.buffer;v.url=n.url,v.isCf=n.isCf||!1,g=t}));case 16:return e.abrupt("return",{s3SignedUrl:v,profileArchiveBuffer:g,stopProfileTransactionSentry:f});case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),zt=function(){var e=o()(s().mark((function e(n){var t,a,i,u,c,l,f,p,m,d,h,v,g,b,w,k,y,x,S,_,T,P;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.fileBuff,a=n.profileId,i=n.hk,u=void 0!==i&&i,c=n.preloadedS3SignedUrl,l=void 0===c?{url:"",isCf:!1}:c,f=n.stopProfileTransactionSentry,p=n.apiTokenForClose,m=n.twoFaKeyForClose,console.log("***********************************"),console.log("Getting signed URL for S3 for ".concat(u?"Hong Kong":"Frankfurt")),d=f.startChild({op:"upload-profile"}),h=l,v=Buffer.byteLength(t),f.setTag("file-size-MB",v/1e3/1e3),null!=l&&l.url){e.next=12;break}return g="".concat(jt.apiBaseUrl,"/browser/").concat(a,"/storage-signature?fileSize=").concat(v,"&cf=true&hk=").concat(u?"true":""),e.next=11,_e({fn:function(){return ve({url:g,method:"GET",timeoutDetailed:{socket:1e4},retryLimit:1,headers:{Authorization:"Bearer ".concat(p),"user-agent":jt.userAgent,"x-two-factor-token":m||"","GoLogin-Meta-Header":jt.metaHeader||""}})},retryDelay:300,stopRetryErrorPatterns:[404,403,429,500,401]}).catch((function(e){var r,n,t;console.log(null===(r=e.response)||void 0===r?void 0:r.body);var o=e instanceof Error?e.message:e;if(null!==(n=e.response)&&void 0!==n&&null!==(t=n.body)&&void 0!==t&&t.includes("Profile has been deleted already"))throw new Error("profile deleted");if(e.message.includes("429"))throw new Error("too many requests");throw(0,be.zd)({message:o,transactionName:"get-s3-url-for-aws-upload",tags:[["scenario","close-profile"],["profileId",a],["name","get-s3-url-for-aws-upload"]]}),d.setStatus("aborted"),f.setStatus("aborted"),d.finish(),f.finish(),new Error("no url")}));case 11:h=e.sent;case 12:return b=h.url.split("?"),w=r()(b,1),k=w[0],y=k.split("/").reverse(),x=r()(y,1),S=x[0],e.prev=14,console.log("Uploading profile by signed URL to S3"),_={"Content-Type":"application/zip","Content-Length":v},h.isCf&&(_["x-amz-acl"]="bucket-owner-full-control"),e.next=20,_e({fn:function(){return ve({url:h.url,headers:_,body:t,timeout:5e5,method:"PUT",isBuffer:!0,retryLimit:1})},retryDelay:300,limit:1}).catch(function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw console.log(null===(n=r.response)||void 0===n?void 0:n.body),t=r instanceof Error?r.message:r,(0,be.zd)({message:t,transactionName:"upload-profile-to-aws-".concat(u?"hong-kong":"frankfurt"),tags:[["scenario","close-profile"],["profileId",a],["name","upload-profile-to-aws-".concat(u?"hong-kong":"frankfurt")]]}),r;case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}());case 20:return e.next=22,_e({fn:function(){return ge({url:k,method:"HEAD",headers:{},retryLimit:1})},retryDelay:700,stopRetryErrorPatterns:[401]}).catch((function(e){if(e.message.includes("404"))throw new Error("profile deleted");throw(0,be.zd)({message:e.message,transactionName:"check-upload-success-head-request",tags:[["scenario","close-profile"],["profileId",a],["name","check-upload-success-head-request"]]}),new Error("head-request-error")}));case 22:if(T=e.sent,f.tags=Bt(Bt({},f.tags),{},{"zip-size-MB":v/1048576}),(P=+(null==T?void 0:T.headers["content-length"]))===v){e.next=28;break}throw(0,be.oj)({message:"Check upload success error. got: ".concat(P,", need: ").concat(v,", is hk: ").concat(u),transactionName:"check-upload-success",tags:[["scenario","close-profile"],["profileId",a]]}),new Error("Uploaded file is incorrect. ".concat(u?"":" Retry with China."," File size: ").concat(P,", Upload size:  ").concat(v));case 28:console.log("Profile has been uploaded to S3 successfully"),e.next=44;break;case 31:if(e.prev=31,e.t0=e.catch(14),e.t0 instanceof Error&&console.log(e.t0.message),!(e.t0 instanceof Error&&"profile deleted"===e.t0.message)){e.next=36;break}throw new Error("do not send to sentry");case 36:if(!u){e.next=43;break}throw d.setStatus("aborted"),d.finish(),f.setStatus("aborted"),f.finish(),ve({method:"POST",url:"".concat(jt.apiBaseUrl,"/analytics/add_action_analytics"),body:{action:"synced unsuccessfully",profile:a}}).catch((function(){return null})),new Error("do not send to sentry");case 43:return e.abrupt("return",zt({fileBuff:t,profileId:a,hk:!0,stopProfileTransactionSentry:f,apiTokenForClose:p,twoFaKeyForClose:m}));case 44:if(ve({method:"POST",url:"".concat(jt.apiBaseUrl,"/analytics/add_action_analytics"),body:{action:"synced successfully",actionInfo:"".concat(v),profile:a}}).catch((function(){return null})),d.finish(),u){e.next=48;break}return e.abrupt("return",S);case 48:return e.next=50,_e({fn:function(){return ve({url:"".concat(jt.apiBaseUrl,"/browser/").concat(a,"/copy-profile"),method:"PUT",body:{uid:S}})},retryDelay:300,stopRetryErrorPatterns:[403,401]}).catch((function(e){console.log("uid: ",S),console.log("message: ",e);var r=e instanceof Error?e.message:e;["404","403"].some((function(e){return r.includes(e)}))||(0,be.zd)({message:r,transactionName:"copy-profile-from-hk-to-europe",tags:[["scenario","close-profile"],["profileId",a],["name","copy-profile-from-hk-to-europe"]]})}));case 50:return e.abrupt("return",S);case 51:case"end":return e.stop()}}),e,null,[[14,31]])})));return function(r){return e.apply(this,arguments)}}(),Kt=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v,g,b;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileId,t=r.s3SignedUrl,a=r.profileArchiveBuffer,o=r.ProfileStatusManagerInst,i=r.ProfileStatusManagerInstances,u=r.stopProfileTransactionSentry,c=void 0===u?Cr:u,l=r.apiTokenForClose,f=r.twoFaKeyForClose,console.log("Sending analytics before upload to s3"),p=jt.userOs,m=Qr()().toDate().valueOf(),d=(0,sn.v4)(),console.log("Uploading zip file"),o.addStatus({status:"cloud_uploading"}),o.removeStatus({status:"archiving"}),e.next=10,zt({fileBuff:a,profileId:n,preloadedS3SignedUrl:t,stopProfileTransactionSentry:c,apiTokenForClose:l,twoFaKeyForClose:f}).catch((function(e){Se(Eo,n);var r="notifications.error.uploadingProfileError",t=!0,a=e instanceof Error?e.message:e,i="string"==typeof a;i&&"profile deleted"===a&&(r="notifications.error.profileAlreadyDeleted",t=!1),i&&"do not send to sentry"===a&&(t=!1),i&&"no url"===a&&(t=!1),i&&"Too many requests"===a&&(r="profiles.profileStatusMessages.errorTooManyRequests"),t&&(0,be.zd)({message:a,transactionName:"upload-profile-global",tags:[["scenario","close-profile"],["profileId",n],["name","upload-profile-global"]]}),o.addStatus({status:"error",statusMessage:r})}));case 10:if(h=e.sent){e.next=16;break}return Se(Eo,n),o.addStatus({status:"error",statusMessage:"notifications.error.uploadingProfileError"}),o.removeStatus({status:"cloud_uploading"}),e.abrupt("return");case 16:return e.next=18,Rt.renameCachedProfile(n,Dt,h).catch((function(e){console.log(e);var r=c.startChild({op:"caching-profile"});return Rt.copyClosedProfileToCacheDirectory(a,n,h).catch((function(e){var r=e instanceof Error?e.message:e,t="cache-profile-after-close";"string"==typeof r&&r.includes("ENOSPC")&&(t="no-disc-space"),(0,be.oj)({message:r,transactionName:t,tags:[["scenario","close-profile"],["profileId",n]]})})).finally((function(){return r.finish()}))}));case 18:console.log("Sending analytics after upload to s3"),v=Qr()().toDate().valueOf()-m,g={type:"profile-s3-upload",status:"success",profile:n,time:v,os:p,deduplicationKey:d},ve({url:"".concat(jt.apiBaseUrl,"/analytics"),method:"POST",body:g}).catch((function(){return null})),b=c.startChild({op:"remove-files"}),Se(Eo,n),(0,A.access)(It.PROFILES_DIR+n).then((function(){return(0,A.rm)(It.PROFILES_DIR+n,{recursive:!0})})).catch((function(){b.setStatus("aborted")})),b.finish(),c.finish(),o.removeStatus({status:"cloud_uploading"}),delete i[n];case 29:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Ht=function(e){var r=e.profileId,n=e.localStorageEnabled,t=e.indexedDbEnabled,a=e.stopProfileTransactionSentry,o="".concat(It.ROUTE_SLASH,"Default").concat(It.ROUTE_SLASH,"Local Storage"),i="".concat(It.ROUTE_SLASH,"Default").concat(It.ROUTE_SLASH,"IndexedDB"),s=[];return n||(a&&a.setTag("local-storage-disabled",!0),s.push(ye(It.PROFILES_DIR+r+o))),t||(a&&a.setTag("indexed-db-disabled",!0),s.push(ye(It.PROFILES_DIR+r+i))),Promise.all(s)},Wt=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileId,t=r.currentMs,a=r.localStorageEnabled,o=r.indexedDbEnabled,i=r.stopProfileTransactionSentry,u=i.startChild({op:"waiting-orbita-finish"}),delete et[n],e.next=5,new Promise((function(e){return setTimeout(e,1e3)}));case 5:return u.finish(),c=i.startChild({op:"removing-folders"}),(l=[]).push(Ht({profileId:n,localStorageEnabled:a,indexedDbEnabled:o})),l.push((0,A.rm)("".concat(It.PROFILES_DIR).concat(n,"_").concat(t,".zip")).catch((function(){}))),l.push((0,A.rm)("".concat(It.PROFILES_DIR).concat(n,"_").concat(t,"_sync.zip")).catch((function(){}))),e.next=13,Promise.allSettled(l);case 13:c.finish();case 14:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),qt=function(){var e=o()(s().mark((function e(r){var n,t,a=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:j.$c,r.length){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,At.getExtensionsNameAndImage(r,n);case 5:return t=e.sent,e.abrupt("return",ve({url:"".concat(jt.apiBaseUrl,"/extensions/create"),method:"POST",body:{extensionsInfo:t}}));case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Vt=function(e,r){return Vn(It.PROFILES_DIR+e,e).catch((function(n){console.log("archiving error",n);var t=n instanceof Error?n.message:n,a=Ro.includes(e);if("string"==typeof t&&t.includes("Invalid profile folder path")||a)return null;r.setStatus("aborted"),(0,be.oj)({message:t,transactionName:"archive-profile-after-close",tags:[["scenario","close-profile"],["profileId",e]]})})).finally((function(){return r.finish()}))},Jt=function(){var e=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vn.getCookiesFileToRead(r);case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:return e.abrupt("return",Pn(t).catch((function(e){var t=e instanceof Error?e.message:e;if(!Ro.includes(r)){(0,be.oj)({message:t,transactionName:"load-cookies-from-file",tags:[["scenario","close-profile"],["profileId",r]]}),n.setStatus("aborted");return{cookies:[{domain:"error"}]}}})).finally((function(){return n.finish()})));case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),Xt=function(){var e=o()(s().mark((function e(r,n){var t,a,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=It.PROFILES_DIR+r+It.PASSWORDS_FILE,e.next=3,_e({fn:function(){return An(t)},retryDelay:300}).catch(function(){var e=o()(s().mark((function e(t){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t instanceof Error?t.message:t,o={origin_url:"error",username_value:"error",password_value:"error"},Ro.includes(r)){e.next=5;break}return e.abrupt("return",{passwords:[o]});case 5:return(0,be.oj)({message:a,transactionName:"load-passwords-from-file",tags:[["scenario","close-profile"],["profileId",r]]}),n.setStatus("aborted"),e.abrupt("return",{passwords:[o]});case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).finally((function(){return n.finish()}));case 3:return a=e.sent,i=a.passwords,e.abrupt("return",i.map((function(e){return{domain:e.origin_url,username:e.username_value,password:e.password_value}})).filter((function(e){return e.username&&e.password&&e.domain})));case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),Zt=function(){var e=o()(s().mark((function e(r,n,t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ot.getProfileChromeExtensions(r).catch((function(e){var r=e instanceof Error?e.message:e;return Ro.includes(t)||"string"==typeof r&&r.includes("ENOENT")||((0,be.oj)({message:r,transactionName:"read-chrome-extensions-from-pref-after-close",tags:[["scenario","close-profile"]]}),n.setStatus("aborted")),[]})).finally((function(){return n.finish()})));case 1:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}(),Yt=function(){var e=o()(s().mark((function e(r,n){var t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.readFile)(r,"utf-8").catch((function(e){var r=e instanceof Error?e.message:e;return"string"==typeof r&&r.includes("ENOENT")||(0,be.oj)({message:r,transactionName:"read-bookmarks-after-profile-close",tags:[["scenario","read-bookmarks"],["profileId",n]]}),""}));case 2:if(t=e.sent,a={roots:{}},t){e.next=6;break}return e.abrupt("return",a.roots);case 6:try{a=JSON.parse(t)}catch(e){o=e instanceof Error?e.message:e,(0,be.oj)({message:o,transactionName:"parse-bookmarks-after-profile-close",tags:[["scenario","parse-bookmarks"],["profileId",n]]})}return e.abrupt("return",a.roots);case 8:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}(),$t=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.profileId,a=r.passwords,o=r.cookies,i=r.extensionsIds,u=r.bookmarks,c=r.fileSize,l=r.pathToExtensions,f=r.stopProfileTransactionSentry,p=r.apiTokenForClose,m=r.twoFaKeyForClose,d=f.startChild({op:"upload-profile-data"}),e.next=4,Ot.uploadProfileData({browserId:t,passwords:a,cookies:o.cookies,extensionsIds:i,bookmarks:u,fileSize:c,cf:!1,hk:!1,apiTokenForClose:p,twoFaKeyForClose:m}).catch((function(e){var r,n;return null!==(r=e.response)&&void 0!==r&&null!==(n=r.body)&&void 0!==n&&n.includes("Profile has been deleted")?{s3:{url:"error",isCf:!1},extensionsIds:[]}:e.message.includes("429")||e.message.includes("Too many requests")?{s3:{url:"error-429",isCf:!1},extensionsIds:[]}:((0,be.zd)({message:e.message,transactionName:"update-profile-and-get-s3-url-after-close",tags:[["name","update-profile-and-get-s3-url-after-close"],["profileId",t]]}),d.setStatus("aborted"),d.finish(),Se(Eo,t),{url:"",isCf:!1})}));case 4:if(h=e.sent,d.finish(),v=h.s3,g=void 0===v?{url:"",isCf:!1}:v,b=h.extensionsIds,w=void 0===b?[]:b,null===(n=g.url)||void 0===n||!n.includes("error")){e.next=9;break}return e.abrupt("return",g);case 9:return qt(w,l).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"insert-extensions-to-db-error",tags:[["scenario","close-profile"],["profileId",t]]}),console.log(e)})),e.abrupt("return",g);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();const Qt=require("decompress-targz");var ea=n.n(Qt);function ra(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function na(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?ra(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ra(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var ta=$n().promisify(n(81).exec),aa={step:0,inProgress:!0},oa=null,ia=na({},aa),sa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("IN checkBrowserArchive"),ia=na(na({},ia),{},{step:1}),oa&&oa.sender.send("download-browser",{progressState:ia,result:!1,orbitaVersion:e});var r=c().join(j.wk,K).replace("{{orbita-version}}","");return _e({fn:function(){return(0,A.access)(r)},retryDelay:100})},ua=function(){var e=o()(s().mark((function e(){var r,n,t,a,o,i,u=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>0&&void 0!==u[0]?u[0]:"",console.log("IN downloadNewBrowser",{orbitaVersion:r}),oa&&oa.sender.send("download-browser",{progressState:ia,result:!1,orbitaVersion:r}),n=c().join(j.wk,K).replace("{{orbita-version}}",""),e.next=6,ye(n).catch((function(){return null}));case 6:if(t=(new Fe).localOrbitaReleasesList,o=(a=r)?"-".concat(a):"",i=q,"win32"!==j.iw){e.next=18;break}if(!((0,L.lZ)()<10)){e.next=17;break}if(!(a&&Number(a)>=110)){e.next=16;break}throw oa&&oa.sender.send("download-browser",{progressState:ia,result:!0,unsupportedWinVersion:!0}),new Error("notifications.error.unsupportedWinVersion");case 16:a||t[109]||(a="109",o="-109");case 17:i=V;case 18:if("darwin"!==j.iw){e.next=24;break}return i=H,e.next=22,(0,L.Ij)();case 22:"macM1"===e.sent&&(i=W);case 24:return i=i.replace("{{orbita-version}}",o),e.next=27,_e({fn:function(){return(0,A.mkdir)(j.wk,{recursive:!0})}}).catch((function(e){throw console.log("error in making browser dir"),e}));case 27:return console.log("orbita download started"),e.next=30,$e({url:i,destFile:n,progressEvent:oa,progressEventName:"download-browser",progressState:ia,isContinueStream:!0,retryDelay:5e3,retryLimit:100,orbitaVersion:r});case 30:return console.log("orbita download finished"),e.next=33,sa(r);case 33:return e.next=35,pa(a);case 35:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ca=function(){var e=o()(s().mark((function e(){var r,n,t,a,o,i=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.length>0&&void 0!==i[0]?i[0]:"",console.log("IN downloadHashFile"),n=j.iw,t=ae,a=c().join(j.wk,ee),"win32"!==n){e.next=9;break}return e.abrupt("return",Promise.resolve());case 9:if("darwin"!==n){e.next=16;break}return t=ne,a=c().join(j.wk,$),e.next=14,(0,L.Ij)();case 14:"macM1"===e.sent&&(t=te,a=c().join(j.wk,Q));case 16:return o=r?"-".concat(r):"",t=t.replace("{{orbita-version}}",o),a=a.replace("{{orbita-version}}",o),e.abrupt("return",_e({fn:function(){return ve({url:t,timeout:3e4,method:"GET",json:!1}).then((function(e){return(0,A.writeFile)(a,e,{mode:438})})).then((function(){return(0,A.access)(a)})).then((function(){return Promise.resolve()}),(function(){return Promise.reject(new Error("Hash file has not been downloaded"))}))},retryDelay:1e3,limit:10}));case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),la=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return ca(e).then((function(){console.log("IN checkBrowserSum");var n=j.iw,t=c().join(j.wk,ie),a=e?"-".concat(e):"";if("win32"===j.iw)return Promise.resolve();if("darwin"===n){var o=c().join(j.wk,ie,"Orbita-Browser.app"),i=c().join(j.wk,$).replace("{{orbita-version}}",a);return _e({fn:function(){return ta("mtree -p ".concat(o," < ").concat(i," || echo ").concat(oe)).then((function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().trim().includes(oe)?O().release().toLowerCase().includes("debian")?Promise.reject(new Error("Debian os is not supported")):Promise.reject(new Error("Error in sum matching")):Promise.resolve()}))}})}var s=c().join(j.wk,ee).replace("{{orbita-version}}",a);return _e({fn:function(){return(0,A.readFile)(s,"utf-8").then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=e.trim(),a=e.split(" "),o=r()(a,1);return n=(n=o[0]).replace(/(\r\n|\n|\r)/gm,""),ta("cd ".concat(t," && find orbita-browser -type f -print0 | sort -z |              xargs -0 sha256sum > ").concat(j.wk,"/calculatedFolderSha.txt")).then((function(){return ta("cd ".concat(j.wk," && sha256sum calculatedFolderSha.txt"))})).then((function(e){var t=(e.stdout||"").toString().trim(),a=t.split(" ");return(t=r()(a,1)[0])!==n?Promise.reject(new Error("Error in sum matching")):Promise.resolve()}))}))}})}))},fa=function(){var e=o()(s().mark((function e(){var n,t,a,o,i,u,l,f=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f.length>0&&void 0!==f[0]?f[0]:"",console.log("IN replaceBrowser"),ia=na(na({},ia),{},{step:2}),oa&&oa.sender.send("download-browser",{progressState:ia,result:!1,orbitaVersion:n}),e.next=6,ma(n).catch((function(e){var r=e instanceof Error?e.message:e;throw(0,be.zd)({message:r,transactionName:"request-last-orbita-version-error",level:"fatal",tags:[["scenario","download-orbita"],["name","request-last-orbita-version-error"]]}),e}));case 6:return t=e.sent,a=t.split("."),o=r()(a,1),i=o[0],u=c().join(j.wk,j.ko+"-"+i),console.log("browserPath:",u),l="darwin"===j.iw?c().join(j.wk,ie):c().join(j.wk,ie,j.ko),e.next=13,_e({fn:function(){return(0,A.rm)(u,{recursive:!0,force:!0}).catch((function(){return null})).then((function(){return(0,A.mkdir)(u,{recursive:!0})})).then((function(){return(0,A.cp)(l,u,{recursive:!0})}))},retryDelay:200});case 13:if("darwin"===j.iw){e.next=15;break}return e.abrupt("return");case 15:return e.abrupt("return",_e({fn:function(){return(0,A.mkdir)(c().join(u,"version"),{recursive:!0}).then((function(){return(0,A.writeFile)(c().join(u,"version",R),t,{mode:438})}))},retryDelay:100}).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"writing-orbita-version-file-error",tags:[["scenario","download-orbita"]]})})));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pa=function(){var e=o()(s().mark((function e(){var r,n,t,a=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.length>0&&void 0!==a[0]?a[0]:"",console.log("IN extractBrowser"),console.log("extractBrowser absolutePath: ".concat(j.wk)),console.log("creating folder for extraction"),e.next=6,_e({fn:function(){return(0,A.mkdir)(c().join(j.wk,ie),{recursive:!0})},retryDelay:100});case 6:return console.log("starting decompress"),n={plugins:[ea()()],filter:function(e){return!e.path.endsWith("/")}},"win32"===j.iw&&(n.plugins[0]=Sr()()),e.next=11,_e({fn:function(){return yr()(c().join(j.wk,K).replace("{{orbita-version}}",""),c().join(j.wk,ie),n)}}).catch((function(){return"decompress error"}));case 11:if("decompress error"!==e.sent){e.next=23;break}return e.next=15,(0,A.rm)(c().join(j.wk,K).replace("{{orbita-version}}",""),{recursive:!0});case 15:return e.next=17,va(r);case 17:return t=e.sent,console.log(t),e.next=21,$e({url:t,destFile:c().join(j.wk,K).replace("{{orbita-version}}",""),progressEvent:oa,progressEventName:"download-browser",progressState:ia,isContinueStream:!0,retryDelay:5e3,retryLimit:100,orbitaVersion:r});case 21:return e.next=23,_e({fn:function(){return yr()(c().join(j.wk,K).replace("{{orbita-version}}",""),c().join(j.wk,ie),n)}});case 23:return e.next=25,sa();case 25:return e.next=27,la(r);case 27:return e.next=29,fa(r);case 29:ia=na(na({},ia),{},{step:3}),oa&&oa.sender.send("download-browser",{progressState:ia,result:!1});case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ma=function(){var e=o()(s().mark((function e(){var r,n,t,a,o=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.length>0&&void 0!==o[0]?o[0]:"",n=j.iw,t=U,"win32"!==n){e.next=7;break}t=z,e.next=13;break;case 7:if("darwin"!==n){e.next=13;break}return t=F,e.next=11,(0,L.Ij)();case 11:"macM1"===e.sent&&(t=G);case 13:return a=r?"-".concat(r):"",t=t.replace("{{orbita-version}}",a),e.abrupt("return",_e({fn:function(){return ve({url:t,timeout:1e4,json:!1}).then((function(e){return e?e.replace(/(\r\n|\n|\r)/gm,""):Promise.reject(new Error("Latest Version has not been provided"))}))},retryDelay:300}));case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),da=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return _e({fn:function(){return(0,A.rm)(c().join(j.wk,ie),{recursive:!0,force:!0}).then((function(){return(0,A.readdir)(j.wk)})).then((function(e){var r=[];return e.forEach((function(e){e.match(/.*\.txt$/)&&r.push((0,A.rm)(c().join(j.wk,e),{recursive:!0,force:!0}))})),Promise.all(r)})).then(o()(s().mark((function r(){var n;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("darwin"!==j.iw){r.next=8;break}return n=e?"-".concat(e):"",r.next=4,(0,L.Ij)();case 4:if("macM1"!==r.sent){r.next=7;break}return r.abrupt("return",(0,A.rm)(c().join(j.wk,Q).replace("{{orbita-version}}",n),{recursive:!0,force:!0}));case 7:return r.abrupt("return",(0,A.rm)(c().join(j.wk,$).replace("{{orbita-version}}",n),{recursive:!0,force:!0}));case 8:case"end":return r.stop()}}),r)})))).catch((function(e){var r=e instanceof Error?e.message:e;if("string"!=typeof r||!r.includes("ENOENT")){if("string"==typeof r&&r.includes("ENOTEMPTY"))throw e;return(0,be.zd)({message:r,transactionName:"delete-orbita-installation-files",level:"warning",tags:[["scenario","download-orbita"],["name","delete-orbita-installation-files"]]}),Promise.resolve()}}))},retryDelay:300})},ha=function(e){var r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{orbitaVersion:""}).orbitaVersion;return oa=e,"100"===r&&(r="10"),"103"===r&&(r="13"),ua(r).then((function(){return(new Fe).checkLocalOrbitaReleases()})).then((function(){return da(r)})).catch((function(e){var n=e instanceof Error?e.message:e;"string"==typeof n&&n.includes("ENOSPC")&&oa&&oa.sender.send("download-browser",{progressState:ia,result:!0,isDiscSpaceError:!0}),ia=na(na({},ia),{},{errorMessage:n});var t="string"==typeof n?n:"deleting old files error";return da(r).finally((function(){return Promise.reject(new Error(t))}))})).finally((function(){var e={progressState:na(na({},ia),{},{inProgress:!1}),result:!ia.errorMessage,errorMessage:ia.errorMessage||""};ia=na({},aa),oa&&oa.sender.send("download-browser",e)}))},va=function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Z,"win32"===j.iw&&(n=Y),"darwin"!==j.iw){e.next=8;break}return n=J,e.next=6,(0,L.Ij)();case 6:"macM1"===e.sent&&(n=X);case 8:return e.abrupt("return",n.replace("{{orbita-version}}",r?"-".concat(r):""));case 9:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ga=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.orbitaConsoleContainer,a=r.message,o=r.profileData,i=r.processDurationMs,u=r.code,c=r.signal,l=r.ProfileStatusManagerInst,f=r.channel,p=(null===(n=o.gologin)||void 0===n?void 0:n.userAgent)||"",m=(new Fe).getMajorVersionByUA(p),d=(new Fe).getOrbitaPathToStart(m),h=d.browserWorkingDir,e.next=6,(0,A.readdir)(h).catch((function(){return console.log("error reading browser dir")}));case 6:v=e.sent,console.log(t),console.log("orbita logs: "),console.log(v),console.log("browser dir content: "),g="crash-orbita",i<3e3&&(g="open-orbita"),e.t0=!0,e.next=e.t0===(7===u)?16:e.t0===("SIGABRT"===c)?20:e.t0===(2147483651===u)?24:e.t0===t.some((function(e){return e.includes("Opening in existing browser session")}))?27:e.t0===(126===u)?29:e.t0===t.some((function(e){return e.includes("chrome.exe")}))?32:e.t0===(3221225785===u)?36:e.t0===(21===u)?38:e.t0===(3221225506===u)?40:e.t0===(127===u)?43:e.t0===(3765269347===u)?47:e.t0===(4294967295===u)?49:e.t0===(3221225477===u)?51:e.t0===(3221225501===u)?53:e.t0===(0===u)?55:56;break;case 16:return g+="-no-dll",ha(f,{orbitaVersion:m}),l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.reDownloadOrbita"}),e.abrupt("break",57);case 20:return ha(f,{orbitaVersion:m}),l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.reDownloadOrbita"}),g+="-mac-sigabrt",e.abrupt("break",57);case 24:return l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.gpuCrash"}),g+="-gpu",e.abrupt("break",57);case 27:return g+="-existing-session",e.abrupt("break",57);case 29:return g+="-mac-processor",l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.macNotSupport"}),e.abrupt("break",57);case 32:return g+="-no-exe",ha(f,{orbitaVersion:m}),l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.reDownloadOrbita"}),e.abrupt("break",57);case 36:return g+="-3221225785",e.abrupt("break",57);case 38:return g+="-cant-create-singleton",e.abrupt("break",57);case 40:return l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.antivirus"}),g+="-access",e.abrupt("break",57);case 43:return g+="-no-files-mac",ha(f,{orbitaVersion:m}),l.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.reDownloadOrbita"}),e.abrupt("break",57);case 47:return g+="-3765269347",e.abrupt("break",57);case 49:return g+="-4294967295",e.abrupt("break",57);case 51:return g+="-3221225477",e.abrupt("break",57);case 53:return g+="-3221225501",e.abrupt("break",57);case 55:return e.abrupt("return");case 56:g+="-unknown";case 57:(0,be.oj)({message:a,transactionName:g,level:"fatal",tags:[["scenario","close-profile"]]});case 58:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();const ba=require("axios");function wa(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function ka(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?wa(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wa(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}n.n(ba)().defaults.headers["Content-Type"]="application/json";var ya=new me.CommonDataManager,xa=function(e){var r=e.endpoint,n=e.method,t=e.headers,a=e.body,o={url:"".concat(ya.apiBaseUrl).concat(r),method:n,headers:ka(ka({},t),{},{Authorization:"Bearer ".concat(ya.accessToken),"user-agent":ya.userAgent,"x-two-factor-token":ya.twoFaKey})};return"GET"!==n&&(o.body=a),ve(o).catch((function(){return null}))};function Sa(e,r){var n=!!To[e];void 0!==r.running&&(n=r.running),xa({endpoint:"/browser/".concat(e,"/run-sync"),method:"PATCH",body:{running:n}}).catch((function(){return null}))}var _a=(0,j.IT)(),Ta=new Mt,Pa=new me.CommonDataManager,Ea=function(){var e=o()(s().mark((function e(n){var t,a,i,u,c,l,f,p,m,d,h,v,g,b,k,y,x,S,_,T,P,E,C,M,N,B,I,O,j,L,R,D,F,G,U,z,K,H,W,q,V,J,X,Z,Y,$,Q,ee,re,ne,te,ae,oe,ie,se,ue;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.timezoneCheckResult,u=n.startProfileTimestamp,c=n.profileOptions,l=n.remoteCb,f=n.profileData,p=n.automation,m=n.args,d=n.channel,h=n.passwordsTemporaryToken,v=n.currentMs,g=n.ProfileReadyEventEmitterInst,b=n.profilePreparingRes,k=n.timings,y=n.startProfileTransactionSentry,x=void 0===y?Cr:y,S=n.ProfileStatusManagerInst,_=n.ProfileStatusManagerInstances,T=f.profileId,P=i.timezone,E=i.ll,C=void 0===E?["0","0"]:E,M=i.accuracy,N=void 0===M?100:M,B=i.ip,I=i.country,B&&P){e.next=10;break}return O="Timezone request error.",console.log(i),(0,be.oj)({message:"Timezone request error - ".concat(i),transactionName:"timezone-request-error",level:"fatal",tags:[["scenario","run-profile"],["profileId",T]]}),S.addStatus({status:"error",statusMessage:O,startProfileTimestamp:u,profileOptions:c}),l&&l(null,{status:403,message:O}),e.abrupt("return","error");case 10:return c.proxyCountry=I,e.prev=11,j=b.reduce((function(e,r){return"profileExtensionsCheckRes"in r&&(e.profileExtensionPathRes=r),"profileUserExtensionsCheckRes"in r&&(e.profileUserExtensionPathRes=r),e}),{profileExtensionPathRes:{},profileUserExtensionPathRes:{}}),L=j.profileExtensionPathRes,R=j.profileUserExtensionPathRes,D=r()(C,2),F=D[0],G=D[1],console.log("Getting timezone:",P),U=f.fillProxyByIp?P:f.timezoneValue,z=f.gologin.geoLocation,K={latitude:F,longitude:G,accuracy:N},f.gologin.geoLocation=Ca(z,K),f.gologin.timezone={id:U},H=((null==L?void 0:L.profileExtensionsCheckRes)||[]).concat((null==R?void 0:R.profileUserExtensionsCheckRes)||[]),console.log("checkRes",H),W=x.startChild({op:"write-preferences"}),e.next=25,Ta.updatingBrowserSettings({profileData:f,publicUserIp:B,profileExtensionsCheckRes:H,args:m});case 25:W.finish(),e.next=40;break;case 28:return e.prev=28,e.t0=e.catch(11),q=e.t0 instanceof Error?e.t0.message:e.t0,V="profileStatusMessages.defectiveProfileError",J="update-preferences-file","string"==typeof q&&q.includes("ENOSPC")&&(J="no-disk-space",V="profileStatusMessages.discSpaceError"),(0,be.oj)({message:q,transactionName:J,level:"fatal",tags:[["scenario","run-profile"],["profileId",T]]}),x.setStatus("aborted"),x.finish(),S.addStatus({status:"error",startProfileTimestamp:u,statusMessage:V,profileOptions:c}),l&&l(null,{status:403,message:V}),e.abrupt("return","error");case 40:return g.removeListener("profile-ready",(function(){console.log("listener removed")})),To[T]||(To[T]={}),e.next=44,Na(T).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"remove-lock-files-error",level:"fatal",tags:[["scenario","run-profile"],["profileId",T]]})}));case 44:return console.log("args",m),console.log("Spawning browser process"),Z=x.startChild({op:"spawn-browser"}),e.prev=47,$=(null===(Y=f.gologin)||void 0===Y?void 0:Y.userAgent)||"",e.next=51,Ma(m,$);case 51:X=e.sent,Z.finish(),x.finish(),e.next=74;break;case 56:return e.prev=56,e.t1=e.catch(47),ee=e.t1 instanceof Error?e.t1.message:e.t1,re="launchBrowser error ".concat(T,". ").concat(ee),ne=(null===(Q=f.gologin)||void 0===Q?void 0:Q.userAgent)||"",te=(new Fe).getMajorVersionByUA(ne),ae=(new Fe).getOrbitaPathToStart(te),oe=ae.browserWorkingDir,e.next=65,(0,A.readdir)(oe).catch((function(){return console.log("error reading browser dir")}));case 65:return ie=e.sent,console.log(ie),console.log("browser dir:"),(0,be.zd)({message:ee,transactionName:"spawn-orbita-process",tags:[["scenario","run-profile"],["profileId",T],["name","spawn-orbita-process"]]}),x.setStatus("aborted"),x.finish(),S.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.antivirus",startProfileTimestamp:u,profileOptions:c}),l&&l(null,{status:403,message:re}),e.abrupt("return","error");case 74:se=[],Se(Po,T),et[T]=null===(t=X)||void 0===t?void 0:t.pid,console.log("profile ".concat(T," orbita pid:"),null===(a=X)||void 0===a?void 0:a.pid);try{To[T].startProfileTimestamp=Qr().now(),k.overallTime=Qr().now()-u,c.proxyMode=f.proxy.mode,To[T].startMode=c.startMode,To[T].orbitaProc=X,Sa(T,{running:!0}),To[T].bigTimer=setInterval((function(){return Sa(T,{})}),18e4)}catch(e){console.log("error assigning startProfileTimestamp")}S.addStatus({status:"running",startProfileTimestamp:u,profileOptions:c,timings:k}),S.removeStatus({status:"preparing_profile"}),ue=function(e){try{se.unshift(e.toString().replace(/\n/g,"").replace(/\s\s+/g," ")),se.length>50&&(se.length=50)}catch(e){console.log(e)}};try{X&&X.stdout.on("data",(function(e){ue(e)})),X&&X.stderr.on("data",(function(e){ue(e)})),X&&X.on("error",function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=r instanceof Error?r.message:r,console.log(r),S.addStatus({status:"error",statusMessage:"profilesTable.profileStatusTooltip.antivirus"}),(0,be.oj)({message:t,transactionName:"open-orbita-process",level:"fatal",tags:[["scenario","close-profile"],["profileId",T]]}),(null===(n=To[T])||void 0===n?void 0:n.bigTimer)&&clearInterval(To[T].bigTimer),delete To[T];case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}())}catch(e){console.log(e)}return X&&X.on("exit",function(){var e=o()(s().mark((function e(r,n){var t,a,o,i,c,l,m,g,b;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("closing profile",T),Sa(T,{running:!1}),o=Qr().now()-(null===(t=To[T])||void 0===t?void 0:t.startProfileTimestamp),(null===(a=To[T])||void 0===a?void 0:a.bigTimer)&&clearInterval(To[T].bigTimer),delete To[T],!(Ro.includes(T)||Po.includes(T)||Eo.includes(T))){e.next=7;break}return e.abrupt("return");case 7:return i="child process exited with code ".concat(r," and signal ").concat(n),S.addStatus({status:"archiving"}),S.removeStatus({status:"running"}),console.log(i),(![0,null].includes(r)||"SIGABRT"===n||o<3e3)&&ga({orbitaConsoleContainer:se,message:i,profileData:f,processDurationMs:o,code:r,signal:n,ProfileStatusManagerInst:S,channel:d}).catch((function(){return null})),e.next=14,(new Fe).getLocalOrbitaVersionByPath().catch((function(e){return console.log("Error in reading browser version",e),""}));case 14:return c=e.sent,console.log("braveProc browserVersion:",c),l=Pa.userOs,m={type:"browser-close",status:0===r||null===r?"success":"error",profile:T,time:Date.now()-u,message:"".concat(r),os:l,browserVersion:c,appVersion:w.i8,proxyMode:f.proxy.mode},ve({url:"".concat(Pa.apiBaseUrl,"/analytics"),method:"POST",body:m}).catch((function(e){return console.log(e)})),ve({url:"".concat(Pa.apiBaseUrl,"/profiles-passwords/temporary-token"),method:"DELETE",headers:{Authorization:"Bearer ".concat(h),"user-agent":Pa.userAgent,"x-two-factor-token":Pa.twoFaKey||""}}).catch((function(e){return console.log(e)})),g=Pa.accessToken,b=Pa.twoFaKey,e.next=24,Ft({profileId:T,currentMs:v,debugMode:f.debugMode,localStorageEnabled:f.localStorageEnabled,indexedDbEnabled:f.indexedDbEnabled,channel:d,os:f.os,ProfileStatusManagerInst:S,ProfileStatusManagerInstances:_,automation:p,apiTokenForClose:g,twoFaKeyForClose:b}).catch((function(e){Se(Eo,T);var r=e instanceof Error?e.message:e,n="profile close error ".concat(T,". ").concat(r),t=!0;"The profile has been deleted"===r&&(n="notifications.error.profileAlreadyDeleted",t=!1),"profile archive is not found"===r&&(t=!1),"Too many requests"===r&&(n="profiles.profileStatusMessages.errorTooManyRequests"),S.addStatus({status:"error",statusMessage:n}),t&&(0,be.zd)({message:r,transactionName:"close-profile-global",tags:[["scenario","close-profile"],["profileId",T],["name","close-profile-global"]]})}));case 24:S.removeStatus({status:"syncing"});case 25:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),l&&l(null,null),e.abrupt("return","success");case 86:case"end":return e.stop()}}),e,null,[[11,28],[47,56]])})));return function(r){return e.apply(this,arguments)}}(),Ca=function(e,r){return e.fillBasedOnIp?{mode:e.mode,latitude:Number(r.latitude),longitude:Number(r.longitude),accuracy:Number(r.accuracy)}:{mode:e.mode,latitude:e.latitude,longitude:e.longitude,accuracy:e.accuracy}},Ma=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]?l[1]:"",t=(new Fe).getMajorVersionByUA(n),a=(new Fe).getOrbitaPathToStart(t),o=a.pathToLaunch,i=a.browserWorkingDir,console.log("majorChromeVersion:",t),console.log("pathToLaunch:",o),console.log("browserWorkingDir:",i),u={shell:!0,cwd:i,detached:!0,stdio:"pipe"},(c=(0,rn.spawn)('"'.concat(o,'"'),r,u)).unref(),e.abrupt("return",c);case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Na=function(e){var r=["SingletonLock","SingletonSocket","SingletonCookie","RunningChromeVersion"].map(function(){var r=o()(s().mark((function r(n){var t;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t=c().resolve(_a.PROFILES_DIR,e,n),console.log(t),r.abrupt("return",(0,A.rm)(t,{force:!0}));case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}());return Promise.all(r)};const Ba=JSON.parse('{"name":"GoLess","description":"GoLess no-code browser automation and Robotic Process Automation (RPA) tool","version":"1.2.0","manifest_version":2,"key":"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAqqaZ0LrhJrdC9apVWeL5B60tXzfrJl2HaCb9fDQrv29yyHbS2MDaSORjkSjA8IMFQAX+1eGf/p8x6EQR91nkwdJY3tfxiPyyKLPsbWIDp0wEjBIE/qjPimGGnLisMevG08XNal+rW+P7WtRW/4gJzs5/E6iuXV8jtK8BqaSBTP9btYHxhusUFdXSH8B3aR/CqrCQoJypzaBiAU8EBP1yJVWYid7cmBUR0A4xGe3o8/n4t/XwxGD1Msi2XmA52NqQGn7y801ZefIvVUBch1MrDBkPBoj9mcTVPZju1zhqPw295DkSCvMDmdLL2kmRt63cp0Jw05SHHtBN28xKiMEHHwIDAQAB","browser_action":{"default_popup":"popup.html","default_icon":"logoGA.png"},"background":{"scripts":["background.bundle.js"]},"icons":{"128":"logoGA.png"},"commands":{"open-dashboard":{"suggested_key":{"default":"Alt+A","mac":"Alt+A"},"description":"Open the GoLess dashboard"},"element-picker":{"suggested_key":{"default":"Alt+P","mac":"Alt+P"},"description":"Open element picker"}},"content_scripts":[{"matches":["<all_urls>"],"js":["contentScript.bundle.js"],"run_at":"document_start","match_about_blank":true,"all_frames":true},{"matches":["http://localhost/*","*://*.goless.com/*","*://goless.com/*"],"js":["webService.bundle.js"],"run_at":"document_start","all_frames":false}],"optional_permissions":["clipboardRead","contextMenus","downloads","notifications"],"permissions":["alarms","cookies","debugger","proxy","scripting","storage","tabs","unlimitedStorage","webNavigation","<all_urls>"],"web_accessible_resources":["*"],"externally_connectable":{"matches":["http://localhost:3004/*","*://localhost/*","*://goless.com/*"]},"sandbox":{"pages":["/sandbox.html"]},"content_security_policy":"script-src \'self\' https://apis.google.com/ https://accounts.google.com/ https://www.googleapis.com https://ajax.googleapis.com; object-src \'self\'"}');var Ia={checksum:"f2a8ce0f0fddfeee2229d72f0f30e713",roots:{bookmark_bar:{children:[{children:[{name:"Facebook",type:"url",url:"https://www.facebook.com/"},{name:"Notifications",type:"url",url:"https://www.facebook.com/settings?tab=notifications"},{name:"Account Quality",type:"url",url:"https://www.facebook.com/accountquality"},{name:"Ads Manager",type:"url",url:"https://www.facebook.com/adsmanager/manage/campaigns"},{name:"Billing",type:"url",url:"https://www.facebook.com/ads/manager/account_settings/account_billing"},{name:"Business Manager",type:"url",url:"https://business.facebook.com/select"}],name:"Facebook",type:"folder"},{children:[{name:"Amazon",type:"url",url:"https://www.amazon.com/"},{name:"eBay",type:"url",url:"https://ebay.com/"},{name:"Walmart",type:"url",url:"https://walmart.com/"},{name:"Shopify",type:"url",url:"https://www.shopify.com/"},{name:"Avito",type:"url",url:"https://avito.ru/"},{name:"Taobao",type:"url",url:"https://taobao.com/"},{name:"Wildberries",type:"url",url:"https://wildberries.ru/"},{name:"Aliexpress",type:"url",url:"https://aliexpress.com/"},{name:"PayPal",type:"url",url:"https://paypal.com/"},{name:"Payoneer",type:"url",url:"https://payoneer.com/"}],name:"Dropshipphing",type:"folder"},{children:[{name:"Coinlist",type:"url",url:"https://coinlist.co/"},{name:"Huobi",type:"url",url:"https://www.huobi.com/"},{name:"Discord",type:"url",url:"https://discord.com/"},{name:"Premint",type:"url",url:"https://www.premint.xyz/"}],name:"Crypto",type:"folder"},{children:[{name:"bet365",type:"url",url:"https://www.bet365.com/"},{name:"Fonbet",type:"url",url:"https://www.fon.bet/"},{name:"1xbet",type:"url",url:"https://1xbet.com/"},{name:"Parimatch",type:"url",url:"https://parimatch.com/"},{name:"Melbet",type:"url",url:"https://melbet.com/"},{name:"1xstavka",type:"url",url:"https://1xstavka.ru/"}],name:"Betting",type:"folder"},{name:"Facebook",type:"url",url:"https://www.facebook.com/"},{name:"Amazon",type:"url",url:"https://www.amazon.com/"},{name:"TikTok",type:"url",url:"https://www.tiktok.com/"},{name:"Google Ads",type:"url",url:"https://ads.google.com/"},{name:"Browser check",type:"url",url:"https://iphey.com/"}],name:"Bookmarks bar",type:"folder"},other:{children:[],name:"Other bookmarks",type:"folder"},synced:{children:[],name:"Mobile bookmarks",type:"folder"}},version:1};function Oa(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function Aa(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?Oa(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oa(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var ja=(0,j.IT)(),La=1048576,Ra=new en;Ra.init().catch((function(){return null}));var Da=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k,y;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.timings,t=r.remoteCb,a=r.profilePath,o=r.getProfileArchiveOptions,i=o.s3Path,u=o.profileOptions,c=o.startProfileTimestamp,l=o.startProfileTransactionSentry,f=o.ProfileStatusManagerInst,p=o.profileId,m=Qr().utc().valueOf(),e.next=5,Ga(o);case 5:if(d=e.sent,l.tags=Aa(Aa({},l.tags),{},{"profile-mode":u.startMode}),"error"!==d){e.next=9;break}return e.abrupt("return","error");case 9:if("no need to decompress"!==d){e.next=13;break}return f.addStatus({status:"preparing_profile"}),f.removeStatus({status:"downloading_profile_init"}),e.abrupt("return");case 13:return h=0,we(d).then((function(e){h=e,l.tags=Aa(Aa({},l.tags),{},{"zip-size-MB":e/La})})).catch((function(){return null})),n.awsRequest=Qr().utc().valueOf()-m,e.next=18,ye(a).catch(console.log);case 18:return v=Qr().utc().valueOf(),g=l.startChild({op:"decompress-profile"}),e.next=22,Fa(d,a,i);case 22:if("error"!==(b=e.sent).status){e.next=49;break}if(w="profileStatusMessages.errorDefectiveProfile",k=!0,!b.error.message.includes("ENOSPC")){e.next=30;break}w="profileStatusMessages.errorDiscSpace",e.next=44;break;case 30:if(!i||i.includes("zero_profile")){e.next=42;break}return o.onlyAws=!0,console.log("try to download from aws"),e.next=35,Ga(o);case 35:return y=e.sent,e.next=38,Fa(y,a,i);case 38:"error"!==e.sent.status&&(k=!1),e.next=44;break;case 42:if(!i.includes("zero_profile")&&i){e.next=44;break}return e.abrupt("return",Ua({profileId:p}).catch((function(e){var r=e instanceof Error?e.message:e;return"string"==typeof r&&r.includes("table cookies already exists")?"success":("string"==typeof r&&(r.includes("ENOSPC")||r.includes("SQLITE_FULL"))&&f.addStatus({status:"error",statusMessage:"profileStatusMessages.discSpaceError",startProfileTimestamp:c}),(0,be.zd)({message:r,transactionName:"create-zero-profile-after-decompress-error",level:"fatal",tags:[["scenario","run-profile"],["name","create-zero-profile-after-decompress-error"]]}),"error")})));case 44:if(!k){e.next=49;break}return(0,be.zd)({message:b.error.message,transactionName:"extract-profile",level:"fatal",tags:[["scenario","run-profile"],["s3Path",i],["name","extract-profile"]]}),f.addStatus({status:"error",startProfileTimestamp:c,errorMessage:"profileStatusMessages.archiveDecompressError",profileOptions:u}),t&&t(null,{status:403,message:w}),e.abrupt("return","error");case 49:console.log("Extracting profile zip-archive completed"),f.addStatus({status:"preparing_profile"}),f.removeStatus({status:"downloading_profile_init"}),d.includes("gologin-cached-profiles")||d.includes("zero_profile")||(console.log("Removing profile zip-archive"),(0,A.unlink)(d).catch((function(e){var r=e instanceof Error?e.message:e;console.error("Error in removing zip and folders:",r||"no error")}))),l.tags=Aa(Aa({},l.tags),{},{"internet-speed-mbs":n.awsRequest/1e3/(h/La)*8}),n.decompress=Qr().utc().valueOf()-v,g.finish();case 56:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Fa=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return console.log("zipPath: ".concat(e,", profilePath: ").concat(r)),_e({fn:function(){return Jn(e,r).then((function(){return{status:"success"}}))},retryDelay:300,limit:2}).catch(function(){var r=o()(s().mark((function r(n){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return console.error("error extracting profile zip"),console.log(e,"\n",ja.PROFILES_DIR),r.abrupt("return",{status:"error",error:n});case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())||{}},Ga=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h,v;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.zipPath,t=r.s3Path,a=r.s3Date,o=r.profileId,i=r.startProfileTimestamp,u=r.startProfileTransactionSentry,c=r.s3SignedUrl,l=r.profileOptions,f=r.ProfileStatusManagerInst,p=r.onlyAws,m=void 0!==p&&p,e.next=3,Ra.getCachedProfile(t,o,a);case 3:if(!(d=e.sent).status||m){e.next=7;break}return l.startMode="cached",e.abrupt("return",d.cachedArchivePath||"");case 7:if(t&&!t.includes("zero")){e.next=10;break}return l.startMode="zero profile",e.abrupt("return",Ua({profileId:o}).catch((function(e){console.log(e);var r=e instanceof Error?e.message:e,n="create-zero-profile";return"string"==typeof r&&r.includes("table cookies already exists")?"no need to decompress":("string"==typeof r&&(r.includes("ENOENT")||r.includes("SQLITE_FULL"))&&f.addStatus({status:"error",statusMessage:"profileStatusMessages.discSpaceError",startProfileTimestamp:i}),(0,be.zd)({message:r,transactionName:n,level:"fatal",tags:[["scenario","run-profile"],["name",n]]}),"error")})));case 10:return h=u.startChild({op:"download-profile-from-aws"}),e.next=13,Ze({url:c?c.url:"https://gprofiles.gologin.com/".concat(t),destFile:n}).catch((function(e){var r=e instanceof Error?e.message:e,n="download-profile-from-aws",t="profileStatusMessages.errorProfileLoading";return"string"==typeof r&&r.includes("ENOSPC")&&(t="profileStatusMessages.discSpaceError"),"string"==typeof r&&r.includes("404")&&(t="profileStatusMessages.profileDeleted"),(0,be.zd)({message:r,transactionName:n,tags:[["name",n]]}),f.addStatus({status:"error",statusMessage:t,startProfileTimestamp:i}),"error"}));case 13:if(v=e.sent,h.finish(),"error"!==v){e.next=19;break}return"Error downloading profile. Check your internet connection.",f.addStatus({status:"error",statusMessage:"profileStatusMessages.errorProfileLoading",startProfileTimestamp:i,errorMessage:"Error downloading profile. Check your internet connection."}),e.abrupt("return","error");case 19:return console.log("Profile zip-archive writing completed"),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Ua=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileId,t=ja.PROFILES_DIR+n,a=u.resolve(t,"Default","Preferences"),o=u.resolve(t,"Default","Bookmarks"),i=u.resolve(t,"Default","Network"),c=u.resolve(t,"Default","Network","Cookies"),e.next=8,(0,A.mkdir)(i,{recursive:!0});case 8:return l=[(0,A.writeFile)(a,JSON.stringify(Tt),{mode:438}),(0,A.writeFile)(o,JSON.stringify(Ia),{mode:438}),Bn(c)],e.next=11,Promise.all(l);case 11:return e.abrupt("return","no need to decompress");case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();function za(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var Ka=new WeakMap,Ha=new WeakMap,Wa=new WeakMap,qa=new WeakMap,Va=function(){function e(r){S()(this,e),za(this,Ka,{writable:!0,value:!1}),za(this,Ha,{writable:!0,value:{}}),za(this,Wa,{writable:!0,value:!1}),za(this,qa,{writable:!0,value:void 0}),M()(this,qa,r)}return T()(e,[{key:"isProxyReady",set:function(e){M()(this,Ka,!0),M()(this,Ha,e),this.sendReadyEvent()}},{key:"eventEmitter",get:function(){return B()(this,qa)}},{key:"isProfilePrepared",set:function(e){M()(this,Wa,e),this.sendReadyEvent()}},{key:"sendReadyEvent",value:function(){B()(this,Wa)&&B()(this,Ka)&&B()(this,qa).emit("profile-ready",B()(this,Ha))}}]),e}();function Ja(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var Xa=new WeakMap,Za=new WeakMap,Ya=new WeakMap,$a=new WeakMap,Qa=new WeakMap,eo=new WeakMap,ro=function(){function e(r,n){S()(this,e),Ja(this,Xa,{writable:!0,value:void 0}),Ja(this,Za,{writable:!0,value:void 0}),Ja(this,Ya,{writable:!0,value:void 0}),Ja(this,$a,{writable:!0,value:!1}),Ja(this,Qa,{writable:!0,value:this.getStatusData("ready")}),Ja(this,eo,{writable:!0,value:new me.CommonDataManager}),M()(this,Xa,r),M()(this,Za,n),M()(this,Ya,[B()(this,Qa)])}return T()(e,[{key:"unblock",value:function(){M()(this,$a,!1)}},{key:"cleanStack",value:function(){M()(this,Ya,[]);var e=this.getCurrentStatus();this.sendStatus({status:e.key})}},{key:"refreshStatus",value:function(){var e=this.getCurrentStatus();this.sendStatus({status:e.key,statusMessage:e.info})}},{key:"getCurrentStatus",value:function(){return B()(this,Ya).length?B()(this,Ya)[0]:B()(this,Qa)}},{key:"addStatus",value:function(e){if(!B()(this,$a)){"error"===e.status&&Se(Po,B()(this,Za));var r=this.getStatusData(e.status);if("unexpected"!==r.info){var n={key:e.status,priority:r.priority,info:r.info},t=B()(this,Ya).findIndex((function(e){return e.key===n.key}));if(t<0)return B()(this,Ya).push(n),B()(this,Ya).sort((function(e,r){return e.priority-r.priority})),void this.sendStatus(e);B()(this,Ya)[t]=n,B()(this,Ya).sort((function(e,r){return e.priority-r.priority})),this.sendStatus(e)}else console.log("error adding status, unexpected status")}}},{key:"removeStatus",value:function(e){var r=B()(this,Ya).find((function(r){return r.key===e.status}));r&&(M()(this,Ya,B()(this,Ya).filter((function(e){return e.key!==r.key})).sort((function(e,r){return e.priority-r.priority}))),this.sendStatus({status:""}))}},{key:"sendStatus",value:function(e){if(!B()(this,$a)){"error"===e.status&&M()(this,$a,!0);var r=this.getCurrentStatus();if(e.startProfileTimestamp&&["running","error"].includes(e.status)){var n,t,a,o,i=Qr().utc().valueOf()-e.startProfileTimestamp;console.log(i,"time");var s,u="error"===e.status?"error":"success",c=null===(n=e.errorMessage)||void 0===n?void 0:n.replace(",",""),l={type:"profile-loading",status:u,profile:B()(this,Za),time:i,os:B()(this,eo).userOs,message:c||e.statusMessage,mode:null===(t=e.profileOptions)||void 0===t?void 0:t.startMode,timings:e.timings,proxyMode:null===(a=e.profileOptions)||void 0===a?void 0:a.proxyMode,appVersion:w.i8};if(null!==(o=e.profileOptions)&&void 0!==o&&o.proxyCountry)l.proxyCountry=null===(s=e.profileOptions)||void 0===s?void 0:s.proxyCountry;ve({method:"POST",url:"".concat(B()(this,eo).apiBaseUrl,"/analytics"),body:l}).catch((function(){console.log("error sending profile-loading analytics")}))}try{B()(this,Xa).sender.send("update-profile-status",{status:r.info,message:e.statusMessage||e.errorMessage||r.info,profileId:B()(this,Za)})}catch(e){console.log("channel send error:",e)}}}},{key:"getStatusData",value:function(e){var r={error:{info:"profileStatuses.error"},cloud_uploading:{info:"profileStatuses.cloudUploading"},archiving:{info:"profileStatuses.archiving"},syncing:{info:"profileStatuses.syncing"},running:{info:"profileStatuses.running"},checking_proxy:{info:"profileStatuses.checkingProxy"},downloading_profile_init:{info:"profileStatuses.downloadingProfile"},downloading_profile_chrome_ext:{info:"profileStatuses.downloadingChromeExtension"},downloading_profile_user_ext:{info:"profileStatuses.downloadingUserExtensions"},downloading_profile_fonts:{info:"profileStatuses.downloadingFonts"},preparing_profile:{info:"profileStatuses.preparingProfile"},ready:{info:"profileStatuses.ready"}},n=Object.keys(r).indexOf(e);return n<0?{key:e,priority:1e4,info:"unexpected"}:{key:e,priority:n,info:r[e].info}}}]),e}();const no=require("net");var to=n.n(no);const ao=require("@babel/runtime/helpers/typeof");var oo=n.n(ao);const io=require("hpagent"),so=require("socks-proxy-agent");var uo=12e3,co=new me.CommonDataManager,lo=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k,y,x,S,_,T,P,E,C=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=C.length>1&&void 0!==C[1]?C[1]:2,a={},i=n.username,u=n.password,c=n.mode,l=void 0===c?"":c,f=n.host,p=void 0===f?"":f,m=n.port,d=void 0===m?"":m,h=n.type,v=h,h.includes("socks")&&(v="socks"),(p=p.trim().replace(" ","")).includes(".")&&(g=p.split(":"),b=r()(g,1),p=b[0]),(d=d.toString().trim()).includes(":")&&(w=d.split(":"),k=r()(w,2),d=k[1]),y=l.includes("gologin"),x="tor"===l,S="".concat(v,"://"),i&&u&&(S+="".concat(encodeURIComponent(i),":").concat(encodeURIComponent(u),"@")),S+="".concat(p,":").concat(d),y||x||console.log("proxyString:",S,"host:",p,"port:",d),o=S.startsWith("http")?fo(S):new so.SocksProxyAgent(S),_="https://api.gologin.com/timezone",T={Authorization:"Bearer ".concat(co.accessToken),"user-agent":co.userAgent,"x-two-factor-token":co.twoFaKey||""},(y||x)&&(_="https://time.gologin.com/timezone",T={}),P=s().mark((function e(){var r,n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=pe()(_,{agent:{https:o},headers:T}),t=setTimeout((function(){return n.cancel()}),uo),e.next=4,n.json().catch((function(e){return e.message}));case 4:if(a=e.sent,clearTimeout(t),"socket hang up"!==a||!S.startsWith("http://")){e.next=10;break}return h="https",o=fo(S.replace("http://","https://")),e.abrupt("return","continue");case 10:if(null===(r=a)||void 0===r||!r.ip){e.next=12;break}return e.abrupt("return",{v:{response:a,protocol:h}});case 12:case"end":return e.stop()}}),e)}));case 21:if(!t--){e.next=30;break}return e.delegateYield(P(),"t0",23);case 23:if("continue"!==(E=e.t0)){e.next=26;break}return e.abrupt("continue",21);case 26:if("object"!==oo()(E)){e.next=28;break}return e.abrupt("return",E.v);case 28:e.next=21;break;case 30:return(0,be.oj)({message:a,level:"warning",transactionName:"check-proxy-response",tags:[["proxy-mode",l]]}),e.abrupt("return",{response:a,protocol:h});case 32:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),fo=function(e){return new io.HttpsProxyAgent({keepAlive:!0,keepAliveMsecs:1e3,maxSockets:256,maxFreeSockets:256,scheduling:"lifo",proxy:e})},po=function(){function e(){S()(this,e)}var r,n;return T()(e,null,[{key:"checkProxy",value:(n=o()(s().mark((function r(n){var t,a,o,i,u,c,l,f,p,m,d,h,v,g,b,w,k,y=arguments;return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t=y.length>1&&void 0!==y[1]&&y[1],a="fail",o="",i="",u="",c="",l="",f="",p="",m=n.username,d=void 0===m?"":m,h=n.password,v=void 0===h?"":h,g=n.host,d&&v||!g.includes("floppydata.com")){r.next=12;break}return r.abrupt("return",{status:"fail",error:"profileStatusMessages.invalidProxy"});case 12:if(!(n.port<0||n.port>65535)){r.next=14;break}return r.abrupt("return",{status:"fail",error:"notifications.error.invalidPort"});case 14:if(!t){r.next=18;break}return r.next=17,this.getPing(n);case 17:p=r.sent;case 18:if("Check timeout exceeded"!==p){r.next=20;break}return r.abrupt("return",{status:"fail",error:"notifications.error.timeoutExceeded"});case 20:return r.next=22,lo(n).catch((function(r){var n=r instanceof Error?r.message:r;return(0,be.oj)({message:n,transactionName:"check-proxy",tags:[["scenario","check-proxy"]]}),f=e.getFormattedError(r),{response:{},status:"fail",error:"profileStatusMessages.invalidProxy"}}));case 22:if(b=r.sent,w=b.response,!Object.prototype.hasOwnProperty.call(w,"status")){r.next=26;break}return r.abrupt("return",{status:a,origin:o,country:i,timezone:u,languages:c,city:l,ping:p,error:f||"notifications.error.proxyError"});case 26:return!(k=w).ip&&k.statusCode&&k.statusCode.toString().startsWith("4")&&(f=e.getFormattedError(w)),k.toString().toLowerCase().includes("access denied")?f="notifications.error.proxyAuthError":(o=k.ip||"",i=k.country||"",u=k.timezone||"",c=k.languages||"",l=k.city||"",a=o&&o.length?"success":"fail"),r.abrupt("return",{status:a,origin:o,country:i,timezone:u,languages:c,city:l,ping:p,error:f||"notifications.error.proxyError"});case 30:case"end":return r.stop()}}),r,this)}))),function(e){return n.apply(this,arguments)})},{key:"getPing",value:(r=o()(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=setTimeout((function(){t.destroy(),e("Check timeout exceeded")}),1e4),t=new(to().Socket),a=process.hrtime();t.connect(r.port,r.host,(function(){clearTimeout(n);var r=process.hrtime(a),o=parseInt(((1e9*r[0]+r[1])/1e6).toString());t.destroy(),e(o)})),t.on("error",(function(){clearTimeout(n),t.destroy(),e(null)}))})));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"getFormattedError",value:function(e){return JSON.stringify(e).includes("407")?"notifications.error.proxyAuthError":"notifications.error.proxyConnectionError"}}]),e}();function mo(e,r,n){!function(e,r){if(r.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,r),r.set(e,n)}var ho=new WeakMap,vo=new WeakMap,go=new WeakMap,bo=function(){function e(r){S()(this,e),mo(this,ho,{writable:!0,value:void 0}),mo(this,vo,{writable:!0,value:!1}),mo(this,go,{writable:!0,value:void 0}),M()(this,ho,r.proxyInfo),M()(this,vo,r.proxyEnabled),M()(this,go,r.ProfileReadyCheckerInst)}var r;return T()(e,[{key:"proxyInfo",set:function(e){M()(this,ho,e)}},{key:"proxyEnabled",set:function(e){M()(this,vo,e)}},{key:"getTimeZone",value:(r=o()(s().mark((function e(r,n){var t,a,o,i,u,c,l,f,p,m,d=this;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Qr().utc(),a=B()(this,ho),o=a.mode,i=a.host,u=a.port,c=a.username,l=a.password,f={status:"error",body:"something went wrong",type:"proxy"},B()(this,vo)){e.next=6;break}return e.next=6,ve({url:"https://api.gologin.com/timezone",method:"GET"}).then((function(e){f.status="success",f.body=e,n.timeZoneCheck=Qr().utc().diff(t),B()(d,go).isProxyReady=f})).catch((function(e){console.log(e),f.status="error",f.body="notifications.error.timezoneRequestError",f.type="timezone",n.timeZoneCheck=Qr().utc().diff(t),B()(d,go).isProxyReady=f}));case 6:if(!["gologin","tor"].includes(o)){e.next=9;break}return e.next=9,wo({mode:o,profileData:r,result:f,timings:n,startTime:t,profileReadyChecker:B()(this,go)}).catch((function(e){yo({error:e,result:f,timings:n,startTime:t,profileReadyChecker:B()(d,go)})}));case 9:if(!["socks4","socks5","possh","http","geolocation"].includes(o)){e.next=18;break}return e.next=12,po.getPing(B()(this,ho));case 12:if(((p=e.sent)||0===p)&&"Check timeout exceeded"!==p){e.next=15;break}return e.abrupt("return",{status:"error",type:"proxy",body:"profilesTable.profileStatusTooltip.proxy.pingFail"});case 15:return m=["http","geolocation"].includes(o),e.next=18,lo({mode:o,type:m?"http":o,host:m?i.replace(/(http:\/\/|https:\/\/)/g,""):i,port:u,username:c,password:l}).then((function(e){var r=e.response,a=e.protocol;if(r instanceof String&&r.includes("402")&&"geolocation"===o)return f.status="error",f.body="notifications.error.proxyTrafficIsOver",f.type="proxy",n.timeZoneCheck=Qr().utc().diff(t),void(B()(d,go).isProxyReady=f);ko({timeZoneResult:r,result:f,timings:n,startTime:t,protocol:a,profileReadyChecker:B()(d,go)})})).catch((function(e){yo({error:e,result:f,timings:n,startTime:t,profileReadyChecker:B()(d,go)})}));case 18:return e.abrupt("return",f);case 19:case"end":return e.stop()}}),e,this)}))),function(e,n){return r.apply(this,arguments)})}]),e}();E()(bo,"updateProxyStatus",function(){var e=o()(s().mark((function e(r,n){var t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if("string"!=typeof n.body){e.next=6;break}return t={_id:r,status:!1,error:n.body,checkDate:Qr()().unix()},ot([t]),e.abrupt("return");case 6:a=n.body,o={_id:r,status:"success"===n.status,country:a.country,city:a.city,error:"success"!==n.status?n.status:null,checkDate:Qr()().unix(),languages:a.languages,timezone:a.timezone,lastIp:a.ip||""},ot([o]);case 9:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}());var wo=function(){var e=o()(s().mark((function e(n){var t,a,o,i,u,c,l,f,p,m,d;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.profileData,a=(void 0===t?{autoProxyServer:""}:t).autoProxyServer.split("://"),o=r()(a,1),i=o[0],u=void 0===i?"http":i,c=a[1].split(":"),l=r()(c,2),f=l[0],p=l[1],m={mode:n.mode,type:u,host:f,port:Number(p),username:n.profileData.autoProxyUsername,password:n.profileData.autoProxyPassword},e.next=7,po.getPing(m);case 7:if(((d=e.sent)||0===d)&&"Check timeout exceeded"!==d){e.next=10;break}throw new Error("profilesTable.profileStatusTooltip.proxy.pingFail");case 10:return e.next=12,lo(m).then((function(e){var r=e.response,t=e.protocol;if("string"==typeof r)throw new Error(r);n.profileData.gologin.proxy.username=n.profileData.autoProxyUsername,n.profileData.gologin.proxy.password=n.profileData.autoProxyPassword,n.result.status="success",n.result.protocol=t,n.result.body=r,n.timings.timeZoneCheck=Qr().utc().diff(n.startTime),n.profileReadyChecker.isProxyReady=n.result})).catch((function(e){yo({error:e,result:n.result,timings:n.timings,startTime:n.startTime,profileReadyChecker:n.profileReadyChecker})}));case 12:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ko=function(e){if("string"==typeof e.timeZoneResult)throw new Error(e.timeZoneResult);e.result.status="success",e.result.protocol=e.protocol,e.result.body=e.timeZoneResult,e.timings.timeZoneCheck=Qr().utc().diff(e.startTime),e.profileReadyChecker.isProxyReady=e.result},yo=function(e){console.log(e.error),e.result.status="error",e.result.body=e.error instanceof Error?e.error.message:"notifications.error.somethingWentWrong",e.result.type="proxy",e.timings.timeZoneCheck=Qr().utc().diff(e.startTime),e.profileReadyChecker.isProxyReady=e.result},xo=function(){var e=o()(s().mark((function e(r,n,t){var a,o,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.bookmark_bar){e.next=2;break}return e.abrupt("return",n);case 2:return e.next=4,(0,A.readFile)(t,"utf8").catch((function(e){var n=e instanceof Error?e.message:e;return"string"==typeof n&&n.includes("ENOENT")||(0,be.oj)({message:n,transactionName:"read-bookmarks-before-profile-start",tags:[["scenario","read-bookmarks"],["profileId",r]]}),""}));case 4:if(a=e.sent){e.next=7;break}return e.abrupt("return",Ia.roots);case 7:try{o=JSON.parse(a),n=o.roots}catch(e){n=Ia.roots,i=e instanceof Error?e.message:e,(0,be.oj)({message:i,transactionName:"parse-bookmarks-before-profile-start",tags:[["scenario","parse-bookmarks"],["profileId",r]]})}return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})));return function(r,n,t){return e.apply(this,arguments)}}();function So(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function _o(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?So(Object(n),!0).forEach((function(r){E()(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):So(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}var To={},Po=[],Eo=[],Co={},Mo=(0,j.IT)(),No=process.platform,Bo=new sr,Io=new Zr,Oo=new me.CommonDataManager,Ao=new en,jo=new Mt,Lo={};jo.init(Mo,Oo.apiBaseUrl),Io.init().catch((function(){return null})),Ao.init().catch((function(){return null}));var Ro=[],Do=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m,d,h;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.profileId,t=r.iconBase64,void 0===t?"":t,a=r.channel,o=r.remoteApiOptions,i=r.proxyInfo,u=void 0===i?{}:i,c=r.proxyEnabled,l=void 0!==c&&c,f=r.automation,p=void 0===f?{workflowId:""}:f,m=r.launchViaRestApi,d=void 0!==m&&m,console.log("load profile start",n),!Object.prototype.hasOwnProperty.call(To,n)){e.next=5;break}return e.abrupt("return");case 5:return h=new ro(a,n),e.abrupt("return",Fo({profileId:n,channel:a,remoteApiOptions:o,proxyInfo:u,proxyEnabled:l,ProfileStatusManagerInst:h,automation:p,launchViaRestApi:d}).catch((function(e){console.log(e);var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,tags:[["scenario","run-profile"],["profileId",n]],transactionName:"profile-prepare-error",level:"fatal"}),h.addStatus({status:"error",errorMessage:"profileStatusMessages.prepareProfileError"})})));case 7:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Fo=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,d,h,v,g,b,w,k,y,x,S,_,T,P,E,C,M,N,B,I,O,j,L,R,D,F,G,U,z;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.profileId,t=r.iconBase64,a=void 0===t?"":t,o=r.channel,i=r.remoteApiOptions,u=r.proxyInfo,c=void 0===u?{}:u,l=r.proxyEnabled,f=void 0!==l&&l,p=r.ProfileStatusManagerInst,d=r.automation,h=r.launchViaRestApi,g=(v=i||{}).cb,b=v.sync,24===n.length){e.next=5;break}return g&&g(null,{status:400,message:"invalid profile id"}),e.abrupt("return","error");case 5:if(w=Qr().utc().valueOf(),k=new(gr()),y=new Va(k),x=new bo({proxyInfo:c,proxyEnabled:f,ProfileReadyCheckerInst:y}),Lo[n]=p,!Po.includes(n)&&!Eo.includes(n)){e.next=13;break}return p.addStatus({status:"error",statusMessage:"Profile is still syncing"}),e.abrupt("return","error");case 13:if(Po.push(n),S=m.startTransaction({name:"run-profile"})||Cr,_=S.startChild({op:"request-profile-from-db"}),T=S.startChild({op:"check-proxy"}),P={},E=Qr().utc(),C=process.arch,!["x32","ia32"].includes(C)){e.next=24;break}return(0,be.oj)({message:"32-bit operating system",tags:[["scenario","run-profile"],["is-32-bit",!0]],transactionName:"open-orbita-32-bit-system",level:"warning"}),p.addStatus({status:"error",statusMessage:"profileStatusMessages.32bitError"}),e.abrupt("return","error");case 24:if(p.addStatus({status:"downloading_profile_init"}),f&&p.addStatus({status:"checking_proxy"}),M=["gologin","tor"].includes(c.mode||""),S.tags=_o(_o({},S.tags),{},{"proxy-mode":c.mode,profileId:n}),M||h||x.getTimeZone({},P).then((function(e){"error"===e.status&&Ho(e,p,w)})).finally((function(){T.finish(),p.removeStatus({status:"checking_proxy"})})),!Co[n]){e.next=33;break}return delete Co[n],g&&g(null,{status:403,message:"Profiles is not stopped yet"}),e.abrupt("return",null);case 33:return e.next=35,at(n).catch((function(e){var r,t="backend@error::",a=e instanceof Error?e.message:e,o="profileStatusMessages.profileRequestError",i=!0;"string"==typeof a&&a.includes("429")&&(o="profileStatusMessages.tooManyRequestsError"),"string"==typeof a&&a.includes("404")&&(o="profileStatusMessages.profileDeleted",i=!1),"string"==typeof a&&a.includes("402")&&(o="profileStatusMessages.paymentRequired"),"string"==typeof a&&a.includes("403")&&(o="profileStatusMessages.noRights",i=!1),i&&(0,be.zd)({message:a,tags:[["scenario","run-profile"],["profileId",n],["name","request-profile-from-db"]],transactionName:"request-profile-from-db"});var s=(null===(r=e.response)||void 0===r?void 0:r.body)||"";s.includes(t)&&(o=s.replace(t,"").slice(1,-1));return p.addStatus({status:"error",statusMessage:o}),g&&g(null,{status:403,message:"Error in getting profile info"}),S.setStatus("aborted"),S.finish(),"error"}));case 35:if("string"!=typeof(N=e.sent)){e.next=40;break}return S.setStatus("aborted"),S.finish(),e.abrupt("return","error");case 40:if(B=N.canBeRunning,void 0!==B&&B){e.next=45;break}return g&&g(null,{status:403,message:"Profile is already running"}),p.addStatus({status:"error",statusMessage:"notifications.error.runByAnotherUser"}),e.abrupt("return","cantBeRunning");case 45:if((new Fe).checkOrbitaWinCompatible({key:"userAgent",value:N.navigator.userAgent,ProfileStatusManagerInst:p})){e.next=49;break}return(0,be.oj)({message:"windows version is not supported",tags:[["scenario","run-profile"]],transactionName:"orbita-compatibility-with-windows-error"}),e.abrupt("return","error");case 49:return _.finish(),P.profileRequest=Qr().utc().diff(E),I=N.chromeExtensions&&N.chromeExtensions.includes(ue),d.workflowId&&(O=ze().generateKeyPairSync("rsa",{modulusLength:2048,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}}).publicKey.concat().split("\n").join("").replace("-----BEGIN PUBLIC KEY-----","").replace("-----END PUBLIC KEY-----",""),j=st(O),d.publicKey=O,d.extensionId=j),e.next=55,jo.prepareProfileToLaunch({profileFingerprint:N,profileId:n,iconBase64:a,automation:d});case 55:return L=e.sent,h&&(R=["gologin","tor","socks4","socks5","possh","http","geolocation"],D=["gologin","tor"].includes(L.proxy.mode||""),(F=R.includes(L.proxy.mode||""))&&p.addStatus({status:"checking_proxy"}),x.proxyInfo=L.proxy,x.proxyEnabled=F,x.getTimeZone(D?L:{},P).then((function(e){"error"===e.status&&Ho(e,p,w)})).finally((function(){T.finish(),p.removeStatus({status:"checking_proxy"})}))),G=S.startChild({op:"check-proxy"}),M&&!h&&x.getTimeZone(L,P).then((function(e){"error"===e.status&&Ho(e,p,w)})).finally((function(){G.finish(),p.removeStatus({status:"checking_proxy"})})),U=[Mo.PROFILES_DIR,Mo.START_DIR_PATH,Mo.STARTED_DIR_PATH],z=U.map((function(e){return(0,A.access)(e).then(Promise.resolve).catch((function(){return(0,A.mkdir)(e,{recursive:!0})}))})),e.next=63,Promise.all(z).catch((function(e){var r=e instanceof Error?e.message:e;console.log("Error in working folder init:",r||"no error"),(0,be.oj)({message:r,tags:[["scenario","run-profile"],["profileId",n]],transactionName:"profile-folder-init-error",level:"warning"})}));case 63:return!b&&g&&g(null,null),e.abrupt("return",zo({profileData:L,channel:o,startProfileTimestamp:w,remoteApiOptions:i,ProfileReadyCheckerInst:y,timings:P,startProfileTransactionSentry:S,ProfileStatusManagerInst:p,automation:_o(_o({},d),{},{isAutomationExtensionSavedInDb:I})}));case 65:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();function Go(e){Co[e]=!0;try{var r,n;if(e in To)if(delete Co[e],"win32"===No)rt(null===(n=To[e].orbitaProc)||void 0===n?void 0:n.pid).then((function(e){e&&(0,rn.exec)("taskkill /pid ".concat(e))})).catch((function(r){var n=r instanceof Error?r.message:r;console.log(1,e,To),(0,be.zd)({message:n,tags:[["scenario","close-profile"],["profileId",e],["name","kill-orbita-process-error"]],transactionName:"kill-orbita-process-error"})}));else if(null!==(r=To[e].orbitaProc)&&void 0!==r&&r.pid){var t;on()(null===(t=To[e].orbitaProc)||void 0===t?void 0:t.pid,"SIGTERM")}}catch(r){var a=r instanceof Error?r.message:r;console.log(1,e,To),(0,be.zd)({message:a,tags:[["scenario","close-profile"],["profileId",e],["name","kill-orbita-process-error"]],transactionName:"kill-orbita-process-error"})}}var Uo=function(){var e=o()(s().mark((function e(){var r,n,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n in r=[],To)r.push(n),To[n]&&on()(null===(t=To[n].orbitaProc)||void 0===t?void 0:t.pid,"SIGTERM"),console.log("process",n,"has been stopped");return a=r.map((function(e){return ve({url:"".concat(Oo.apiBaseUrl,"/browser/").concat(e,"/run-sync"),method:"PATCH",body:{running:!1}})})),e.next=5,Promise.all(a).catch((function(){return null}));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),zo=function(){var e=o()(s().mark((function e(n){var t,a,i,c,l,f,p,m,d,h,v,g,b,w,k,y,x,S,_,T,P,E,C,M,N,B,I,O,L,R,D,F,G,U,z,K,H,W,q,V,J,X,Z,Y,$,Q,ee,re,ne,te,ae,oe,ie,se,ce,le,fe,pe,me,de,he,ve,ge,we,ke,ye,xe,Se,_e,Te,Pe,Ee,Ce,Me,Ne,Be,Ie,Oe,Ae,je,Le,Re,De;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.profileData,i=n.channel,c=n.startProfileTimestamp,l=n.remoteApiOptions,f=n.ProfileReadyCheckerInst,p=n.timings,m=n.startProfileTransactionSentry,d=void 0===m?Cr:m,h=n.ProfileStatusManagerInst,v=n.automation,g=a.profileId,b=a.s3Path,w=a.s3Date,k=a.owner,y=a.fonts,x=a.os,S=a.s3SignedUrl,_=a.useCookiesExt,T=a.vaultToken,E=(P=l||{}).cb,C=P.debuggingPort,M=void 0===C?null:C,N=(null===(t=a.gologin)||void 0===t?void 0:t.name)||"",B=(new Date).getMilliseconds(),I=Mo.PROFILES_DIR+g,O=["linux","win32","darwin"].includes(No),L=(Oo.userAgent||"").includes("Windows NT 6.1"),R=y.families||[],!(D=O&&y.enableMasking&&!L)||R.length){e.next=18;break}return(0,be.oj)({message:"No fonts list provided. Please select at least 1",transactionName:"prepare-fonts-not-provided",level:"fatal",tags:[["scenario","run-profile"],["profileId",g]]}),F="profileStatusMessages.noFontsProvided",h.addStatus({status:"error",statusMessage:F,startProfileTimestamp:c}),d.setStatus("aborted"),d.finish(),E&&E(null,{status:403,message:F}),e.abrupt("return","error");case 18:return G={},U="".concat(Mo.PROFILES_DIR).concat(g,"_").concat(B,".zip"),z={profileId:g,currentMs:B,s3Path:b,s3Date:w,startProfileTimestamp:c,zipPath:U,s3SignedUrl:S,profileOptions:G,ProfileStatusManagerInst:h,startProfileTransactionSentry:d},e.next=23,Da({timings:p,remoteCb:E,profilePath:I,getProfileArchiveOptions:z});case 23:if("error"!==e.sent){e.next=28;break}return d.setStatus("aborted"),d.finish(),e.abrupt("return","error");case 28:return K=[jo.checkTempFiles(g,d).catch((function(){})),jo.removeUselessFolders(g,x,d).catch((function(){}))],H=a.cookies||{checkCookies:a.checkCookies},K.push(jo.prepareCookies(g,H,d).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"cookies-global-error",level:"error",tags:[["scenario","run-profile"],["profileId",g]]})}))),W=['--user-data-dir="'.concat(I,'"'),"--disable-encryption","--donut-pie=".concat(a.gologin.hashValues)],M&&W.push("--remote-debugging-port=".concat(M)),q="--font-masking-mode=1",D&&(q="--font-masking-mode=2",(V="android"!==x&&("win32"===No&&"win"!==x||"darwin"===No&&"mac"!==x||"linux"===No&&"lin"!==x))&&(q="--font-masking-mode=3"),h.addStatus({status:"downloading_profile_fonts"}),K.push(Bo.composeFonts({fontsList:R,profilePath:I,differentOs:V,startProfileTransactionSentry:d}).catch((function(e){var r=e instanceof Error?e.message:e,n="profileStatusMessages.fontsError",t="fatal",a="prepare-fonts";return"string"==typeof r&&r.includes("ENOSPC")&&(n="profileStatusMessages.discSpaceError",t="warning",a="no-disc-space"),(0,be.oj)({message:r,transactionName:a,level:t,tags:[["scenario","run-profile"],["profileId",g]]}),{isError:!0,type:"fonts-error",error:e,errorTxt:n}})).finally((function(){return h.removeStatus({status:"downloading_profile_fonts"})})))),W.push(q),K.push(jo.prepareGologinExts({name:N,profileId:g,owner:k,useCookiesExt:_,vaultToken:T,startProfileTransactionSentry:d})),J=a.chromeExtensions||[],X=a.userChromeExtensions||[],d.tags=_o(_o({},d.tags),{},{"extensions-count":J.length+X.length}),Z=d.startChild({op:"download-chrome-extensions"}),J.length&&(h.addStatus({status:"downloading_profile_chrome_ext"}),K.push(Io.checkChromeExtensions(J).then(function(){var e=o()(s().mark((function e(r){var n,t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=r.find((function(e){return e.includes(ue)})))){e.next=10;break}t=d.startChild({op:"modify-automation-chrome-extension"}),a=u.join(n,"manifest.json"),v.publicKey&&(Ba.key=v.publicKey);try{o=JSON.stringify(Ba)}catch(e){console.error("Automation error: replacing manifest.json",e),t.setStatus("aborted")}if(!o){e.next=9;break}return e.next=9,(0,A.writeFile)(a,o,{mode:438}).catch((function(e){console.error("Automation: ERROR while replacing manifest.json",e),(0,be.oj)({message:e.message,transactionName:"automation-error",level:"error",tags:[["scenario","run-profile"],["profileId",g]]})}));case 9:t.finish();case 10:return e.abrupt("return",{profileExtensionsCheckRes:r});case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.oj)({message:r,transactionName:"check-chrome-extensions-at-profile-start",level:"error",tags:[["scenario","run-profile"],["profileId",g]]}),console.error("checkChromeExtensions error: ",e),{profileExtensionsCheckRes:[]}})).finally((function(){Z.finish(),h.removeStatus({status:"downloading_profile_chrome_ext"})})))),Y=d.startChild({op:"download-user-extensions"}),X.length&&(h.addStatus({status:"downloading_profile_user_ext"}),K.push(Io.checkLocalUserChromeExtensions(X,g).then((function(e){return{profileUserExtensionsCheckRes:e}})).catch((function(e){var r=e instanceof Error?e.message:e;return(0,be.oj)({message:r,transactionName:"check-user-extensions-error",level:"error",tags:[["scenario","run-profile"],["profileId",g]]}),[]})).finally((function(){Y.finish(),h.removeStatus({status:"downloading_profile_user_ext"})})))),$=j.xL.replace("{profileId}",g)+"Preferences",Q=j.xL.replace("{profileId}",g)+"Bookmarks",K.push((0,A.access)($).catch((function(){return(0,A.writeFile)($,JSON.stringify(Tt),{mode:438}).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,transactionName:"write-preferences-before-profile-start",tags:[["scenario","write-preferences"],["profileId",g]]})}))}))),ee=a.bookmarks,re=void 0===ee?{bookmark_bar:null}:ee,K.push(xo(g,re,Q).then((function(e){re=e;var r=_o(_o({},Ia),{},{roots:re});return(0,A.writeFile)(Q,JSON.stringify(r),{mode:438})})).catch((function(){}))),a.chromeExtensions=[],ne=Qr().utc(),e.next=53,Promise.all(K);case 53:if(te=e.sent.flat().filter(Boolean),p.promises=Qr().utc().diff(ne),!(ae=te.find((function(e){return Object.prototype.hasOwnProperty.call(e,"isError")})))){e.next=63;break}return oe=ae.errorTxt,ie=void 0===oe?"":oe,d.setStatus("aborted"),d.finish(),h.addStatus({status:"error",statusMessage:ie,startProfileTimestamp:c,profileOptions:G}),E&&E(null,{status:403,message:ie}),e.abrupt("return","error");case 63:return se="--load-extension=",a.extensionsEnabled||(se="--disable-extensions-except="),ce=te.find((function(e){return"profileGologinExtensionPath"in e})),le=(null==ce?void 0:ce.profileGologinExtensionPath)||"",fe=(null==ce?void 0:ce.passwordsTemporaryToken)||"",W.push("".concat(se,'"').concat(le,'"')),a.debugMode&&("win32"===No?W.push("--enable-logging=stderr"):W.push("--enable-logging"),W.push("--v=1"),W.push("--vmodule=metrics=2"),W.push("--no-sandbox")),pe=a.webglParams,a.gologin.webgl.metadata.mode?pe&&"webgl"===pe.glCanvas&&W.push("--disable-webgl2"):(W.push("--disable-webgl"),W.push("--disable-webgl2")),pe&&Object.prototype.hasOwnProperty.call(pe,"antialiasing")&&!pe.antialiasing&&W.push("--webgl-antialiasing-mode=none"),!a.session||null!=v&&v.workflowId||W.push("--restore-last-session"),me=a.autoProxyServer,de=a.proxy,he=de.mode,ve=void 0===he?"none":he,ge=de.host,we=void 0===ge?"":ge,ke=de.port,ye=void 0===ke?80:ke,xe=ve.toLowerCase(),a.proxyEnabled&&(Se=["gologin","tor"].includes(xe)?me:we,_e="","http"===xe&&(_e="http://"),"socks4"===xe&&(_e="socks4://"),"socks5"===xe&&(_e="socks5://"),Se.includes("http://")&&(Te=Se.split("http://"),Pe=r()(Te,2),Se=Pe[1],_e="http://"),Se.includes("https://")&&(Ee=Se.split("https://"),Ce=r()(Ee,2),Se=Ce[1],_e="https://"),Se.includes("socks5://")&&(Me=Se.split("socks5://"),Ne=r()(Me,2),Se=Ne[1],_e="socks5://"),Se.includes("socks4://")&&(Be=Se.split("socks4://"),Ie=r()(Be,2),Se=Ie[1],_e="socks4://"),["gologin","tor"].includes(xe)?(console.log("autoProxyServer",me),Oe=me.split("://"),Ae=Oe[1].split(":"),je=r()(Ae,2),Le=je[0],Re=je[1],W.push("--proxy-server=".concat(Le,":").concat(Re)),_e.includes("socks4")||W.push('--host-resolver-rules="MAP * 0.0.0.0 , EXCLUDE '.concat(Le,'"'))):(W.push("--proxy-server=".concat(_e).concat(Se,":").concat(+ye)),_e.includes("socks4")||W.push('--host-resolver-rules="MAP * 0.0.0.0 , EXCLUDE '.concat(Se,'"')))),(De=f.eventEmitter).on("profile-ready",function(){var e=o()(s().mark((function e(r){var n,t,o,u,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.proxyEnabled&&bo.updateProxyStatus(a.proxy.id||"",r),"string"!=typeof r.body){e.next=7;break}return"Promise was canceled"===(n="error"===r.status?r.body:"notifications.error.timezoneRequestError")&&(n="profilesTable.error.proxyNonfunctional"),h.addStatus({status:"error",statusMessage:n,startProfileTimestamp:c,profileOptions:G}),E&&E(null,{status:403,message:n}),e.abrupt("return","error");case 7:"https"===r.protocol&&(t=W.findIndex((function(e){return e.startsWith("--proxy-server")})),W[t]=W[t].replace("http://","https://")),o="darwin"===No,u=qo(a,r.body),l=o?"en-US":u,W.push("--lang=".concat(l)),console.log("args:",W),Ea({timezoneCheckResult:r.body,startProfileTimestamp:c,profileOptions:G,remoteCb:E,profileData:a,automation:v,args:W,channel:i,passwordsTemporaryToken:fe,currentMs:B,ProfileReadyEventEmitterInst:De,profilePreparingRes:te,timings:p,startProfileTransactionSentry:d,ProfileStatusManagerInst:h,ProfileStatusManagerInstances:Lo}).catch((function(e){var r=e instanceof Error?e.message:e,n="profileStatusMessages.prepareProfileError";"No installed Orbita"===r&&(n="profileStatusMessages.noOrbita"),(0,be.oj)({message:r,tags:[["scenario","run-profile"],["profileId",g]],transactionName:"prepare-orbita-launch-error",level:"fatal"}),d.setStatus("aborted"),d.finish(),h.addStatus({status:"error",statusMessage:n})}));case 14:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),f.isProfilePrepared=!0,e.abrupt("return","success");case 83:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Ko=function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f,p,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.profileId,t=r.channel,a=r.onlyUpload,o=void 0!==a&&a,(i=Lo[n])||(i=new ro(t,n),Lo[n]=i),u=o?"cloud_uploading":"archiving",i.addStatus({status:u}),i.unblock(),i.removeStatus({status:"error"}),e.next=9,Ut({profileId:n,channel:t,onlyUpload:o,ProfileStatusManagerInst:i}).catch((function(e){console.log(e);var r=e instanceof Error?e.message:JSON.stringify(e);"archiving profile error"!==r&&(0,be.oj)({message:r,transactionName:"sync-process-status-error",level:"fatal",tags:[["scenario","close-profile"],["profileId",n]]})}));case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0={};case 12:if(c=e.t0,l=c.s3SignedUrl,f=void 0===l?{url:""}:l,p=c.profileArchiveBuffer,m=c.stopProfileTransactionSentry,p){e.next=21;break}return console.log("error, no buffer (sync)"),i.addStatus({status:"error",statusMessage:"Archive with profile not found, synchronization is not possible"}),e.abrupt("return");case 21:return e.next=23,Kt({profileId:n,s3SignedUrl:f,profileArchiveBuffer:p,ProfileStatusManagerInst:i,ProfileStatusManagerInstances:Lo,stopProfileTransactionSentry:m});case 23:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Ho=function(e,r,n){var t=Wo(e.body);"timezone"!==e.type?"proxy"!==e.type?r.addStatus({status:"error",statusMessage:{errorType:"notifications.error.somethingWentWrong",errorMessage:t,prefix:"proxy"},startProfileTimestamp:n}):r.addStatus({status:"error",statusMessage:{errorType:"notifications.error.proxyError",errorMessage:t,prefix:"proxy"},startProfileTimestamp:n}):r.addStatus({status:"error",statusMessage:{errorType:"notifications.error.timezoneRequestError",errorMessage:"error",prefix:"timezone"},startProfileTimestamp:n})},Wo=function(e){return!0==("Promise was canceled"===e)?"profilesTable.error.proxyNonfunctional":e},qo=function(e,n){if(!e.autoLang)return Vo(e);var t="",a=n||{},o=a.country,i=void 0===o?"":o,s=a.languages;if(s){var u=s.split(","),c=r()(u,1)[0];t="".concat(c,"-").concat(i)||"";var l=[],f=t.split("-"),p=r()(f,2),m=p[0],d=void 0===m?"":m,h=p[1],v=void 0===h?"":h;v&&l.push([d,v].join("-")),l.push(d,"en-US","en"),l=y()(new Set(l));var g=[],b=l.reduce((function(e,r,n){if(!n)return e+="".concat(r,","),g.push(r),e;var t=10-n;if(t>0){var a=l.length-n<2?"":",";g.push(r),e+="".concat(r,";q=").concat(Number(.1*t).toFixed(1)).concat(a)}return e}),""),w=l,k=r()(w,1);return e.browserLang=k[0],e.gologin.languages=g.join(","),e.gologin.langHeader=b,e.browserLang}return Vo(e)},Vo=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";return e.gologin.langHeader?e.browserLang:(e.browserLang=r,e.gologin.languages=r,e.gologin.langHeader=r,r)};const Jo=require("body-parser");var Xo=n.n(Jo);const Zo=require("cors"),Yo=require("express");var $o=n.n(Yo);const Qo=require("is-port-reachable");var ei=function(){var e=o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ri(2e4,3e4),e.next=3,Qo(r);case 3:n=e.sent;case 4:if(!n){e.next=11;break}return r=ri(2e4,3e4),e.next=8,Qo(r);case 8:n=e.sent,e.next=4;break;case 11:return e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ri=function(e,r){return e=Math.ceil(e),r=Math.floor(r),Math.floor(Math.random()*(r-e+1))+e},ni=(0,Yo.Router)(),ti=new me.CommonDataManager;ni.get("/service/check-server",(function(e,r){return console.log("check-server"),r.status(200),r.json({status:!0})})),ni.post("/service/credentials",(function(e,r){console.log("credentials");var n=e.body,t=n.access,a=void 0===t?"":t,o=n.api,i=void 0===o?"https://test-cloud-api.gologin.com":o,s=n.twoFa,u=void 0===s?"":s;return global.credentials={access:a,api:i,twoFa:u,userAgent:e.headers["user-agent"]},r.status(200),r.json({credentials:global.credentials})})),ni.post("/browser/start-profile",function(){var e=o()(s().mark((function e(r,n){var t,a,i,u,c,l,f,p;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("start-profile"),t=r.body,a=t.profileId,i=void 0===a?"":a,u=t.sync,c=void 0!==u&&u,i){e.next=4;break}return e.abrupt("return",n.status(400).send("Invalid params").end());case 4:if(l=0,!c){e.next=9;break}return e.next=8,ei();case 8:l=e.sent;case 9:return f=function(){var e=o()(s().mark((function e(r){var t,a,o,i,u,c,f,p=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=p.length>1&&void 0!==p[1]?p[1]:{})){e.next=4;break}return a=t.status,o=void 0===a?400:a,i=t.message,u=void 0===i?"":i,e.abrupt("return",n.status(o).send(u).end());case 4:if(c="",!l){e.next=10;break}return e.next=8,pe()("http://127.0.0.1:".concat(l,"/json/version")).json().catch((function(){return null}));case 8:(f=e.sent)&&(c=f.webSocketDebuggerUrl);case 10:n.status(200).json({status:"success",wsUrl:c});case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),p={cb:f,sync:c,debuggingPort:l},e.next=13,Do({profileId:i,iconBase64:"",channel:global.channel,remoteApiOptions:p,launchViaRestApi:!0}).catch((function(){return null}));case 13:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),ni.post("/browser/stop-profile",function(){var e=o()(s().mark((function e(r,n){var t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("stop-profile"),t=r.body.profileId,a=void 0===t?"":t){e.next=4;break}return e.abrupt("return",n.status(400).send("Invalid params").end());case 4:return Go(a),e.abrupt("return",n.status(204).end());case 6:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),ni.get("/cookies/:id",function(){var e=o()(s().mark((function e(r,n){var t,a,o,i,u,c,l;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("get cookies"),"true"!==(null===(t=r.query)||void 0===t?void 0:t.isAvailable)){e.next=3;break}return e.abrupt("return",n.json({status:!0}));case 3:if(null===(a=To[r.params.id])||void 0===a||!a.init){e.next=5;break}return e.abrupt("return",n.json([]));case 5:return i=null===(o=To[r.params.id])||void 0===o?void 0:o.startProfileTimestamp,e.next=8,xa({endpoint:"/browser/".concat(r.params.id,"/cookies"),method:"GET"});case 8:if(e.t0=e.sent,e.t0){e.next=11;break}e.t0=[];case 11:return u=e.t0,i&&(l=Qr().now()-i,console.log(l,"browser start"),xa({endpoint:"/analytics/compound_action_analytics",method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(ti.accessToken),"user-agent":ti.userAgent,"x-two-factor-token":ti.twoFaKey||""},body:JSON.stringify({action:"browser opened",time:l,mode:(null===(c=To[r.params.id])||void 0===c?void 0:c.startMode)||"unknown",profile:r.params.id.toString()})}).catch((function(){return null}))),To[r.params.id]&&(To[r.params.id].init=!0),e.abrupt("return",n.json(u));case 15:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),ni.post("/cookies/:id",function(){var e=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("post cookies"),e.next=3,xa({endpoint:"/browser/".concat(r.params.id,"/cookies"),method:"POST",body:r.body});case 3:return t=e.sent,e.abrupt("return",n.json(t));case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),ni.post("/cookies/:id/cookies_stats",function(){var e=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("cookies_stats"),e.next=3,xa({endpoint:"/browser/".concat(r.params.id,"/cookies/cookies_stats"),method:"POST",body:r.body});case 3:return t=e.sent,e.abrupt("return",n.json(t));case 5:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),ni.get("/session/ready",(function(e,r){return r.end()})),ni.get("/timer/update/:id",(function(e,r){return r.end()})),ni.get("/close/:id",(function(e,r){console.log("close");var n=e.params.id;try{var t;if("darwin"===process.platform)console.log("Closing browser..."),To[n]&&on()(null===(t=To[n].orbitaProc)||void 0===t?void 0:t.pid,"SIGTERM")}catch(e){console.log(n),console.log(To);var a=e instanceof Error?e.message:e;(0,be.oj)({message:a,transactionName:"kill-process-mac",tags:[["scenario","run-profile"],["profileId",n]]})}r.end()}));const ai=ni;var oi=$o()();function ii(e){return si.apply(this,arguments)}function si(){return(si=o()(s().mark((function e(r){var n,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=36912,e.next=3,Qo(n);case 3:t=e.sent;case 4:if(!t){e.next=10;break}return e.next=7,Qo(++n);case 7:t=e.sent,e.next=4;break;case 10:a=oi.listen(n,(function(){console.log("Local server started on port ".concat(n))})),r.appPort=n,a.on("error",(function(e){e.message.includes("EADDRINUSE")?ii(r):(0,be.zd)({message:e.message,transactionName:"local-server-init-error",tags:[["name","local-server-init-error"]]})}));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}oi.use(Zo({origin:/.*/,optionsSuccessStatus:200})),oi.use(Xo().json({limit:"10mb"})),oi.use(ai);var ui=n(846),ci=(0,j.IT)(),li=function(){var e=o()(s().mark((function e(r){var n,t,a,o=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]&&o[1],t=ci.DOLPHIN_DIR_PATH,a=ci.DOLPHIN_DIR_PATH+".checked",e.next=5,(0,A.access)(t).then((function(){return!0}),(function(){return!1}));case 5:if(e.sent){e.next=8;break}return e.abrupt("return");case 8:if(!n){e.next=11;break}return r&&r.webContents.send("dolphin-anty-detected"),e.abrupt("return");case 11:return e.next=13,(0,A.access)(a).then((function(){return!0}),(function(){return!1}));case 13:if(!e.sent){e.next=16;break}return e.abrupt("return");case 16:return r&&r.webContents.send("dolphin-anty-detected"),e.next=19,(0,A.mkdir)(c().dirname(a),{recursive:!0}).then((function(){return(0,A.writeFile)(a,"ok")})).catch((function(){return null}));case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();const fi=require("get-system-fonts");var pi=n.n(fi),mi=O().homedir(),di=c().join(mi,j.nI,"system-fonts.txt"),hi=function(){var e=o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.mkdir)(c().join(mi,j.nI),{recursive:!0});case 2:return e.next=4,pi()();case 4:return r=e.sent,n=r.map((function(e){return c().parse(e).base.toLowerCase().replace(/[-|\s]/g,"_")})),e.next=8,(0,A.writeFile)(di,JSON.stringify(n),{mode:438});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),vi=function(){var e=o()(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,A.access)(di).then((function(){return!0}),(function(){return!1}));case 2:if(e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:return e.next=7,(0,A.readFile)(di,"utf-8").catch((function(){return"[]"}));case 7:return r=e.sent.toString(),e.abrupt("return",JSON.parse(r));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gi=n(605),bi=L.Yu;const wi=o()(s().mark((function e(){var n,t,a,o,i,u,l,f,p,m,d,h,v,g;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"win32"!==bi){e.next=20;break}return n=O().homedir(),t=c().join(n,j.nI,"metadata"),e.next=6,(0,A.access)(t);case 6:return e.next=8,(0,A.readFile)(t,"utf-8");case 8:if(!(a=e.sent).includes("GoLogin Setup")||!/\d+\.\d+\.\d+/.test(a)){e.next=11;break}return e.abrupt("return","do_not_send_stats");case 11:if(o=a.split("_"),i=r()(o,3),i[0],u=i[1],l=i[2],f=u,l&&(f="".concat(u,".").concat(l)),!u){e.next=19;break}if(p=f.split("."),m=r()(p,2),d=m[0],h=m[1],v=null==h?void 0:h.replace(/\s.*$|\(.*$/,""),!/^\d+$/.test(d)||!/^\d+$/.test(v)){e.next=19;break}return e.abrupt("return","".concat(d,".").concat(v));case 19:return e.abrupt("return","error_template:::file_name:"+a);case 20:return e.abrupt("return","error_template:::platform:"+bi);case 23:return e.prev=23,e.t0=e.catch(0),console.log(e.t0),g=e.t0 instanceof Error?e.t0.message:e.t0,e.abrupt("return","error_template:::"+g);case 28:case"end":return e.stop()}}),e,null,[[0,23]])}))),ki=require("keytar");var yi=n.n(ki),xi=new me.CommonDataManager,Si="GoLogin",_i="temp_auth_token",Ti=function(){return Ei().catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"write-app-config-error",level:"warning",tags:[["scenario","write-app-config"]]})}))},Pi=function(){var e=o()(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,yi().getPassword(Si,_i);case 2:if(r=e.sent){e.next=5;break}return e.abrupt("return");case 5:xi.accessToken=r,yi().deletePassword(Si,_i).catch((function(){return null}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ei=function(){var e=o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",yi().setPassword(Si,_i,xi.accessToken));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ci=w.u2,Mi=w.i8,Ni=w.gN,Bi=new me.CommonDataManager,Ii="file://".concat(c().join(__dirname,"index.html")),Oi="@gologin:access_token",Ai=!1,ji=!1,Li=!1;ii(global),(0,d.addExtensionMethods)(),p.initialize();var Ri,Di,Fi,Gi=!1,Ui=(0,j.IT)();console.log("folderPaths:",Ui),global.channel=null;var zi=h.app.requestSingleInstanceLock();(0,be.j6)();var Ki=h.Menu.buildFromTemplate([{label:"Show",click:function(){var e;return null===(e=Ri)||void 0===e?void 0:e.show()}},{label:"Quit",click:function(){h.app.quit()}}]),Hi=function(){Li||ji||Ai||(Ai=!0,v.autoUpdater.checkForUpdatesAndNotify().then((function(e){e||(Ai=!1)})).catch((function(){return null})))},Wi=[{label:"GoLogin",submenu:[{label:"Quit",accelerator:"CmdOrCtrl+Q",click:function(){h.app.quit()}},{label:"Hide",accelerator:"CmdOrCtrl+W",click:function(){var e;null===(e=Ri)||void 0===e||e.hide()}}]},{label:"Edit",submenu:[{role:"undo"},{role:"redo"},{type:"separator"},{role:"cut"},{role:"copy"},{role:"paste"},{role:"selectAll"}]}];h.Menu.setApplicationMenu(h.Menu.buildFromTemplate(Wi));var qi="".concat(Ci," v").concat(Mi," ").concat(Ni),Vi=function(){var e=o()(s().mark((function e(){var r,n,t,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={windowHeight:768,windowWidth:1200,windowPosX:0,windowPosY:0,isFullScreen:!1,isMaximized:!1},e.next=3,(0,ui.qS)(r);case 3:return n=h.screen.getPrimaryDisplay(),t=n.workAreaSize.width,Ri=new h.BrowserWindow({minWidth:1024,minHeight:500,width:r.windowWidth,height:r.windowHeight,x:r.windowPosX,y:r.windowPosY,useContentSize:!0,title:qi,webPreferences:{nodeIntegration:!0,contextIsolation:!1},show:!1}),p.enable(Ri.webContents),(t<=1400||r.isMaximized)&&Ri.maximize(),Ri.setFullScreen(r.isFullScreen),Ri.show(),Ri.webContents.on("new-window",(function(e){return e.preventDefault()})),Ri.loadURL(f().format({pathname:c().join(__dirname,"index.html"),protocol:"file:",slashes:!0})),a=c().join(__dirname,"iconTemplate@5x.png"),Ri.tray=new h.Tray(h.nativeImage.createFromPath(a)),Ri.tray.setToolTip("GoLogin"),Ri.tray.setContextMenu(Ki),Ri.tray.on("double-click",(function(){var e;return null===(e=Ri)||void 0===e?void 0:e.show()})),Ri.on("close",function(){var e=o()(s().mark((function e(r){var n,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Window Close Event Detected"),!Gi){e.next=3;break}return e.abrupt("return");case 3:console.log("No update application detected"),r.preventDefault(),null!==(n=Ri)&&void 0!==n&&n.isFullScreen()?(Ri.once("leave-full-screen",(function(){var e;return null===(e=Ri)||void 0===e?void 0:e.hide()})),Ri.setFullScreen(!1)):null===(t=Ri)||void 0===t||t.hide();case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),e.next=20,(0,L.Ij)();case 20:if("win"!==e.sent){e.next=24;break}return e.next=24,Pi();case 24:h.globalShortcut.register("CmdOrCtrl+Shift+I",(function(){var e,r;(null===(e=Ri)||void 0===e?void 0:e.isFocused())&&(null===(r=Ri)||void 0===r||r.webContents.toggleDevTools())}));case 25:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ji=function(){return Ri&&Ri.removeAllListeners("close"),Ri&&Ri.close(),null};h.app.on("activate",(function(){var e;return null===(e=Ri)||void 0===e?void 0:e.show()})),h.app.on("render-process-gone",(function(e,r,n){"clean-exit"!==n.reason&&(console.log(n.reason),(0,be.oj)({message:"crash-electron-renderer",transactionName:"crash-electron-renderer",level:"fatal",tags:[["scenario","crash-electron"]]}))})),h.app.on("child-process-gone",(function(e,r){["clean-exit","killed"].includes(r.reason)||(console.log(r.reason),(0,be.oj)({message:"crash-electron-gpu",transactionName:"crash-electron-gpu",level:"fatal",tags:[["scenario","crash-electron"]]}))}));var Xi=function(){var e=o()(s().mark((function e(){var r,n,t,a,o,i,u,c,l=arguments;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=l.length>0&&void 0!==l[0]?l[0]:"").includes("gologin://o-auth")){e.next=4;break}return console.log('responseUrl does NOT include the "gologin" protocol, skipping handleOAuth()'),e.abrupt("return");case 4:if(console.log('responseUrl does include the "gologin" protocol, invoking handleOAuth()'),e.prev=5,n=new URL(r),t=n.searchParams,a=t.get("accessToken"),o=!!t.get("isNewUser"),a&&Ri){e.next=11;break}return e.abrupt("return");case 11:return i=o?"quiz":"profileList",e.next=14,Ri.webContents.executeJavaScript("\n      localStorage.setItem('".concat(Oi,"', '").concat(a,"');\n    "));case 14:u=new URL("".concat(Ii,"#/").concat(i)),Ri.loadURL(u.toString()),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),c=e.t0 instanceof Error?e.t0.message:JSON.stringify(e.t0),(0,be.oj)({message:c,transactionName:"second-instance-error",tags:[["scenario","google-oauth"]]});case 22:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(){return e.apply(this,arguments)}}();console.log("gotApplicationLock",zi),zi?(h.app.on("second-instance",function(){var e=o()(s().mark((function e(r,n,t,a){var o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.info(r,n,t,a),Ri&&(Ri.isMinimized()&&Ri.restore(),Ri.show(),Ri.focus()),o=n.at(-1),e.next=5,Xi(o);case 5:case"end":return e.stop()}}),e)})));return function(r,n,t,a){return e.apply(this,arguments)}}()),h.app.on("ready",o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(new Fe).getSupportedOrbitaVersions(Bi.apiBaseUrl).catch((function(){return null})),(new Fe).checkLocalOrbitaReleases().catch((function(){return null}));try{b().existsSync(Ui.BASE_FOLDER)&&(console.log("removing",Ui.BASE_FOLDER),b().removeSync(Ui.BASE_FOLDER))}catch(e){console.log("Error in removing base folder:",e)}(r=new Zr).init().then((function(){return r.updateExtensions()})).catch((function(){return{}})),n=new sr,Vi(),pt().catch(console.log),n.downloadFonts([],!0).catch((function(){return null})),hi().catch((function(e){return console.log("Error in checkSystemFonts:",e.message)})),Hi();case 11:case"end":return e.stop()}}),e)})))),h.app.whenReady().then((function(){var e=!1;process.defaultApp?process.argv.length>=2&&(e=h.app.setAsDefaultProtocolClient("gologin",process.execPath,[c().resolve(process.argv[1])])):e=h.app.setAsDefaultProtocolClient("gologin"),console.log("Protocol success creation:",e)}))):h.app.quit(),v.autoUpdater.on("update-downloaded",(function(){Li=!0,Ai=!1,ji=!1,Ri&&Ri.webContents.send("app-update-downloaded")})),v.autoUpdater.on("update-available",(function(){ji=!0,Ai=!1})),v.autoUpdater.on("update-not-available",(function(){Ai=!1})),h.ipcMain.handle("check-is-update-ready",(function(){Li&&Ri&&Ri.webContents.send("app-update-downloaded")})),v.autoUpdater.on("error",(function(){return null})),h.ipcMain.handle("check-dolphin-anty",(function(e,r){return li(Ri,r)})),h.ipcMain.handle("check-app-update",(function(){return Hi()})),h.ipcMain.handle("set-user",(function(e,r){var n=r.userId,t=r.isFirstSession,a=r.plan,o=r.planId;Bi.userPlanId=o,m.setTag("is-first-session",t),m.setUser({id:n}),m.setTag("plan",a)})),h.ipcMain.handle("set-global-channel",(function(e){global.channel=e})),h.ipcMain.handle("start-profile",(function(e,r){var n=r.profileId,t=r.proxyInfo,a=r.proxyEnabled,o=r.automation;return console.log("starting profile: ",n),Do({profileId:n,channel:e,proxyEnabled:a,proxyInfo:t,automation:o}).catch((function(e){m.captureException(new gi.H(e),(function(e){return e.setLevel("error"),e.setTag("scenario","run-profile"),e.setTransactionName("load-profile-error"),e.setFingerprint(["load-profile-error"]),e}))}))})),h.ipcMain.handle("retry-sync-profile",(function(e,r){var n=r.profileId,t=r.onlyUpload;return Ko({profileId:n,channel:e,onlyUpload:void 0!==t&&t}).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"sync-profile-error",tags:[["scenario","sync-profile"]]})}))})),h.ipcMain.handle("focus-orbita-window",(function(e,r){nt(r.profileId).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.oj)({message:r,transactionName:"view-button-error",tags:[["scenario","view-profile"]]})}))})),h.ipcMain.handle("send-translation-data-to-electron",(function(e,r){Di=r})),h.ipcMain.handle("send-theme-to-electron",(function(e,r){Fi=r})),h.ipcMain.handle("install-app-updates",o()(s().mark((function e(){var r,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Gi=!0,r=[Uo()],"win"===Bi.userOs&&r.push(Ti()),e.next=6,Promise.all(r);case 6:try{v.autoUpdater.quitAndInstall()}catch(e){n=e instanceof Error?e.message:JSON.stringify(e),(0,be.oj)({message:n,transactionName:"electron-update",level:"fatal",tags:[["scenario","crash-electron"]]})}case 7:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("download-chrome-extension",function(){var e=o()(s().mark((function e(n,t){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r()(t,1),o=a[0],(new Zr).checkChromeExtensions([o],!0).catch((function(e){return console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.handle("download-user-chrome-extension",function(){var e=o()(s().mark((function e(n,t){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r()(t,1),o=a[0],(new Zr).checkLocalUserChromeExtensions([o],"",!0).catch((function(e){return console.log(e)}));case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.on("set-token",(function(e,r){var n=r.token,t=r.twoFa,a=r.source;console.log("update token source:",a),function(e,r){Oo.accessToken=e,Oo.twoFaKey=r}(n,t)})),h.ipcMain.on("set-2fa",(function(e,r){r.twoFa})),h.ipcMain.on("set-useragent",(function(e,r){!function(e){Oo.userAgent=e,console.log("Useragent has been updated successfully:",e)}(r.ua)})),h.ipcMain.on("stop-profile",(function(e,r){Go(r)})),h.ipcMain.on("stop-multiple-profiles",(function(e,r){r.map((function(e){return Go(e)}))})),h.ipcMain.on("check-profiles",(function(e){!function(){for(var e=0,r=Object.keys(Lo);e<r.length;e++){var n=r[e],t=Lo[n];t&&t.refreshStatus()}}()})),h.ipcMain.on("open-link",(function(e,r){var n,t;n=r.link,t=void 0===n?"":n,tn()(t).catch((function(){return null}))})),h.ipcMain.handle("check-proxy",function(){var e=o()(s().mark((function e(r,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",po.checkProxy(n,!0));case 1:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.handle("check-cached-storage-size",(function(){var e=new en;return e.init().then((function(){return e.checkCachedStorageSize()})).catch((function(){return 0}))})),h.ipcMain.handle("clear-cached-storage",(function(){var e=new en;return e.init().then((function(){return e.clearCachedStorage()})).catch((function(){return{}}))})),h.ipcMain.handle("clear-profile-cache",(function(e,r){var n=new en;return n.init().then((function(){return n.clearProfileCache(r)})).catch((function(){return{}}))})),h.ipcMain.on("del-profile-ext-folder",(function(e,r){Ro.push(r),function(e){for(var r=[],n=function(){var n=a[t];r.push(_e({fn:function(){return b().remove(c().join(j.im,n.extName,e))}}))},t=0,a=ct;t<a.length;t++)n();Promise.all(r).catch((function(){return Promise.resolve()}))}(r)})),h.ipcMain.handle("get-app-version",(function(){return"".concat(Mi," ").concat(Ni)})),h.ipcMain.on("get-orbita-browser-version",function(){var e=o()(s().mark((function e(r){var n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(new Fe).getLocalOrbitaVersionByPath();case 2:n=e.sent,r.returnValue=n||"0.0.0";case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),h.ipcMain.handle("check-supported-orbita",function(){var e=o()(s().mark((function e(r,n){var t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.key,a=void 0===t?"orbitaMajorVersion":t,o=n.value,e.abrupt("return",(new Fe).getOrbitaVersionToDownload({key:a,value:o}));case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.handle("check-orbita-compatible",function(){var e=o()(s().mark((function e(r,n){var t,a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.key,a=void 0===t?"orbitaMajorVersion":t,o=n.value,e.abrupt("return",(new Fe).checkOrbitaWinCompatible({key:a,value:o}));case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.handle("check-orbitas-available",function(){var e=o()(s().mark((function e(r,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(new Fe).checkOrbitasAvailable(n));case 1:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.on("check-browser",(function(e){(0,A.mkdir)(j.wk,{recursive:!0}).catch(console.log).then((function(){return ma()})).then((function(e){var r=e,n=ce(r);console.log("majorChromeVersion:",n);var t=(new Fe).localOrbitaReleasesList;if(console.log("localBrowserReleases:",t),"win32"===j.iw){var a=(0,L.lZ)();if(a<10&&Number(n)>=110&&t[109])return{needDownloadNewBrowser:!1};a<10&&!t[109]&&(r="109.1.2.9",n="109")}var o=t[n];if(!t[n])return{needDownloadNewBrowser:!0};var i=c().join(j.wk,o),s=c().join(i,"chrome");return"darwin"===j.iw?s=c().join(i,"Orbita-Browser.app"):"win32"===j.iw&&(s=c().join(i,"chrome.exe")),console.log("executableFilePath:",s),_e({fn:function(){return(0,A.access)(s)},limit:3}).then((function(){return!0}),(function(){return!1})).then((function(e){return e?_e({fn:function(){return(new Fe).getLocalOrbitaVersionByPath(i)}}).then((function(e){return console.log("latestBrowserVersion:",r),console.log("currentVersion:",e),console.log("latestBrowserVersion === currentVersion:",r===e),r===e?{needDownloadNewBrowser:!1}:{needDownloadNewBrowser:!0,browserExist:!0}})):ye(c().join(i)).then((function(){return{needDownloadNewBrowser:!0}}))}))})).catch((function(e){var r=e instanceof Error?e.message:e;(0,be.zd)({message:r,transactionName:"check-orbita",tags:[["scenario","download-orbita"],["name","check-orbita"]]})})).then((function(r){return e.sender.send("check-browser",r)})).catch((function(){return e.sender.send("check-browser",{})}))})),h.ipcMain.on("download-browser",(function(e,r){ha(e,r).catch((function(e){var r=e instanceof Error?e.message:e,n="download-orbita";"notifications.error.unsupportedWinVersion"===r&&(n="download-orbita-unsupported-os"),(0,be.zd)({message:r,transactionName:n,tags:[["scenario","download-orbita"],["name","download-orbita"]]})}))})),h.ipcMain.on("close-all-profiles",(function(){return Uo()})),h.ipcMain.on("get-client-id-from-metadata",function(){var e=o()(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,wi();case 2:r.returnValue=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),h.ipcMain.on("get-system-fonts-from-file",function(){var e=o()(s().mark((function e(r){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vi().catch((function(){return[]}));case 2:r.returnValue=e.sent;case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),h.ipcMain.handle("upload-custom-extension",function(){var e=o()(s().mark((function e(r,n){var t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Zr,e.abrupt("return",t.addCustomExtension(n));case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.ipcMain.handleOnce("get-system-locale",(function(){return h.app.getLocale()||"en"})),h.ipcMain.handleOnce("check-auth-token",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bi.accessToken);case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("get-app-config",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Bi.appConfig);case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("too-many-requests",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("TOO MANY REQUESTS"));case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("redirected-to-2fa",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("REDIRECTED-TO-2FA"));case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("redirected-to-sign-up",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("REDIRECTED-TO-SIGN-UP"));case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("changed-account",o()(s().mark((function e(){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",console.log("CHANGED ACCOUNT"));case 1:case"end":return e.stop()}}),e)})))),h.ipcMain.handle("set-app-config",function(){var e=o()(s().mark((function e(r,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,ui.pI)(n);case 2:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.app.on("open-url",function(){var e=o()(s().mark((function e(r,n){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ri&&(Ri.isMinimized()&&Ri.restore(),Ri.focus()),e.next=3,Xi(n);case 3:case"end":return e.stop()}}),e)})));return function(r,n){return e.apply(this,arguments)}}()),h.app.on("before-quit",function(){var e=o()(s().mark((function e(r){var n,t,a,o,i,u,c,l,f;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],Ri&&(t.push((0,ui.$c)(Ri,Di,Fi).catch((function(){}))),t.push(Ri.webContents.session.clearCache().catch((function(){})))),Li&&t.push(Ti().catch((function(){}))),e.next=5,Promise.all(t);case 5:if(a=To||{},(null===(n=Object.keys(a))||void 0===n?void 0:n.length)||0){e.next=9;break}return e.abrupt("return",Ji());case 9:if(e.prev=9,i=(o=Di).closeAppTitle,u=o.closeAppMessage,c=o.closeAppBtnClose,l=o.closeAppBtnCancel,0!==h.dialog.showMessageBoxSync(Ri,{type:"question",buttons:[l,c],title:i,message:u,noLink:!0})){e.next=16;break}return console.log("Preventing close application"),r.preventDefault(),e.abrupt("return",null);case 16:return e.next=18,Uo();case 18:e.next=24;break;case 20:e.prev=20,e.t0=e.catch(9),f=e.t0 instanceof Error?e.t0.message:e.t0,console.log(f);case 24:return e.abrupt("return",Ji());case 25:case"end":return e.stop()}}),e,null,[[9,20]])})));return function(r){return e.apply(this,arguments)}}()),h.app.on("activate",(function(){var e;return null===(e=Ri)||void 0===e?void 0:e.show()})),h.app.on("window-all-closed",h.app.quit)})();var a=exports;for(var o in t)a[o]=t[o];t.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();